/*! For license information please see index.mobile.js.LICENSE.txt */
(()=>{var e={9685:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.AppstleSubscriptionsEditors=void 0;var a,i=n(r(2766)),o=n(r(5971)),s=n(r(5990)),u=n(r(7488)),l=r(804),d=r(892),p=r(1653),c=n(r(827)),f=r(2129),g={isPaginated:!1,paginationResolver:function(e,t){return{}},endpointResolver:function(e,t){return e},inputResolver:function(e){return{}},transformer:function(e){return e}},m=function(e){return String(e.split("/").pop())},y={FetchSubscriptionsByCustomerId:Object.assign({},g,{queryType:"get",endpoint:"/api/external/v2/subscription-customers/",isPaginated:!1,editableInputParams:{customerAccessToken:"",customerId:""},endpointResolver:function(e,t){var r=t.customerId;return`${e}${m(r)}`},transformer:f.TransformSubscriptionsByCustomerId}),FetchLatestSubscriptionByCustomerId:Object.assign({},g,{queryType:"get",endpoint:"/api/external/v2/subscription-customers/",isPaginated:!1,editableInputParams:{customerAccessToken:"",customerId:""},endpointResolver:function(e,t){var r=t.customerId;return`${e}${m(r)}`},transformer:f.TransformLatestSubscriptionByCustomerId}),FetchSubscriptionDetailsById:Object.assign({},g,{queryType:"get",endpoint:"/api/external/v2/subscription-contracts/contract-external/",isPaginated:!1,editableInputParams:{customerAccessToken:"",subscriptionId:""},endpointResolver:function(e,t){var r=t.subscriptionId;return`${e}${m(r)}`},transformer:f.TransformedFetchSubscriptionDetails}),SkipUpcomingOrder:Object.assign({},g,{queryType:"put",endpoint:"/api/external/v2/subscription-billing-attempts/skip-upcoming-order",isPaginated:!1,editableInputParams:{customerAccessToken:"",subscriptionId:""},endpointResolver:function(e,t){var r=t.subscriptionId;return`${e}${(0,p.jsonToQueryString)({subscriptionContractId:m(r)})}`},transformer:f.TransformSkipUpcomingOrder}),UpdateStatus:Object.assign({},g,{queryType:"put",endpoint:"/api/external/v2/subscription-contracts-update-status",isPaginated:!1,editableInputParams:{customerAccessToken:"",subscriptionId:"",status:""},endpointResolver:function(e,t){var r=t.subscriptionId,n=t.status;return`${e}${(0,p.jsonToQueryString)({status:n,contractId:m(r)})}`}}),UpdateSubscriptionDeliveryInterval:Object.assign({},g,{queryType:"put",endpoint:"/api/external/v2/subscription-contracts-update-delivery-interval",isPaginated:!1,editableInputParams:{customerAccessToken:"",subscriptionId:"",sellingPlan:""},endpointResolver:function(e,t){var r=t.subscriptionId,n=t.sellingPlan;return`${e}${(0,p.jsonToQueryString)({deliveryIntervalCount:n.frequencyCount,deliveryInterval:n.frequencyInterval,contractId:m(r)})}`},transform:f.TransformUpdateSubscriptionInterval}),UpdateSubscriptionBillingInterval:Object.assign({},g,{queryType:"put",endpoint:"/api/external/v2/subscription-contracts-update-billing-interval",isPaginated:!1,editableInputParams:{customerAccessToken:"",subscriptionId:"",sellingPlan:""},endpointResolver:function(e,t){var r=t.subscriptionId,n=t.sellingPlan;return`${e}${(0,p.jsonToQueryString)({intervalCount:n.billingFrequencyCount,interval:n.billingFrequencyInterval,contractId:m(r)})}`},transform:f.TransformUpdateSubscriptionInterval}),UpdateBillingDate:Object.assign({},g,{queryType:"put",endpoint:"/api/external/v2/subscription-contracts-update-billing-date",isPaginated:!1,editableInputParams:{customerAccessToken:"",subscriptionId:"",nextBillingDate:""},endpointResolver:function(e,t){var r=t.subscriptionId,n=t.nextBillingDate;return`${e}${(0,p.jsonToQueryString)({nextBillingDate:n,contractId:m(r)})}`}}),CancelSubscription:Object.assign({},g,{queryType:"delete",endpoint:"/api/external/v2/subscription-contracts/",isPaginated:!1,editableInputParams:{customerAccessToken:"",subscriptionId:"",cancellationFeedback:""},endpointResolver:function(e,t){var r=t.subscriptionId,n=t.cancellationFeedback;return`${e}${m(r)}${(0,p.jsonToQueryString)({cancellationFeedback:n})}`}}),ReplaceSubscriptionItems:Object.assign({},g,{queryType:"post",endpoint:"/api/external/v2/subscription-contract-details/replace-variants-v3/",isPaginated:!1,editableInputParams:{customerAccessToken:"",shop:"",subscriptionId:"",currentSubscriptionItems:"",currentCartLineItems:""},endpointResolver:function(e,t){return`${e}`},inputResolver:function(e){var t=e.currentCartLineItems,r=e.subscriptionId,n=e.currentSubscriptionItems,a=e.shop,i=t.filter((function(e){return!n.some((function(t){return t.variantId===e.merchandiseId}))})),u=n.filter((function(e){return!t.some((function(t){return t.merchandiseId===e.variantId}))})),l=t.filter((function(e){return n.some((function(t){return t.variantId===e.merchandiseId&&t.quantity!==e.newQuantity}))}));return{shop:a,contractId:Number(m(r)),oldVariants:[].concat((0,o.default)(u),(0,o.default)(l)).map((function(e){return m(e.variantId||e.merchandiseId)})),newVariants:[].concat((0,o.default)(i),(0,o.default)(l)).reduce((function(e,t){return Object.assign({},e,(0,s.default)({},m(t.merchandiseId),t.newQuantity))}),{})}}}),FetchAllSellingPlans:Object.assign({},g,{queryType:"get",endpoint:"/api/external/v2/subscription-groups/all-selling-plans",isPaginated:!1,editableInputParams:{customerAccessToken:""},endpointResolver:function(e,t){return e},transformer:f.TransformSellingPlans})},v=t.AppstleSubscriptionsEditors={basic:[{type:"codeInput",name:"proxyUrl",props:{label:"proxyUrl",placeholder:""}},{type:"codeInput",name:"appId",defultValue:"",props:{label:"App ID",placeholder:"Apptile app id"}}]};t.default=(0,c.default)({name:"Appstle Subscriptions",config:Object.assign({},d.baseDatasourceConfig,{queryRunner:"queryRunner"}),initDatasource:(a=(0,i.default)((function*(e,t,r){var n=(0,d.AjaxQueryRunner)();return n.initClient(t.config.get("proxyUrl"),(function(e){var r,n;return e.headers=Object.assign({},e.headers,{"x-shopify-app-id":null!=(r=null==(n=t.config)?void 0:n.get("appId"))?r:"",Authorization:"null",Accept:"*/*"}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}})),function(e,t,r){return a.apply(this,arguments)}),getQueries:function(){return y},getQueryInputParams:function(e){var t=y&&y[e]?y[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.proxyUrl,r=e.appId;return!(!t||!r)&&{proxyUrl:t,appId:r}},resolveClearCredentialConfigs:function(){return["proxyUrl","appId"]},getPlatformIdentifier:function(){return"appstleSubs"},runQuery:function*(e,t,r,n,a,i){try{var o,d=y[n];if(!d)return;var p,c,f=null!=d?d:{},g=f.endpointResolver,m=f.endpoint;d&&d.editableInputParams&&(p=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,u.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,s.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,s.default)({},a,i)):e:e}),{})}(a,d.editableInputParams));var v=i.getNextPage,h=i.paginationMeta;logger.info("isPaginated",null==d?void 0:d.isPaginated,v),logger.info("isPaginated",h||d.paginationMeta),null!=d&&d.isPaginated&&d.paginationResolver&&v&&(p=d.paginationResolver(p,h||d.paginationMeta)),m=g&&g(m,p),c=d.inputResolver?d.inputResolver(p):p;var b,I,P=r.get("queryRunner"),R=yield(0,l.call)(P.runQuery,d.queryType,m,Object.assign({},c),{headers:{"Content-Type":(null==d?void 0:d.headerType)||"application/json","x-shopify-customer-access-token":null==(o=p)?void 0:o.customerAccessToken}}),w=R&&R.data?R.data:{},T=w;if(d&&d.transformer){var _=d.transformer(w,p),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,b=S,I=A}return yield{rawData:w,data:T,hasNextPage:b,paginationMeta:I,errors:[],hasError:!1}}catch(e){return logger.error(e),yield{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}},options:{propertySettings:{},pluginListing:{labelPrefix:"appstleSubs",type:"datasource",name:"Appstle Subscriptions",description:"Appstle Subscriptions integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:v})},2129:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformedFetchSubscriptionDetails=t.TransformUpdateSubscriptionInterval=t.TransformSubscriptionsByCustomerId=t.TransformSkipUpcomingOrder=t.TransformSellingPlans=t.TransformReplaceSubscriptionItems=t.TransformProductSellingPlans=t.TransformLatestSubscriptionByCustomerId=void 0,t.TransformSellingPlans=function(e,t){return{data:e.map((function(e){return{frequencyCount:e.frequencyCount,frequencyInterval:e.frequencyInterval,billingFrequencyCount:e.billingFrequencyCount,billingFrequencyInterval:e.billingFrequencyInterval,frequencyName:e.frequencyName,id:e.id,frequencyType:e.frequencyType,planType:e.planType,idNew:e.idNew,groupName:e.groupName,groupId:e.groupId,frequencySequence:e.frequencySequence}}))}},t.TransformProductSellingPlans=function(e){for(var t=[],r=0;r<e.length;r++){console.log("debug data",e);var n={handle:"",sellingPlans:[]};n.handle=e[r].handle;for(var a=0;a<e[r].sellingPlanGroups.edges[0].node.sellingPlans.edges.length;a++){var i={id:"",billingFrequencyCount:0,billingFrequencyInterval:"",frequencyCount:0,frequencyInterval:"",frequencyName:""};i.id=e[r].sellingPlanGroups.edges[0].node.sellingPlans.edges[a].node.id,i.billingFrequencyCount=e[r].sellingPlanGroups.edges[0].node.sellingPlans.edges[a].node.billingPolicy.intervalCount,i.billingFrequencyInterval=e[r].sellingPlanGroups.edges[0].node.sellingPlans.edges[a].node.billingPolicy.interval,i.frequencyCount=e[r].sellingPlanGroups.edges[0].node.sellingPlans.edges[a].node.deliveryPolicy.intervalCount,i.frequencyInterval=e[r].sellingPlanGroups.edges[0].node.sellingPlans.edges[a].node.deliveryPolicy.interval,i.frequencyName=e[r].sellingPlanGroups.edges[0].node.sellingPlans.edges[a].node.name,n.sellingPlans[a]=i}t[r]=n}return{data:t}},t.TransformSkipUpcomingOrder=function(e,t){return{data:{id:e.id,shop:e.shop,status:e.status,billingDate:e.billingDate,contractId:e.contractId,orderId:e.orderId}}},t.TransformSubscriptionsByCustomerId=function(e,t){var r;return{data:{id:e.id,productSubscriberStatus:e.productSubscriberStatus,tags:e.tags,subscriptionContracts:(null==(r=e.subscriptionContracts.edges)?void 0:r.map((function(e){var t,r,n;return{id:e.node.id,createdAt:e.node.createdAt,nextBillingDate:e.node.nextBillingDate,status:e.node.status,deliveryPrice:e.node.deliveryPrice.amount,billingPolicy:{interval:e.node.billingPolicy.interval,intervalCount:e.node.billingPolicy.intervalCount},lines:(null==(t=e.node.lines.edges)?void 0:t.map((function(e){return{id:e.node.id,sellingPlanName:e.node.sellingPlanName,productId:e.node.productId,sku:e.node.sku,title:e.node.title,variantId:e.node.variantId,quantity:e.node.quantity,lineDiscountedPrice:e.node.lineDiscountedPrice.amount,variantImageSrc:e.node.variantImage.transformedSrc,variantTitle:e.node.variantTitle,currentPrice:e.node.currentPrice.amount}})))||[],originOrder:{id:(null==(r=e.node.originOrder)?void 0:r.id)||null,name:(null==(n=e.node.originOrder)?void 0:n.name)||null},customer:{id:e.node.customer.id}}})).filter((function(e){return"CANCELLED"!==e.status})))||[]}}},t.TransformLatestSubscriptionByCustomerId=function(e,t){var r,n,a,i,o,s,u=null==(r=e.subscriptionContracts.edges)||null==(n=r.filter((function(e){return"CANCELLED"!==e.node.status})))||null==(a=n.reduce((function(e,t){return new Date(e.node.createdAt)>t.node.createdAt?e:t}),{node:{createdAt:0}}))?void 0:a.node;return{data:u?{id:e.id,productSubscriberStatus:e.productSubscriberStatus,tags:e.tags,subscriptionContract:u?{id:u.id,createdAt:u.createdAt,nextBillingDate:u.nextBillingDate,status:u.status,deliveryPrice:u.deliveryPrice.amount,billingPolicy:{interval:u.billingPolicy.interval,intervalCount:u.billingPolicy.intervalCount},lines:(null==(i=u.lines.edges)?void 0:i.map((function(e){return{id:e.node.id,sellingPlanName:e.node.sellingPlanName,productId:e.node.productId,sku:e.node.sku,title:e.node.title,variantId:e.node.variantId,quantity:e.node.quantity,lineDiscountedPrice:e.node.lineDiscountedPrice.amount,variantImageSrc:e.node.variantImage.transformedSrc,variantTitle:e.node.variantTitle,currentPrice:e.node.currentPrice.amount}})))||[],originOrder:{id:(null==(o=u.originOrder)?void 0:o.id)||null,name:(null==(s=u.originOrder)?void 0:s.name)||null},customer:{id:u.customer.id}}:null}:null}},t.TransformUpdateSubscriptionInterval=function(e,t){return{data:{id:e.id,createdAt:e.createdAt,updatedAt:e.updatedAt,nextBillingDate:e.nextBillingDate,status:e.status,customer_id:e.customer.id,customer_name:e.customer.displayName,deliveryPrice:{amount:e.deliveryPrice.amount,currencyCode:e.deliveryPrice.currencyCode},deliveryPolicy:{interval:e.deliveryPolicy.interval,intervalCount:e.deliveryPolicy.intervalCount},billingPolicy:{interval:e.billingPolicy.interval,intervalCount:e.billingPolicy.intervalCount},originOrder:{id:e.originOrder.id,name:e.originOrder.name},customAttributes:e.customAttributes.map((function(e){return{key:e.key,value:e.value}}))}}},t.TransformReplaceSubscriptionItems=function(e,t){var r;return{data:{id:e.id,createdAt:e.createdAt,nextBillingDate:e.nextBillingDate,status:e.status,deliveryPrice:e.deliveryPrice.amount,deliveryPolicy:{interval:e.deliveryPolicy.interval,intervalCount:e.deliveryPolicy.intervalCount},billingPolicy:{interval:e.billingPolicy.interval,intervalCount:e.billingPolicy.intervalCount},lines:null==(r=e.lines.edges)?void 0:r.map((function(e){return{id:e.node.id,sellingPlanName:e.node.sellingPlanName,productId:e.node.productId,sku:e.node.sku,title:e.node.title,variantId:e.node.variantId,quantity:e.node.quantity,lineDiscountedPrice:e.node.lineDiscountedPrice.amount,variantImageSrc:e.node.variantImage.transformedSrc,variantTitle:e.node.variantTitle,currentPrice:e.node.currentPrice.amount}})),originOrder:{id:e.originOrder.id,name:e.originOrder.name},customer:{id:e.customer.id,displayName:e.customer.displayName},customAttributes:e.customAttributes.map((function(e){return{key:e.key,value:e.value}}))}}},t.TransformedFetchSubscriptionDetails=function(e,t){var r;return{data:"CANCELLED"===e.status?null:{id:e.id,createdAt:e.createdAt,updatedAt:e.updatedAt,nextBillingDate:e.nextBillingDate,status:e.status,deliveryPrice:e.deliveryPrice.amount,lastPaymentStatus:e.lastPaymentStatus,deliveryPolicy:{interval:e.deliveryPolicy.interval,intervalCount:e.deliveryPolicy.intervalCount},billingPolicy:{interval:e.billingPolicy.interval,intervalCount:e.billingPolicy.intervalCount},lines:null==(r=e.lines.edges)?void 0:r.map((function(e){return{id:e.node.id,sellingPlanName:e.node.sellingPlanName,productId:e.node.productId,sku:e.node.sku,title:e.node.title,variantId:e.node.variantId,quantity:e.node.quantity,lineDiscountedPrice:e.node.lineDiscountedPrice.amount,variantImageSrc:e.node.variantImage.transformedSrc,variantTitle:e.node.variantTitle,currentPrice:e.node.currentPrice.amount}})),address:{address1:e.deliveryMethod.address.address1,address2:e.deliveryMethod.address.address2,city:e.deliveryMethod.address.city,company:e.deliveryMethod.address.company,country:e.deliveryMethod.address.country,countryCode:e.deliveryMethod.address.countryCode,firstName:e.deliveryMethod.address.firstName,lastName:e.deliveryMethod.address.lastName,name:e.deliveryMethod.address.name,phone:+e.deliveryMethod.address.phone,province:e.deliveryMethod.address.province,provinceCode:e.deliveryMethod.address.provinceCode,zip:e.deliveryMethod.address.zip},originOrder:{id:e.originOrder.id,name:e.originOrder.name},customer:{id:e.customer.id},customAttributes:e.customAttributes.map((function(e){return{key:e.key,value:e.value}}))}}}},1973:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ApptileDiscountsEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(1665),c={GetDiscounts:Object.assign({},{isPaginated:!1,contextInputParams:{apiBaseUrl:""},paginationResolver:function(e,t){return{}},endpointResolver:function(e,t){return e},inputResolver:function(e){return{}},transformer:function(e){return e}},{queryType:"get",endpoint:"/v1/discounts",transformer:p.TransformDiscounts})},f=t.ApptileDiscountsEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base Url",placeholder:""}},{type:"codeInput",name:"shopifyDS",props:{label:"shopifyDS",placeholder:"{{shopify}}"}}]};t.default=(0,d.default)({name:"apptileCartDiscounts",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://api.apptile.io/apptile-shopify-discount-manager",shopifyDS:"{{shopify}}",queryRunner:"queryRunner"}),initDatasource:(a=(0,i.default)((function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=null==r?void 0:r.get("shopifyDS");return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers=Object.assign({},e.headers,{"x-shopify-app-id":null==a?void 0:a.appId,"x-shopify-customer-access-token":null==a?void 0:a.storefrontAccessToken}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}})),function(e,t,r){return a.apply(this,arguments)}),getQueries:function(){return c},getQueryInputParams:function(e){var t=c&&c[e]?c[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl;return!!t&&{apiBaseUrl:t}},resolveClearCredentialConfigs:function(){return["apiBaseUrl"]},getPlatformIdentifier:function(){return"apptileCartDiscounts"},runQuery:function*(e,t,r,n,a,i){try{var l=c[n];if(!l)return;var d,p,f=null!=l?l:{},g=f.endpointResolver,m=f.endpoint;l&&l.editableInputParams&&(d=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,l.editableInputParams));var y=i.getNextPage,v=i.paginationMeta;logger.info("isPaginated",null==l?void 0:l.isPaginated,y),logger.info("isPaginated",v||l.paginationMeta),null!=l&&l.isPaginated&&l.paginationResolver&&y&&(d=l.paginationResolver(d,v||l.paginationMeta)),m=g&&g(m,d),p=l.inputResolver?l.inputResolver(d):d;var h,b,I=r.get("queryRunner"),P=yield(0,u.call)(I.runQuery,l.queryType,m,Object.assign({},p)),R=P&&P.data?P.data:{},w=R;if(l&&l.transformer){var T=l.transformer(R,d),_=T.data,O=T.hasNextPage,S=T.paginationMeta;w=_,h=O,b=S}return yield{rawData:R,data:w,hasNextPage:h,paginationMeta:b,errors:[],hasError:!1}}catch(e){return logger.error(e),yield{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}},options:{propertySettings:{},pluginListing:{labelPrefix:"apptileCartDiscounts",type:"datasource",name:"Apptile Cart Discounts",description:"Apptile Cart Discounts integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:f})},1665:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformDiscounts=void 0,t.TransformDiscounts=function(e){return{data:e.discountNodes.edges.map((function(e){var t=e.node;return Object.assign({id:t.id},t.discount)}))}}},7430:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.ApptileCartUpsellRecords=t.ApptileCartUpsellEditors=void 0;var a,i=n(r(2766)),o=r(892),s=n(r(827)),u=r(804),l=t.ApptileCartUpsellRecords={},d=t.ApptileCartUpsellEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base Url",placeholder:""}},{type:"codeInput",name:"appId",props:{label:"APP ID",placeholder:""}}]};t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:void 0,errors:[],hasError:!1}})),function(e,t,r,n,i,o){return a.apply(this,arguments)}),t.default=(0,s.default)({name:"ApptileCartUpsell",config:Object.assign({},o.baseDatasourceConfig,{apiBaseUrl:"https://api.apptile.io/apptile-shopify-discount-manager/api/v1/cart-upsell",appId:"",queryRunner:"queryRunner",data:[]}),initDatasource:function*(e,t,r){var n=(0,o.AjaxQueryRunner)(),a=t.config.get("appId");n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers=Object.assign({},e.headers,{"Content-Type":"application/json","x-shopify-app-id":a}),e}));var i=yield(0,u.call)(n.runQuery,"get","/",{},{});return{modelUpdates:[{selector:[t.get("id"),"data"],newValue:i.data}]}},getQueries:function(){return l},getQueryInputParams:function(e){var t=l&&l[e]?l[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.appId;return!!t&&{appId:t}},resolveClearCredentialConfigs:function(){return["appId"]},getPlatformIdentifier:function(){return"apptileCartUpsell"},runQuery:function*(e,t,r,n,a,i){},options:{propertySettings:{},pluginListing:{labelPrefix:"ApptileCartUpsell",type:"datasource",name:"Apptile Cart Upsell",description:"Apptile Cart Gamification",section:"Integrations",icon:"datasource"}},editors:d})},537:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PhoneLoginStateEnum=t.MFAuthEventsEnum=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=r(3972),d=t.PhoneLoginStateEnum=function(e){return e.ACCOUNT_CREATION_REQUIRED="ACCOUNT_CREATION_REQUIRED",e.PASSWORD_REQUIRED="PASSWORD_REQUIRED",e.OTP_GENERATED="OTP_GENERATED",e}({}),p=t.MFAuthEventsEnum=function(e){return e.ACCOUNT_CREATION_REQUIRED="onSignupRequired",e.PASSWORD_REQUIRED="onPasswordRequire",e.OTP_GENERATED="onOtpGenerated",e.SUCCESS="onSuccess",e.ERROR="onError",e.USER_ALREADY_EXISTS="onExistingUser",e}({}),c=new((0,s.default)((function e(){var t,r,n,a,s=this;(0,o.default)(this,e),this.errorHandler=function(e,t){var r,n,a,i=null,o=null!=(r=null==e?void 0:e.response)?r:null;null!=o&&o.status||(i=p.ERROR),i=409===(null==o?void 0:o.status)?p.USER_ALREADY_EXISTS:p.ERROR;var s=null!=(n=null==o||null==(a=o.data)?void 0:a.message)?n:"Unknown Error Occured";return{modelUpdates:[{selector:t.concat(["data"]),newValue:null},{selector:t.concat(["rawData"]),newValue:null},{selector:t.concat(["errors"]),newValue:[s]},{selector:t.concat(["hasError"]),newValue:!!e},{selector:t.concat("loading"),newValue:!1}],eventToBeTriggered:i}},this.handleResponse=function(e,t,r,n){var a,i,o,u=null!=(a=null==r?void 0:r.data)?a:null,l=[{selector:n.concat(["data"]),newValue:u},{selector:n.concat(["rawData"]),newValue:u},{selector:n.concat(["errors"]),newValue:[]},{selector:n.concat(["hasError"]),newValue:!1},{selector:n.concat("loading"),newValue:!1}],c=null;switch(null==u?void 0:u.status){case d.ACCOUNT_CREATION_REQUIRED:c=p.ACCOUNT_CREATION_REQUIRED;break;case d.PASSWORD_REQUIRED:c=p.PASSWORD_REQUIRED;break;case d.OTP_GENERATED:c=p.OTP_GENERATED;break;default:c=null!=u&&u.accessToken?p.SUCCESS:p.ERROR}return null!=u&&null!=(i=u.user)&&i.email&&s.updateDatasourceModel(e,t,[{selector:["maskedEmail"],newValue:null==(o=u.user)?void 0:o.email}]),{modelUpdates:l,eventToBeTriggered:c}},this.updateDatasourceModel=function(e,t,r){var n,a=null==t||null==(n=t.config)?void 0:n.get("datasource");a||logger.info("Unable to find Datasource");var i=[a],o=r.map((function(e){return{selector:i.concat(e.selector),newValue:e.newValue}}));e((0,u.modelUpdateAction)(o))},this.SignIn=(t=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"SignIn",a);return s.updateDatasourceModel(e,t,[{selector:["phone"],newValue:null==a?void 0:a.phone}]),s.handleResponse(e,t,i,n)}catch(e){return logger.error("while SignIn",e),s.errorHandler(e,n)}})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.SignUp=(r=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"SignUp",a),o=a.email;return s.updateDatasourceModel(e,t,[{selector:["email"],newValue:o}]),s.handleResponse(e,t,i,n)}catch(e){return logger.error("while SignUp",e),s.errorHandler(e,n)}})),function(e,t,n,a,i){return r.apply(this,arguments)}),this.OtpVerify=(n=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"OtpVerify",a);return s.handleResponse(e,t,i,n)}catch(e){return logger.error("while OtpVerify",e),s.errorHandler(e,n)}})),function(e,t,r,a,i){return n.apply(this,arguments)}),this.PasswordVerify=(a=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"PasswordVerify",a);return s.handleResponse(e,t,i,n)}catch(e){return logger.error("while PasswordVerify",e),s.errorHandler(e,n)}})),function(e,t,r,n,i){return a.apply(this,arguments)})}),[{key:"runQuery",value:(a=(0,i.default)((function*(e,t,r,n){return yield(0,l.executeQuery)(t,e,t,r,n)})),function(e,t,r,n){return a.apply(this,arguments)})}]));t.default=c},3972:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ApptileMFAuthEditors=t.ApptileMFAuthDsName=t.ApptileMFAuthApiRecords=void 0,t.executeQuery=b;var a=n(r(2766)),i=n(r(5990)),o=n(r(7488)),s=n(r(3216)),u=r(892),l=n(r(827)),d=n(r(537)),p=t.ApptileMFAuthDsName="ApptileMFAuth",c={isPaginated:!1,contextInputParams:{},transformer:function(e){return{data:e,hasNextPage:!1,paginationMeta:{}}},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},f=t.ApptileMFAuthApiRecords={SignIn:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/phone",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.sourcePlatform,n=t.sourceEntityId;return{phone:e.phone,sourcePlatform:r,sourceEntityId:n}},editableInputParams:{phone:""},contextInputParams:{sourcePlatform:"",sourceEntityId:""}}),SignUp:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/register",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.phone,n=t.sourcePlatform,a=t.sourceEntityId,i=null!=e?e:{};return{phone:r,email:i.email,firstname:i.firstname,lastname:i.lastname,sourcePlatform:n,sourceEntityId:a}},editableInputParams:{email:"",firstname:"",lastname:""},contextInputParams:{phone:"",sourcePlatform:"",sourceEntityId:""}}),OtpVerify:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/otp/verify",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.sourcePlatform,n=t.sourceEntityId;return{phone:t.phone,otp:e.otp,sourcePlatform:r,sourceEntityId:n}},editableInputParams:{otp:""},contextInputParams:{sourcePlatform:"",sourceEntityId:"",phone:""}}),PasswordVerify:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/password/verify",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.phone,n=t.email,a=t.sourcePlatform,i=t.sourceEntityId;return{phone:r,email:n,password:e.password,sourcePlatform:a,sourceEntityId:i}},editableInputParams:{password:""},contextInputParams:{sourcePlatform:"",sourceEntityId:"",phone:"",email:""}})},g={SignIn:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.SignIn},actionMetadata:{editableInputParams:{phone:""}}},SignUp:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.SignUp},actionMetadata:{editableInputParams:{email:"",firstname:"",lastname:""}}},OtpVerify:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.OtpVerify},actionMetadata:{editableInputParams:{otp:""}}},PasswordVerify:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.PasswordVerify},actionMetadata:{editableInputParams:{password:""}}}},m={labelPrefix:p,type:"datasource",name:"Apptile MF Auth Integration",description:"Apptile MF Auth Integration.",section:"Integrations",icon:"datasource"},y=t.ApptileMFAuthEditors={basic:[{type:"codeInput",name:"apiBasePath",props:{label:"API Base Path",placeholder:"https://api.apptile.io/auth-manager"}},{type:"codeInput",name:"sourceEntityId",props:{label:"Source EntityId",placeholder:""}},{type:"codeInput",name:"sourcePlatform",props:{label:"Source Platform",placeholder:""}}]},v=function(e){return function(t,r){var n=t.get("config");if(n)return Object.entries(e).reduce((function(e,t){var a=(0,o.default)(t,2),s=a[0];return a[1],n&&n.get(s)?Object.assign({},e,(0,i.default)({},s,n.get(s))):r&&r.get(s)?Object.assign({},e,(0,i.default)({},s,r.get(s))):e}),{})}},h=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,o.default)(r,2),a=n[0],s=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,i.default)({},a,isNaN(s)&&typeof s==typeof t[a]?s:parseInt(s))):s?Object.assign({},e,(0,i.default)({},a,s)):e:e}),{})};function b(e,t,r,n,a,i){return I.apply(this,arguments)}function I(){return(I=(0,a.default)((function*(e,t,r,n,a,i){var o=f[n];if(o){var s,u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta,c=null!=o?o:{},g=c.endpointResolver,m=c.endpoint,y=c.contextInputParams,b=v(y)(t,r);o&&o.editableInputParams&&(s=h(a,o.editableInputParams)),null!=o&&o.isPaginated&&o.paginationResolver&&d&&(s=o.paginationResolver(s,p)),u=o.inputResolver?o.inputResolver(s,b):s,m=g&&g(m,Object.assign({},b,u),d);var I,P,R=r.get("queryRunner"),w=yield R.runQuery(o.queryType,m,u,Object.assign({},i,{headers:Object.assign({},o.headers)})),T=w&&w.data?w.data:{},_=T;if(o&&o.transformer){var O=o.transformer(T);_=O.data,I=O.hasNextPage,P=O.paginationMeta}return{rawData:T,data:_,hasNextPage:I,paginationMeta:P,errors:[],hasError:!1}}}))).apply(this,arguments)}t.default=(0,l.default)({name:p,config:{apiBasePath:"https://api.apptile.io/auth-manager",sourceEntityId:"",sourcePlatform:"SHOPIFY",queryRunner:"queryrunner",phone:"",email:"",maskedEmail:"",SignIn:"",SignUp:"",OtpVerify:"",PasswordVerify:""},initDatasource:function*(e,t,r){var n=(0,u.AjaxQueryRunner)();return n.initClient(t.config.get("apiBasePath"),(function(e){return e.timeout=4e4,e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return s.default.filter(s.default.map(g,(function(e,t){return e.type===u.TriggerActionIdentifier?t:""})))},getQueryInputParams:function(e){var t,r,n=g&&g[e]?g[e]:null;return null!=n&&null!=(t=n.actionMetadata)&&t.editableInputParams?null==n||null==(r=n.actionMetadata)?void 0:r.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.proxyUrl,r=e.sourceEntityId;return!(!t||!r)&&{apiBasePath:t,sourceEntityId:r,sourcePlatform:"SHOPIFY"}},resolveClearCredentialConfigs:function(){return["apiBasePath","sourceEntityId"]},getPlatformIdentifier:function(){return"ApptileMFAuth"},runQuery:function*(e,t,r,n,a,i){return yield b(e,t,r,n,a,i)},options:{propertySettings:g,pluginListing:m},editors:y})},8391:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.PhoneLoginStateEnum=t.MFAuthEventsEnum=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=r(4786),d=t.PhoneLoginStateEnum=function(e){return e.ACCOUNT_CREATION_REQUIRED="ACCOUNT_CREATION_REQUIRED",e.PASSWORD_REQUIRED="PASSWORD_REQUIRED",e.OTP_GENERATED="OTP_GENERATED",e}({}),p=t.MFAuthEventsEnum=function(e){return e.ACCOUNT_CREATION_REQUIRED="onSignupRequired",e.PASSWORD_REQUIRED="onPasswordRequire",e.OTP_GENERATED="onOtpGenerated",e.SUCCESS="onSuccess",e.ERROR="onError",e.USER_ALREADY_EXISTS="onExistingUser",e}({}),c=new((0,s.default)((function e(){var t,r,n,a,s=this;(0,o.default)(this,e),this.errorHandler=function(e,t){var r,n,a,i=null,o=null!=(r=null==e?void 0:e.response)?r:null;null!=o&&o.status||(i=p.ERROR),i=409===(null==o?void 0:o.status)?p.USER_ALREADY_EXISTS:p.ERROR;var s=null!=(n=null==o||null==(a=o.data)?void 0:a.message)?n:"Unknown Error Occured";return{modelUpdates:[{selector:t.concat(["data"]),newValue:null},{selector:t.concat(["rawData"]),newValue:null},{selector:t.concat(["errors"]),newValue:[s]},{selector:t.concat(["hasError"]),newValue:!!e},{selector:t.concat("loading"),newValue:!1}],eventToBeTriggered:i}},this.handleResponse=function(e,t,r,n){var a,i,o,u=null!=(a=null==r?void 0:r.data)?a:null,l=[{selector:n.concat(["data"]),newValue:u},{selector:n.concat(["rawData"]),newValue:u},{selector:n.concat(["errors"]),newValue:[]},{selector:n.concat(["hasError"]),newValue:!1},{selector:n.concat("loading"),newValue:!1}],c=null;switch(null==u?void 0:u.status){case d.ACCOUNT_CREATION_REQUIRED:c=p.ACCOUNT_CREATION_REQUIRED;break;case d.PASSWORD_REQUIRED:c=p.PASSWORD_REQUIRED;break;case d.OTP_GENERATED:c=p.OTP_GENERATED;break;default:c=null!=u&&u.accessToken?p.SUCCESS:p.ERROR}return null!=u&&null!=(i=u.user)&&i.email&&s.updateDatasourceModel(e,t,[{selector:["maskedEmail"],newValue:null==(o=u.user)?void 0:o.email}]),{modelUpdates:l,eventToBeTriggered:c}},this.updateDatasourceModel=function(e,t,r){var n,a=null==t||null==(n=t.config)?void 0:n.get("datasource");a||logger.info("Unable to find Datasource");var i=[a],o=r.map((function(e){return{selector:i.concat(e.selector),newValue:e.newValue}}));e((0,u.modelUpdateAction)(o))},this.SignIn=(t=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"SignIn",a);return s.updateDatasourceModel(e,t,[{selector:["phone"],newValue:null==a?void 0:a.phone}]),s.handleResponse(e,t,i,n)}catch(e){return logger.error("while SignIn",e),s.errorHandler(e,n)}})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.SignUp=(r=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"SignUp",a),o=a.email;return s.updateDatasourceModel(e,t,[{selector:["email"],newValue:o}]),s.handleResponse(e,t,i,n)}catch(e){return logger.error("while SignUp",e),s.errorHandler(e,n)}})),function(e,t,n,a,i){return r.apply(this,arguments)}),this.OtpVerify=(n=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"OtpVerify",a);return s.handleResponse(e,t,i,n)}catch(e){return logger.error("while OtpVerify",e),s.errorHandler(e,n)}})),function(e,t,r,a,i){return n.apply(this,arguments)}),this.PasswordVerify=(a=(0,i.default)((function*(e,t,r,n,a){try{var i=yield s.runQuery(t,r,"PasswordVerify",a);return s.handleResponse(e,t,i,n)}catch(e){return logger.error("while PasswordVerify",e),s.errorHandler(e,n)}})),function(e,t,r,n,i){return a.apply(this,arguments)})}),[{key:"runQuery",value:(a=(0,i.default)((function*(e,t,r,n){return yield(0,l.executeQuery)(t,e,t,r,n)})),function(e,t,r,n){return a.apply(this,arguments)})}]));t.default=c},4786:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ApptileMFAuthenticationDsName=t.ApptileMFAuthenticationApiRecords=t.ApptileMFAuthEditors=void 0,t.executeQuery=b;var a=n(r(2766)),i=n(r(5990)),o=n(r(7488)),s=n(r(3216)),u=r(892),l=n(r(827)),d=n(r(8391)),p=t.ApptileMFAuthenticationDsName="apptileMFAuthentication",c={isPaginated:!1,contextInputParams:{},transformer:function(e){return{data:e,hasNextPage:!1,paginationMeta:{}}},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},f=t.ApptileMFAuthenticationApiRecords={SignIn:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/phone",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.sourcePlatform,n=t.sourceEntityId;return{phone:e.phone,sourcePlatform:r,sourceEntityId:n}},editableInputParams:{phone:""},contextInputParams:{sourcePlatform:"",sourceEntityId:""}}),SignUp:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/register",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.phone,n=t.sourcePlatform,a=t.sourceEntityId;return{phone:r,email:e.email,sourcePlatform:n,sourceEntityId:a}},editableInputParams:{email:""},contextInputParams:{phone:"",sourcePlatform:"",sourceEntityId:""}}),OtpVerify:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/otp/verify",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.sourcePlatform,n=t.sourceEntityId;return{phone:t.phone,otp:e.otp,sourcePlatform:r,sourceEntityId:n}},editableInputParams:{otp:""},contextInputParams:{sourcePlatform:"",sourceEntityId:"",phone:""}}),PasswordVerify:Object.assign({},c,{queryType:"post",endpoint:"/api/v1/sign-in/password/verify",endpointResolver:function(e){return e},inputResolver:function(e,t){var r=t.phone,n=t.email,a=t.sourcePlatform,i=t.sourceEntityId;return{phone:r,email:n,password:e.password,sourcePlatform:a,sourceEntityId:i}},editableInputParams:{password:""},contextInputParams:{sourcePlatform:"",sourceEntityId:"",phone:"",email:""}})},g={SignIn:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.SignIn},actionMetadata:{editableInputParams:{phone:""}}},SignUp:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.SignUp},actionMetadata:{editableInputParams:{email:""}}},OtpVerify:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.OtpVerify},actionMetadata:{editableInputParams:{otp:""}}},PasswordVerify:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.default.PasswordVerify},actionMetadata:{editableInputParams:{password:""}}}},m={labelPrefix:p,type:"datasource",name:"Apptile MF Authentication Integration",description:"Apptile MF Authentication Integration.",section:"Integrations",icon:"datasource"},y=t.ApptileMFAuthEditors={basic:[{type:"codeInput",name:"apiBasePath",props:{label:"API Base Path",placeholder:"https://dev-api.apptile.io/auth-manager"}},{type:"codeInput",name:"sourceEntityId",props:{label:"Source EntityId",placeholder:""}},{type:"codeInput",name:"sourcePlatform",props:{label:"Source Platform",placeholder:""}}]},v=function(e){return function(t,r){var n=t.get("config");if(n)return Object.entries(e).reduce((function(e,t){var a=(0,o.default)(t,2),s=a[0];return a[1],n&&n.get(s)?Object.assign({},e,(0,i.default)({},s,n.get(s))):r&&r.get(s)?Object.assign({},e,(0,i.default)({},s,r.get(s))):e}),{})}},h=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,o.default)(r,2),a=n[0],s=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,i.default)({},a,isNaN(s)&&typeof s==typeof t[a]?s:parseInt(s))):s?Object.assign({},e,(0,i.default)({},a,s)):e:e}),{})};function b(e,t,r,n,a,i){return I.apply(this,arguments)}function I(){return(I=(0,a.default)((function*(e,t,r,n,a,i){var o=f[n];if(o){var s,u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta,c=null!=o?o:{},g=c.endpointResolver,m=c.endpoint,y=c.contextInputParams,b=v(y)(t,r);o&&o.editableInputParams&&(s=h(a,o.editableInputParams)),null!=o&&o.isPaginated&&o.paginationResolver&&d&&(s=o.paginationResolver(s,p)),u=o.inputResolver?o.inputResolver(s,b):s,m=g&&g(m,Object.assign({},b,u),d);var I,P,R=r.get("queryRunner"),w=yield R.runQuery(o.queryType,m,u,Object.assign({},i,{headers:Object.assign({},o.headers)})),T=w&&w.data?w.data:{},_=T;if(o&&o.transformer){var O=o.transformer(T);_=O.data,I=O.hasNextPage,P=O.paginationMeta}return{rawData:T,data:_,hasNextPage:I,paginationMeta:P,errors:[],hasError:!1}}}))).apply(this,arguments)}t.default=(0,l.default)({name:p,config:{apiBasePath:"https://dev-api.apptile.io/auth-manager",sourceEntityId:"",sourcePlatform:"SHOPIFY",queryRunner:"queryrunner",phone:"",email:"",maskedEmail:"",SignIn:"",SignUp:"",OtpVerify:"",PasswordVerify:""},initDatasource:function*(e,t,r){var n=(0,u.AjaxQueryRunner)();return n.initClient(t.config.get("apiBasePath"),(function(e){return e.timeout=4e4,e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return s.default.filter(s.default.map(g,(function(e,t){return e.type===u.TriggerActionIdentifier?t:""})))},getQueryInputParams:function(e){var t,r,n=g&&g[e]?g[e]:null;return null!=n&&null!=(t=n.actionMetadata)&&t.editableInputParams?null==n||null==(r=n.actionMetadata)?void 0:r.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.proxyUrl,r=e.sourceEntityId;return!(!t||!r)&&{apiBasePath:t,sourceEntityId:r,sourcePlatform:"SHOPIFY"}},resolveClearCredentialConfigs:function(){return["apiBasePath","sourceEntityId"]},getPlatformIdentifier:function(){return p},runQuery:function*(e,t,r,n,a,i){return yield b(e,t,r,n,a,i)},options:{propertySettings:g,pluginListing:m},editors:y})},1283:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(2766)),i=n(r(3664)),o=n(r(2584)),s=r(892),u=new((0,i.default)((function e(){var t;(0,o.default)(this,e),this.validatePinCode=(t=(0,a.default)((function*(e,t,r,n,a){try{var i,o,u;e((0,s.modelUpdateAction)([{selector:n.concat(["validatingPinCode"]),newValue:!0}],void 0,!0));var l=r.get("queryRunner"),d=yield l.runQuery("get",a.pincodesJsonUrl),p=null==d||null==(i=d.data)||null==(o=i.valid_pin_codes)?void 0:o.find((function(e){return e===a.pinCode}));(void 0!==a.enableToasts&&""!==a.enableToasts?a.enableToasts:null==(u=r.get("enableToasts"))||u)&&(p?toast.show(a.successMessage,{type:"success"}):toast.show(a.errorMessage,{type:"error"})),e((0,s.modelUpdateAction)([{selector:n.concat(["validatingPinCode"]),newValue:!1},{selector:n.concat(["isValidPinCode"]),newValue:!!p},{selector:n.concat(["isInvalidValidPinCode"]),newValue:!p},{selector:n.concat(["pinCode"]),newValue:a.pinCode}],void 0,!0))}catch(t){console.log("error",t),e((0,s.modelUpdateAction)([{selector:n.concat(["validatingPinCode"]),newValue:!1},{selector:n.concat(["errors"]),newValue:[t]}],void 0,!0))}})),function(e,r,n,a,i){return t.apply(this,arguments)})})));t.default=u},4036:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.apptilePinCodeCheckerApiRecords=t.ApptilePinCodeCheckerEditors=void 0;var a,i,o=n(r(2766)),s=n(r(5990)),u=n(r(7488)),l=r(892),d=n(r(3216)),p=n(r(827)),c=r(1653),f=n(r(1283)),g=t.apptilePinCodeCheckerApiRecords={GetPinCodesList:Object.assign({},{isPaginated:!1,contextInputParams:{},paginationResolver:function(e,t){return{}},endpointResolver:function(e,t){return e},inputResolver:function(e){return{}},transformer:function(e){return{data:e,hasNext:!1,paginationMeta:{}}}},{queryType:"get",isPaginated:!1,endpoint:"",editableInputParams:{pincodesJsonUrl:""},endpointResolver:function(e,t){return t.pincodesJsonUrl}})},m={validatePinCode:{type:l.TriggerActionIdentifier,getValue:function(e,t,r){return f.default.validatePinCode},actionMetadata:{editableInputParams:{pincodesJsonUrl:"",pinCode:"",successMessage:"",errorMessage:"",enableToasts:""}}},validatingPinCode:{getValue:function(e,t,r){return d.default.get(e,r,!1)}},isValidPinCode:{getValue:function(e,t,r){return d.default.get(e,r,!1)}},pinCode:{getValue:function(e,t,r){return d.default.get(e,r,"")}}},y=t.ApptilePinCodeCheckerEditors={basic:[]},v=(a=(0,o.default)((function*(e,t,r,n,a,i){try{var o,l,d=null!=n?n:{},p=d.endpointResolver,f=d.contextInputParams,g=d.editableInputParams,m=d.endpoint;(0,c.makeInputParamsResolver)(f)(t,r),g&&(o=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,u.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,s.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,s.default)({},a,i)):e:e}),{})}(a,g)),m=p&&p(m,a),l=n.inputResolver?n.inputResolver(o):o;var y,v,h=r.get("queryRunner"),b=yield h.runQuery(n.queryType,m,Object.assign({},l)),I=b&&b.data?b.data:{},P=I;if(n&&n.transformer){var R=n.transformer(I,o),w=R.data,T=R.hasNext,_=R.paginationMeta;P=w,y=T,v=_}return{rawData:I,data:P,hasNextPage:y,paginationMeta:v,errors:[],hasError:!1}}catch(e){return logger.error(e),{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,p.default)({name:"apptilePinCodeChecker",config:Object.assign({},l.baseDatasourceConfig,{queryRunner:"queryRunner",validatePinCode:"action",validatingPinCode:!1,isValidPinCode:!1,pinCode:"",enableToasts:!0}),initDatasource:(i=(0,o.default)((function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient("",(function(e){return e.headers=Object.assign({},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}})),function(e,t,r){return i.apply(this,arguments)}),getQueries:function(){return g},getQueryInputParams:function(e){var t=g&&g[e]?g[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){return{}},resolveClearCredentialConfigs:function(){return[]},getPlatformIdentifier:function(){return"apptilePinCodeChecker"},runQuery:function*(e,t,r,n,a,i){var o=g[n];if(o)return yield v(e,t,r,o,a,i)},options:{propertySettings:m,pluginListing:{labelPrefix:"apptilePinCodeChecker",type:"datasource",name:"Apptile Pin Code Checker",description:"Apptile Pin Code Checker integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:y})},4260:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=n(r(3216)),d=new((0,s.default)((function e(){var t,r,n,a,s=this;(0,o.default)(this,e),this.setAnswers=(t=(0,i.default)((function*(e,t,r,n,a){var i=r.get("selectedAnswers")||{},o=a.quizId,u=a.questionId,d=a.question,p=a.answer,c=a.multiSelect,f=i[o],g=l.default.find(f,["id",u]);c?f?(g?("string"==typeof p&&"object"==typeof g.answer?l.default.includes(g.answer,p)?l.default.pull(g.answer,p):g.answer.push(p):g.answer=p,f=l.default.unionBy([g],f,"id")):(g={id:u,question:d,answer:[p]},f.push(g)),i[o]=f,l.default.isEmpty(g.answer)&&(i[o]=f.filter((function(e){if(e.id!==u)return e})))):i[o]=[{id:u,question:d,answer:[p]}]:(i[o]=l.default.unionBy([{id:u,question:d,answer:p}],f,"id"),g&&g.answer===p&&(i[o]=f.filter((function(e){if(e.id!==u)return e})))),yield s.applyChanges(e,t,r,n,i,"selectedAnswers")})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.removeSetAnswers=(r=(0,i.default)((function*(e,t,r,n,a){yield s.applyChanges(e,t,r,n,{},"selectedAnswers")})),function(e,t,n,a,i){return r.apply(this,arguments)}),this.curateResults=(n=(0,i.default)((function*(e,t,r,n,a){yield s.applyChanges(e,t,r,n,!1,"resultsCurated");var i=a.resultsMapping,o=a.quizId,u=(r.get("selectedAnswers")||{})[o].map((function(e){return e.answer})),d=l.default.flattenDeep(u),p=Object.keys(i),c=l.default.intersection(p,d).map((function(e){return i[e]})),f=l.default.flattenDeep(c);yield s.applyChanges(e,t,r,n,f,"curatedResults"),yield s.applyChanges(e,t,r,n,!0,"resultsCurated")})),function(e,t,r,a,i){return n.apply(this,arguments)}),this.setResultsCurated=(a=(0,i.default)((function*(e,t,r,n,a){var i=a.resultCurationStatus;yield s.applyChanges(e,t,r,n,i,"resultsCurated")})),function(e,t,r,n,i){return a.apply(this,arguments)})}),[{key:"applyChanges",value:(a=(0,i.default)((function*(e,t,r,n,a,i){var o=[],s=n.concat([i]);o.push({selector:s,newValue:a}),e((0,u.modelUpdateAction)(o,void 0,!0))})),function(e,t,r,n,i,o){return a.apply(this,arguments)})}]));t.default=d},2032:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.apptileQuizEditors=void 0;var a=n(r(5990)),i=n(r(7488)),o=r(804),s=r(892),u=n(r(827)),l=n(r(4260)),d={PostAnswers:{queryType:"post",endpoint:"/quiz",endpointResolver:function(e,t){return e},editableInputParams:{customerEmail:"",selectedAnswers:""},inputResolver:function(e){return{selectedAnswers:e.selectedAnswers,customerEmail:e.customerEmail}}}},p={setAnswers:{type:s.TriggerActionIdentifier,getValue:function(e,t,r){return l.default.setAnswers},actionMetadata:{editableInputParams:{quizId:"",questionId:"",question:"",answer:"",multiSelect:""}}},curateResults:{type:s.TriggerActionIdentifier,getValue:function(e,t,r){return l.default.curateResults},actionMetadata:{editableInputParams:{resultsMapping:"",quizId:""}}},removeSetAnswers:{type:s.TriggerActionIdentifier,getValue:function(e,t,r){return l.default.removeSetAnswers}},setResultsCurated:{type:s.TriggerActionIdentifier,getValue:function(e,t,r){return l.default.setResultsCurated},actionMetadata:{editableInputParams:{resultCurationStatus:""}}}},c=t.apptileQuizEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://webhook.site/0a11ffa7-e175-4a0e-a3ae-6def372fd115"}},{type:"codeInput",name:"apiAccessKey",props:{label:"API Key",placeholder:""}}]};t.default=(0,u.default)({name:"ApptileQuiz",config:{apiBaseUrl:"",apiAccessKey:"",queryRunner:"queryrunner",selectedAnswers:{},setAnswers:"action",curateResults:"action",curatedResults:[""],resultsCurated:!1,removeSetAnswers:"action",setResultsCurated:"action"},initDatasource:function*(e,t,r){var n=(0,s.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n},{selector:[t.get("id"),"selectedAnswers"],newValue:{}}]}},getQueries:function(){return d},getQueryInputParams:function(e){var t=d&&d[e]?d[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},runQuery:function*(e,t,r,n,s,u){var l=d[n];if(l){var p,c,f,g=null!=l?l:{},m=g.endpointResolver,y=g.endpoint,v=u.getNextPage,h=u.paginationMeta;if(l&&l.contextInputParams){var b=(p=l.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(p).reduce((function(e,n){var o=(0,i.default)(n,2),s=o[0],u=o[1];return r&&r.get(u)?Object.assign({},e,(0,a.default)({},s,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,a.default)({},s,t.get(u))):e}),{})});b(t,r)}l&&l.editableInputParams&&(c=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return t&&void 0!==t[o]?"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e:e}),{})}(s,l.editableInputParams)),null!=l&&l.isPaginated&&l.paginationResolver&&v&&(c=l.paginationResolver(c,h)),f=l.inputResolver?l.inputResolver(c):c;var I,P=r.get("queryRunner");y=y=m&&m(y,c);try{I=yield(0,o.call)(P.runQuery,l.queryType,y,Object.assign({},f),{headers:{"content-type":"application/json"}})}catch(e){logger.error(e)}var R,w,T=I&&I.data?I.data:{},_=T;if(l&&l.transformer){var O=l.transformer(T,l.transformers);_=O.data,R=O.hasNextPage,w=O.paginationMeta}return yield{rawData:T,data:_,hasNextPage:R,paginationMeta:w}}},options:{propertySettings:p,pluginListing:{labelPrefix:"apptileQuiz",type:"datasource",name:"ApptileQuiz Integration",description:"ApptileQuiz store front integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},5125:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.SCANS_LIMIT_RESET_INTERVAL=t.ALLOWED_SCANS_PER_USER=void 0,t.checkScanLimitExhausted=f,t.recoomendProductsByTags=function(e,t,r,n,a){return l.apply(this,arguments)},t.updateScanLimitData=function(e,t,r,n,a){return m.apply(this,arguments)};var a=n(r(7488)),i=n(r(2766)),o=r(892),s=n(r(3216)),u=n(r(6196));function l(){return(l=(0,i.default)((function*(e,t,r,n,a){var i=a.configObj,s=a.metric,u=a.score,l=a.navigateTo,d="",p=i.config.ruleSet[s.toLowerCase()];if(p){var c;u>=80&&u<=100?c="good":u>=50&&u<80?c="average":u>=0&&u<50&&(c="bad");var f=p.range[c]||p.default,g=f.expressions;for(var m of g)d+=`${m.type}:${m.value} ${f.expMethod} `;(d=(d=d.trim()).slice(0,-(f.expMethod.length+1)))&&e((0,o.navigateToScreen)(l,{query:d,metric:s,score:u}))}else e((0,o.navigateToScreen)(l,{query:'tag:""',metric:s,score:u})),logger.error(`Error: Metric "${s}" not found.`)}))).apply(this,arguments)}var d=t.ALLOWED_SCANS_PER_USER=2,p=t.SCANS_LIMIT_RESET_INTERVAL="day",c=function(e){return String(e.split("/").pop())};function f(e,t,r,n,a){return g.apply(this,arguments)}function g(){return(g=(0,i.default)((function*(e,t,r,n,a){e((0,o.modelUpdateAction)([{selector:n.concat(["loading"]),newValue:!0}]));var i=c(a.userId),l=yield o.LocalStorage.getValue(`lastFaceScanTimeStamp-${i}`),f=Number((yield o.LocalStorage.getValue(`faceScanCount-${i}`))||0);return!s.default.isEmpty(l)&&(0,u.default)(l).local().isSame((0,u.default)().local(),p)&&f>=d?e((0,o.modelUpdateAction)([{selector:n.concat(["limitExhausted"]),newValue:!0},{selector:n.concat(["loading"]),newValue:!1}])):e((0,o.modelUpdateAction)([{selector:n.concat(["limitExhausted"]),newValue:!1},{selector:n.concat(["loading"]),newValue:!1}]))}))).apply(this,arguments)}function m(){return(m=(0,i.default)((function*(e,t,r,n,i){var s,l,d=c(i.userId),g=yield Promise.all([o.LocalStorage.getValue(`lastFaceScanTimeStamp-${d}`),o.LocalStorage.getValue(`faceScanCount-${d}`)]),m=(0,a.default)(g,2),y=(s=m[0],l=m[1],s&&(0,u.default)(s).local().isSame((0,u.default)().local(),p)?Number(l)+1:1);yield Promise.all([o.LocalStorage.setValue(`lastFaceScanTimeStamp-${d}`,(0,u.default)().local().toISOString()),o.LocalStorage.setValue(`faceScanCount-${d}`,y.toString())]),f(e,t,r,n,i)}))).apply(this,arguments)}},9417:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ApptileSkinCareEditors=t.ApptileSkinCareApiRecords=void 0;var a,i=n(r(5990)),o=n(r(7488)),s=n(r(2766)),u=r(804),l=r(892),d=n(r(827)),p=r(1333),c=r(5125),f=t.ApptileSkinCareApiRecords={UploadImage:{queryType:"post",endpoint:"/v1/analyze/faceSkinMetrics/:userId/upload",endpointResolver:function(e){return`/v1/analyze/faceSkinMetrics/upload?userId=${e.userId}&userName=${e.userName}`},editableInputParams:{userId:"",userName:"",b64data:""},inputResolver:(a=(0,s.default)((function*(e){return{b64data:e.b64data}})),function(e){return a.apply(this,arguments)})},ListResultSets:{queryType:"get",endpoint:"/v1/analyze/faceSkinMetrics/:userId",endpointResolver:function(e,t){var r=(null!=t?t:{}).nextPageCursor,n=void 0===r?0:r;return`/v1/analyze/faceSkinMetrics/${null==e?void 0:e.userId}?size=${null==e?void 0:e.limit}&page=${n}`},editableInputParams:{userId:"",limit:10},isPaginated:!0,transformer:p.TransformListResultSets},GetResult:{queryType:"get",endpoint:"/v1/analyze/faceSkinMetrics/:userId/resultSet/:resultSetId/smoothed",endpointResolver:function(e){return`/v1/analyze/faceSkinMetrics/${null==e?void 0:e.userId}/resultSet/${null==e?void 0:e.resultSetId}/smoothed`},editableInputParams:{userId:"",resultSetId:""}},GetConfig:{queryType:"get",endpoint:"/v1/store/config"}},g={recommendByTags:{type:l.TriggerActionIdentifier,getValue:function(e,t,r){return c.recoomendProductsByTags},actionMetadata:{editableInputParams:{configObj:"",metric:"",score:"",navigateTo:""}}},checkScanLimitExhausted:{type:l.TriggerActionIdentifier,getValue:function(e,t,r){return c.checkScanLimitExhausted},actionMetadata:{editableInputParams:{userId:""}}},updateScanLimitData:{type:l.TriggerActionIdentifier,getValue:function(e,t,r){return c.updateScanLimitData},actionMetadata:{editableInputParams:{userId:""}}}},m=t.ApptileSkinCareEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:""}},{type:"codeInput",name:"apiAccessKey",props:{label:"API Key",placeholder:""}}]};t.default=(0,d.default)({name:"apptileSkinCare",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"",apiAccessKey:"",limitExhausted:!1,loading:!1,queryRunner:"queryrunner",suggestionConfig:"",recommendByTags:"actions",checkScanLimitExhausted:"actions",updateScanLimitData:"actions"}),initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){var r=t.config.get("apiAccessKey");return r&&(e.headers["X-API-KEY"]=`${r}`),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},runQuery:function*(e,t,r,n,a,s){var l=f[n];if(l){var d,p,c,g,m=null!=s?s:{},y=m.getNextPage,v=m.paginationMeta;if(l&&l.contextInputParams){var h=(p=l.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(p).reduce((function(e,n){var a=(0,o.default)(n,2),s=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,i.default)({},s,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,i.default)({},s,t.get(u))):e}),{})});d=h(t,r)}l&&l.editableInputParams&&(c=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,o.default)(r,2),a=n[0],s=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,i.default)({},a,isNaN(s)&&typeof s==typeof t[a]?s:parseInt(s))):s?Object.assign({},e,(0,i.default)({},a,s)):e:e}),{})}(a,l.editableInputParams)),null!=l&&l.isPaginated&&l.paginationResolver&&y&&(c=l.paginationResolver(c,v)),g=l.inputResolver?yield(0,u.call)(l.inputResolver,c):c;var b=l.endpoint;l.endpointResolver&&(b=l.endpointResolver(c,v));var I,P,R=r.get("queryRunner"),w=yield(0,u.call)(R.runQuery,l.queryType,b,Object.assign({},g,d),s),T=w&&w.data?w.data:{},_=T;if(l&&l.transformer){var O=l.transformer(T).data,S=(null!=v?v:{}).after,A=void 0===S?1:S;_=O,(I=!(T.totalPages===T.currentPage+1))&&(P={after:A?A+1:1,nextPageCursor:T.currentPage+1})}return yield{rawData:T,data:_,hasNextPage:I,paginationMeta:P}}},getPlatformIdentifier:function(){return"apptileSkinCare"},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.apiAccessKey;return!(!t||!r)&&{apiBaseUrl:t,apiAccessKey:r}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","apiAccessKey"]},options:{propertySettings:g,pluginListing:{labelPrefix:"apptileSkinCare",type:"datasource",name:"Apptile skin care",description:"Skin analysis using Haut AI",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:m})},1333:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformListResultSets=void 0,t.TransformListResultSets=function(e){return{data:e.items}}},6167:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.CloudSearchEditors=void 0;var a=n(r(5990)),i=n(r(7488)),o=r(804),s=r(892),u=n(r(827)),l=r(9820),d={isPaginated:!1,contextInputParams:{shopDomain:"",platformType:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).startIndex;return r?Object.assign({},e,{startIndex:r}):e}},p={SearchProducts:Object.assign({},d,{queryType:"post",endpoint:"/search",endpointResolver:function(e,t){var r=t.shopDomain;return`${e}?type=${t.platformType}&shop=${r}`},transformer:l.TransformSearchResults,paginationResolver:function(e,t){var r;return r=t.hasOwnProperty("offset")?e.limits.products+Number.parseInt(null==t?void 0:t.offset):0,Object.assign({},e,{offset:r})},isPaginated:!0,editableInputParams:{q:"",facet:!0,filters:{},limits:{products:3},collection_handle:""},checkInputVariabes:function(e){return!!e.q}}),GetProductFilters:Object.assign({},d,{queryType:"post",endpoint:"/search",endpointResolver:function(e,t){var r=t.shopDomain;return`${e}?type=${t.platformType}&shop=${r}`},transformer:l.TransformFacets,editableInputParams:{q:"",facet:!0},checkInputVariabes:function(e){return!!e.q}}),GetSuggestions:Object.assign({},d,{queryType:"post",endpoint:"/search",endpointResolver:function(e,t){var r=t.shopDomain;return`${e}?type=${t.platformType}&shop=${r}`},transformer:l.TransformSuggestions,isPaginated:!1,editableInputParams:{q:"",limits:{products:5}}})},c=t.CloudSearchEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"Api Base Url",placeholder:"https://app.cloudsearchapp.com/api/v1"}},{type:"codeInput",name:"shopDomain",props:{label:"Shop Name",placeholder:"demo.myshopify.com"}},{type:"codeInput",name:"platformType",props:{label:"Platform Type",placeholder:"shopify"}}]};t.default=(0,u.default)({name:"Cloud Search",config:{apiBaseUrl:"https://app.cloudsearchapp.com/api/v1",shopDomain:"",platformType:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,s.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"text/plain;charset=UTF-8"},e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.shopDomain,r=e.platformType,n=e.apiBaseUrl;return!!t&&{shopDomain:t,platformType:r,apiBaseUrl:n}},resolveClearCredentialConfigs:function(){return["shopDomain"]},getPlatformIdentifier:function(){return"cloudsearch"},runQuery:function*(e,t,r,n,s,u){var l,d=p[n];if(d){var c,f,g=u.getNextPage,m=u.paginationMeta,y=null!=d?d:{},v=y.endpointResolver,h=y.endpoint,b=(l=y.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(l).reduce((function(e,n){var o=(0,i.default)(n,2),s=o[0];return o[1],r&&r.get(s)?Object.assign({},e,(0,a.default)({},s,r.get(s))):t&&t.get(s)?Object.assign({},e,(0,a.default)({},s,t.get(s))):e}),{})}),I=b(t,r),P=!0;d&&d.editableInputParams&&(c=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return t&&void 0!==t[o]&&"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e}),{})}(s,d.editableInputParams),null!=d&&d.checkInputVariabes&&(P=d.checkInputVariabes(c))),null!=d&&d.isPaginated&&d.paginationResolver&&g&&(c=d.paginationResolver(c,m)),f=d.inputResolver?d.inputResolver(c,I):c,h=v&&v(h,Object.assign({},I,f),g);var R,w=r.get("queryRunner");if(P)try{R=yield(0,o.call)(w.runQuery,d.queryType,h,JSON.stringify(f),Object.assign({},u))}catch(e){logger.error("error",e)}else R={errors:{message:"Missing input variables"},data:null};var T,_,O=R&&R.data?R.data:{},S=O;if(d&&d.transformer){var A,C,U=null!=(A=c)&&A.offset?null==(C=c)?void 0:C.offset:0,j=d.transformer(O,U);S=j.data,T=j.hasNextPage,_=j.paginationMeta}return yield{rawData:O,data:S,hasNextPage:T,paginationMeta:_,errors:[],hasError:!1}}},options:{propertySettings:{},pluginListing:{labelPrefix:"CloudSearch",type:"datasource",name:"Cloud Search",description:"Cloud product search.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},9820:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformSuggestions=t.TransformSearchResults=t.TransformFacets=void 0;var a=n(r(3216));function i(e,t){return t&&"string"==typeof t?`${t} ${e}`:a.default.toNumber(e).toString()}function o(e,t){return{id:`gid://shopify/Product/${null==e?void 0:e.product_id}`,handle:(r=null==e?void 0:e.url,null!=(n=a.default.last(a.default.split(null!=r?r:"","/")))?n:""),name:null==e?void 0:e.name,description:null==e?void 0:e.hi_description,image_src:null==e?void 0:e.image_src,sku:null==e?void 0:e.sku,maxPrice:a.default.toNumber(null!=e&&e.list_price?e.list_price:e.price),minPrice:a.default.toNumber(null!=e&&e.list_price?e.list_price:e.price),displayMinPrice:i(null!=e&&e.list_price?e.list_price:e.price,t),displayMaxPrice:i(null!=e&&e.list_price?e.list_price:e.price,t),maxSalePrice:a.default.toNumber(null==e?void 0:e.price),minSalePrice:a.default.toNumber(null==e?void 0:e.price),displayMinSalePrice:i(null==e?void 0:e.price,t),displayMaxSalePrice:i(null==e?void 0:e.price,t),num_of_variants:null==e?void 0:e.sort_int_num_variants};var r,n}t.TransformSearchResults=function(e,t){var r=e.products,n=e.numFoundProducts,i=e.facets,s=e.categories,u=e.pages,l=e.numFoundCategories,d=e.resultsFor,p=e.suggestions,c=e.haveMoreResults,f=e.notEmpty,g=e.moneyFormat,m=[];a.default.isArray(r)&&r.length>0&&(m=r.map((function(e){return o(e,g.substring(0,2))})));var y=n>r.length,v={currentPage:Math.ceil((null==r?void 0:r.length)/(null==r?void 0:r.length)),totalPages:Math.ceil(n/(null==r?void 0:r.length)),totalItems:n,offset:t};return{data:{products:m,facets:i,categories:s,pages:u,numFoundCategories:l,resultsFor:d,suggestions:p,haveMoreResults:c,notEmpty:f,moneyFormat:g},hasNextPage:y,paginationMeta:v}},t.TransformSuggestions=function(e,t){var r=e.products,n=e.numFoundProducts,i=e.facets,s=e.categories,u=e.pages,l=e.numFoundCategories,d=e.resultsFor,p=e.suggestions,c=e.haveMoreResults,f=e.notEmpty,g=e.moneyFormat,m=[];return a.default.isArray(r)&&(null==r?void 0:r.length)>0&&(m=r.map((function(e){return o(e,g.substring(0,2))}))),{data:{products:m,facets:i,categories:s,pages:u,numFoundCategories:l,resultsFor:d,suggestions:p,haveMoreResults:c,notEmpty:f,moneyFormat:g},hasNextPage:n>r.length,paginationMeta:{currentPage:Math.ceil((null==r?void 0:r.length)/(null==r?void 0:r.length)),totalPages:Math.ceil(n/(null==r?void 0:r.length)),totalItems:n,offset:t}}},t.TransformFacets=function(e){var t,r=e.facets;return a.default.isArray(r)&&r.length>0&&(t=r.map((function(e){return function(e){var t,r,n="collection"===(null==e?void 0:e.type)?null==e||null==(t=e.counts)?void 0:t.map((function(e){return function(e){var t,r;return{label:null==e||null==(t=e.value)?void 0:t.name,value:null==e||null==(r=e.value)?void 0:r.handle,count:null==e?void 0:e.count}}(e)})):null==e||null==(r=e.counts)?void 0:r.map((function(e){return function(e){return{label:null==e?void 0:e.value,count:null==e?void 0:e.count,value:null==e?void 0:e.value}}(e)}));return{label:null==e?void 0:e.name,attribute:null==e?void 0:e.id,type:null==e?void 0:e.type,values:n,expanded:null==e?void 0:e.expanded}}(e)}))),{data:t}}},4035:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.discourseActionsDatasourcePropertySettings=t.discourseActionsDatasourcePluginConfig=t.discourseActionsDatasourceEditor=t.default=void 0;var a,i,o,s,u,l,d=n(r(7488)),p=n(r(2766)),c=n(r(2584)),f=n(r(3664)),g=r(892),m=n(r(3216)),y=r(1171),v=(t.discourseActionsDatasourcePluginConfig={authenticateUser:g.TriggerActionIdentifier,discourseLoggedInUser:"",authLoader:!1},t.discourseActionsDatasourceEditor={basic:[]},t.discourseActionsDatasourcePropertySettings={authenticateUser:{type:g.TriggerActionIdentifier,getValue:function(e,t,r){return v.authenticateUser},actionMetadata:{editableInputParams:{email:"",customerAccessToken:"",successMessage:"",badParameterMessage:"",errorMessage:""}}}},new((0,f.default)((function e(){var t,r,n=this;(0,c.default)(this,e),this.preSignInUser=(t=(0,p.default)((function*(e,t,r,a,i){var o,s=i,u=s.email,l=s.customerAccessToken,d=null,p=yield n.communityHelperQueryExecutor(r,t,"authenticateUser",{email:u,customerAccessToken:l}),c=p.data,f=p.errors;return c&&null!=c&&c.token?(yield n.storeLoggedInUserDetails(c),{customerData:d={discourseLoggedInUser:c},error:null}):(console.log("Error signInResponse",c),{customerData:d,error:null==(o=m.default.first(f))?void 0:o.message})})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.authenticateUser=(r=(0,p.default)((function*(e,t,r,a,i,o,s){var u=[{selector:a.concat(["authLoader"]),newValue:!0}],l=i,d=l.successMessage,p=l.errorMessage,c=l.badParameterMessage;try{e((0,g.modelUpdateAction)(u,void 0,!0));var f=yield n.preSignInUser(e,t,r,a,i),m=f.customerData,y=f.error;if(y)return console.log("error",y),void n.setBadParamErrorMessage(e,t,r,a,y,c);n.setSuccessMessage(e,t,r,a,m,d)}catch(y){console.log("Error signUpResponse",y),n.setErrorMessage(e,t,r,a,null==y?void 0:y.message,p)}})),function(e,t,n,a,i,o,s){return r.apply(this,arguments)})}),[{key:"communityHelperQueryExecutor",value:(l=(0,p.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,g.GetRegisteredPlugin)(a),o=this.getQueries()[r];return yield(0,y.executeQuery)(i,t,e,o,Object.assign({},n),{})})),function(e,t,r,n){return l.apply(this,arguments)})},{key:"getQueries",value:function(){var e,t=(0,g.GetRegisteredPluginInfo)("discourse");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}},{key:"updateLocalStore",value:(u=(0,p.default)((function*(e,t){yield g.LocalStorage.setValue(e,t)})),function(e,t){return u.apply(this,arguments)})},{key:"storeLoggedInUserDetails",value:(s=(0,p.default)((function*(e){yield this.updateLocalStore("discourseLoggedInUser",e)})),function(e){return s.apply(this,arguments)})},{key:"setErrorMessage",value:(o=(0,p.default)((function*(e,t,r,n,a,i){var o=i||a,s=[];s.push({selector:n.concat(["authLoader"]),newValue:!1}),toast.show(o,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}}),setTimeout((function(){return e((0,g.modelUpdateAction)(s,void 0,!0))}),1)})),function(e,t,r,n,a,i){return o.apply(this,arguments)})},{key:"setBadParamErrorMessage",value:(i=(0,p.default)((function*(e,t,r,n,a,i){var o=i||a,s=[];s.push({selector:n.concat(["authLoader"]),newValue:!1}),toast.show(o,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,g.modelUpdateAction)(s,void 0,!0))})),function(e,t,r,n,a,o){return i.apply(this,arguments)})},{key:"setSuccessMessage",value:(a=(0,p.default)((function*(e,t,r,n,a,i){var o=[];o.push({selector:n.concat(["authLoader"]),newValue:!1}),m.default.entries(a||[]).map((function(e){var t=(0,d.default)(e,2),r=t[0],a=t[1];return o.push({selector:n.concat([r]),newValue:a})})),m.default.isEmpty(i)||toast.show(i,{type:"success",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,g.modelUpdateAction)(o,void 0,!0))})),function(e,t,r,n,i,o){return a.apply(this,arguments)})}])));t.default=v},1171:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.discourseEditors=t.discourseApiRecords=t.default=void 0;var a,i=n(r(2766)),o=n(r(5971)),s=n(r(1351)),u=n(r(5990)),l=n(r(7488)),d=r(892),p=n(r(827)),c=r(8112),f=r(4035),g={isPaginated:!1,contextInputParams:{},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e},endpointResolver:function(e,t,r){return e},apiBaseUrlResolver:function(e){return e.get("apiBaseUrl")},editableInputParams:{},inputResolver:function(e){return e},queryHeadersResolver:function(e,t){return{}}},m=t.discourseApiRecords={GetCategories:Object.assign({},g,{queryType:"get",endpoint:"/categories.json",transformer:c.TransformGetCategories}),GetLatestTopics:Object.assign({},g,{queryType:"get",endpoint:"/latest.json",transformer:c.TransformGetLatestTopics}),GetTopTopics:Object.assign({},g,{queryType:"get",endpoint:"/top.json",editableInputParams:{period:"all"},transformer:c.TransformGetLatestTopics,endpointResolver:function(e,t,r){return`${e}?period=${(null!=t?t:{}).period}`}}),GetTopicByExternalId:Object.assign({},g,{queryType:"get",endpoint:"/t",editableInputParams:{handle:"",topicId:""},transformer:c.TransformGetTopicByExternalId,endpointResolver:function(e,t,r){var n=null!=t?t:{},a=n.topicId;return`${e}/${n.handle}/${a}.json`}}),GetSingleTopiclId:Object.assign({},g,{queryType:"get",endpoint:"/t",editableInputParams:{id:""},transformer:c.TransformGetTopicByExternalId,endpointResolver:function(e,t,r){return`t/${(null!=t?t:{}).id}.json`}}),authenticateUser:Object.assign({},g,{queryType:"post",endpoint:"/api/community/users/login",contextInputParams:{appId:""},apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},editableInputParams:{email:""},inputResolver:function(e){return{email:e.email}},transformer:c.TransformUser,queryHeadersResolver:function(e,t){return{"x-shopify-customer-access-token":(null!=e?e:{}).customerAccessToken,"x-shopify-app-id":(null!=t?t:{}).appId}}}),CreatePost:Object.assign({},g,{queryType:"post",contextInputParams:{appId:"",discourseLoggedInUser:""},endpoint:"/api/community/posts",apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},editableInputParams:{title:"",topicId:0},queryHeadersResolver:function(e,t){(0,s.default)(null!=e?e:{});var r=null!=t?t:{},n=r.appId,a=r.discourseLoggedInUser;return{"x-shopify-app-id":n,Authorization:null!=a&&a.token?`Bearer ${a.token}`:""}},inputResolver:function(e){var t=e.title;return{title:t,raw:t,topic_id:e.topicId}}}),EditPost:Object.assign({},g,{queryType:"put",contextInputParams:{appId:"",discourseLoggedInUser:""},endpoint:"/api/community/posts",apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},editableInputParams:{id:"",title:""},queryHeadersResolver:function(e,t){(0,s.default)(null!=e?e:{});var r=null!=t?t:{},n=r.appId,a=r.discourseLoggedInUser;return{"x-shopify-app-id":n,Authorization:null!=a&&a.token?`Bearer ${a.token}`:""}},endpointResolver:function(e,t,r){return`/api/community/posts/${(null!=t?t:{}).id}`},inputResolver:function(e){return{post:{raw:e.title}}}}),deletePost:Object.assign({},g,{queryType:"delete",contextInputParams:{appId:"",discourseLoggedInUser:""},endpoint:"/api/community/posts",apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},editableInputParams:{id:""},queryHeadersResolver:function(e,t){(0,s.default)(null!=e?e:{});var r=null!=t?t:{},n=r.appId,a=r.discourseLoggedInUser;return{"x-shopify-app-id":n,Authorization:null!=a&&a.token?`Bearer ${a.token}`:""}},endpointResolver:function(e,t,r){return`/api/community/posts/${(null!=t?t:{}).id}`}}),CreateTopic:Object.assign({},g,{queryType:"post",contextInputParams:{appId:"",discourseLoggedInUser:""},endpoint:"/api/community/posts",apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},editableInputParams:{title:"",description:"",categoryId:0},queryHeadersResolver:function(e,t){(0,s.default)(null!=e?e:{});var r=null!=t?t:{},n=r.appId,a=r.discourseLoggedInUser;return{"x-shopify-app-id":n,Authorization:null!=a&&a.token?`Bearer ${a.token}`:""}},inputResolver:function(e){var t=e.title,r=e.categoryId;return{title:t,raw:e.description,category:r}}}),EditTopic:Object.assign({},g,{queryType:"put",contextInputParams:{appId:"",discourseLoggedInUser:""},endpoint:"/api/community/posts",apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},editableInputParams:{id:"",title:"",categoryId:""},queryHeadersResolver:function(e,t){(0,s.default)(null!=e?e:{});var r=null!=t?t:{},n=r.appId,a=r.discourseLoggedInUser;return{"x-shopify-app-id":n,Authorization:null!=a&&a.token?`Bearer ${a.token}`:""}},endpointResolver:function(e,t,r){return`/api/community/t/${(null!=t?t:{}).id}`},inputResolver:function(e){var t=null!=e?e:{};return{topic:{title:t.title,categoryId:t.categoryId}}}}),ListTopicsByCategory:Object.assign({},g,{queryType:"get",endpoint:"/api/community/c/baby-care/37",endpointResolver:function(e,t,r){var n=null!=t?t:{},a=n.categoryId;return`/api/community/c/${n.slug}/${a}`},transformer:c.TransformGetCategoryTopics,contextInputParams:{appId:"",discourseLoggedInUser:""},editableInputParams:{slug:"",categoryId:0},apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},queryHeadersResolver:function(e,t){(0,s.default)(null!=e?e:{});var r=null!=t?t:{},n=r.appId,a=r.discourseLoggedInUser;return{"x-shopify-app-id":n,Authorization:null!=a&&a.token?`Bearer ${a.token}`:""}},inputResolver:function(e){return{slug:e.slug,category:e.categoryId}}}),GetCategory:Object.assign({},g,{queryType:"get",endpoint:"/c/{id}/show.json",transformer:c.TransformGetCategory,contextInputParams:{appId:"",discourseLoggedInUser:""},editableInputParams:{categoryId:0},apiBaseUrlResolver:function(e){return e.get("communityEndpoint")},queryHeadersResolver:function(e,t){(0,s.default)(null!=e?e:{});var r=null!=t?t:{},n=r.appId,a=r.discourseLoggedInUser;return{"x-shopify-app-id":n,Authorization:null!=a&&a.token?`Bearer ${a.token}`:""}},endpointResolver:function(e,t,r){return`/api/community/c/${(null!=t?t:{}).categoryId}/show`}})},y=Object.assign({},f.discourseActionsDatasourcePropertySettings),v=t.discourseEditors={basic:[{type:"codeInput",name:"appId",props:{label:"Apptile App Id"}},{type:"codeInput",name:"apiBaseUrl",defultValue:"http://localhost",props:{label:"API Base url",placeholder:"http://localhost"}},{type:"codeInput",name:"communityEndpoint",defultValue:"http://localhost:3000",props:{label:"Community Helper Endpoint",placeholder:"http://localhost:3000"}}].concat((0,o.default)(f.discourseActionsDatasourceEditor.basic))},h=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{var o,s,p=null!=n?n:{},c=p.endpointResolver,f=p.contextInputParams,g=p.editableInputParams,m=p.endpoint,y=function(e){return function(t,r){var n=t.get("config");if(n)return Object.entries(e).reduce((function(e,t){var a=(0,l.default)(t,2),i=a[0];return a[1],n&&n.get(i)?Object.assign({},e,(0,u.default)({},i,n.get(i))):r&&r.get(i)?Object.assign({},e,(0,u.default)({},i,r.get(i))):e}),{})}}(f),v=y(t,r);g&&(o=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,l.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,u.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,u.default)({},a,i)):e:e}),{})}(a,g)),m=c&&c(m,o,v),s=n.inputResolver?n.inputResolver(o):o;var h=n.apiBaseUrlResolver(r),b={};n.queryHeadersResolver&&(b=n.queryHeadersResolver(a,v));var I=(0,d.AjaxQueryRunner)();I.initClient(h,(function(e){return e.headers=Object.assign({},e.headers,Object.assign({},b,{"Content-Type":"application/json"})),e}));var P,R,w=yield I.runQuery(n.queryType,m,Object.assign({},s),{headers:{"Content-Type":"application/json"}}),T=w&&w.data?w.data:{},_=T;if(n&&n.transformer){var O=n.transformer(T,null,r),S=O.data,A=O.hasNextPage,C=O.paginationMeta;_=S,P=A,R=C}return{rawData:T,data:_,hasNextPage:P,paginationMeta:R,errors:[],hasError:!1}}catch(e){var U,j;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:(null==e||null==(U=e.response)||null==(j=U.data)?void 0:j.errors)||[null==e?void 0:e.message],hasError:!0}}})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,p.default)({name:"discourse",config:Object.assign({},d.baseDatasourceConfig,{apiBaseUrl:"",appId:"",communityEndpoint:"https://api.apptile.io/apptile-community"},f.discourseActionsDatasourcePluginConfig),onPluginUpdate:function*(e,t,r,n,a,i,o){},getQueries:function(){return m},getQueryInputParams:function(e){var t=m&&m[e]?m[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.appId,n=e.communityHelperEndpoint;return!!(t&&r&&n)&&{apiBaseUrl:t,appId:r,communityEndpoint:n}},resolveClearCredentialConfigs:function(){return["apiBaseUrl"]},getPlatformIdentifier:function(){return"discourse"},runQuery:function*(e,t,r,n,a,i){var o=m[n];if(o)return yield h(e,t,r,o,a,i)},options:{propertySettings:y,pluginListing:{labelPrefix:"discourse",type:"datasource",name:"Discourse Community",description:"Discourse Community",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:v})},8112:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t._transformUser=t._transformTopics=t._transformTopic=t._transformCategories=t.TransformUser=t.TransformGetTopicByExternalId=t.TransformGetLatestTopics=t.TransformGetCategoryTopics=t.TransformGetCategory=t.TransformGetCategories=void 0;var a=n(r(3216)),i=r(892),o=t._transformCategories=function(e,t,r){if(!e)return[];var n=null==r?void 0:r.get("apiBaseUrl"),a=["id","name","color","slug","position","description",{field:"textColor",path:"text_color"},{field:"topicCount",path:"topic_count"},{field:"postCount",path:"post_count"},{field:"descriptionText",path:"description_text"},{field:"descriptionExcerpt",path:"description_excerpt"},{field:"topicUrl",path:"topic_url"},{field:"numFeaturedTopics",path:"num_featured_topics"},{field:"logoUrl",path:"uploaded_logo.url",formatterFunction:function(e){return`${n}${e}`}}];return null==e?void 0:e.map((function(e){return Object.assign({},(0,i.jsonObjectMapper)(a,e),{categoryUrl:`/c/${null==e?void 0:e.slug}/${null==e?void 0:e.id}`})}))},s=(t.TransformGetCategories=function(e,t,r){var n=a.default.get(e,"category_list.categories"),s=o(n,t,r);return(0,i.formatQueryReturn)(s,n,{},!1,null)},t._transformTopics=function(e,t,r){if(!e)return[];var n=["id","title",{field:"fancyTitle",path:"fancy_title"},"slug",{field:"postsCount",path:"posts_count"},{field:"replyCount",path:"reply_count"},{field:"highestPostNumber",path:"highest_post_number"},{field:"imageUrl",path:"image_url"},{field:"createdAt",path:"created_at"},{field:"lastPostedAt",path:"last_posted_at"},"pinned","visible","liked","tags","views",{field:"lastPostedAt",path:"last_posted_at"},{field:"likeCount",path:"like_count"},{field:"lastPosterUsername",path:"last_poster_username"},{field:"categoryId",path:"category_id"},{field:"updatedAt",path:"bumped_at"}];return null==e?void 0:e.map((function(e){return Object.assign({},(0,i.jsonObjectMapper)(n,e),{topicUrl:`/t/${null==e?void 0:e.slug}/${null==e?void 0:e.id}`})}))}),u=(t.TransformGetLatestTopics=function(e,t,r){var n=a.default.get(e,"topic_list.topics"),o=s(n,t,r);return(0,i.formatQueryReturn)(o,n,{},!1,null)},t._transformTopic=function(e,t,r){if(e){var n=["id","name","username",{field:"title",path:"cooked"},{field:"createdAt",path:"created_at"},{field:"updatedAt",path:"updated_at"},{field:"displayUsername",path:"display_username"}],a=["id","title",{field:"fancyTitle",path:"fancy_title"},"slug",{field:"postsCount",path:"posts_count"},{field:"replyCount",path:"reply_count"},{field:"highestPostNumber",path:"highest_post_number"},{field:"imageUrl",path:"image_url"},{field:"createdAt",path:"created_at"},{field:"lastPostedAt",path:"last_posted_at"},"pinned","visible","liked","tags","views",{field:"lastPostedAt",path:"last_posted_at"},{field:"likeCount",path:"like_count"},{field:"lastPosterUsername",path:"details.last_poster.username"},{field:"lastPosterName",path:"details.last_poster.name"},{field:"categoryId",path:"category_id"},{field:"posts",path:"post_stream.posts",transform:function(e){return(0,i.jsonArrayMapper)(n,e)}}];return Object.assign({},(0,i.jsonObjectMapper)(a,e),{topicUrl:`/t/${null==e?void 0:e.slug}/${null==e?void 0:e.id}`})}}),l=(t.TransformGetTopicByExternalId=function(e,t,r){var n=u(e,t,r);return(0,i.formatQueryReturn)(n,e,{},!1,null)},t._transformUser=function(e,t,r){if(e){var n=e.user;return{token:e.token,user:(0,i.jsonObjectMapper)(["id","name","username","avatar_template",{field:"avatarTemplate",path:"avatar_template"},{field:"lastPostedAt",path:"last_posted_at"},{field:"createdAt",path:"created_at"}],n)}}});t.TransformUser=function(e,t,r){var n=l(e,t,r);return(0,i.formatQueryReturn)(n,e,{},!1,null)},t.TransformGetCategoryTopics=function(e,t,r){var n=a.default.get(e,"response.topic_list.topics"),o=s(n,t,r);return(0,i.formatQueryReturn)(o,n,{},!1,null)},t.TransformGetCategory=function(e,t,r){var n=a.default.get(e,"response.category"),o=null==r?void 0:r.get("apiBaseUrl"),s=["id","name","color","slug","position","description",{field:"textColor",path:"text_color"},{field:"topicCount",path:"topic_count"},{field:"postCount",path:"post_count"},{field:"descriptionText",path:"description_text"},{field:"descriptionExcerpt",path:"description_excerpt"},{field:"topicUrl",path:"topic_url"},{field:"numFeaturedTopics",path:"num_featured_topics"},{field:"logoUrl",path:"uploaded_logo.url",formatterFunction:function(e){return`${o}${e}`}}],u=Object.assign({},(0,i.jsonObjectMapper)(s,n),{categoryUrl:`/c/${null==n?void 0:n.slug}/${null==n?void 0:n.id}`});return(0,i.formatQueryReturn)(u,n,{},!1,null)}},3397:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.EasyAppointmentEditors=void 0,t.runQuery=function(e,t,r,n){return m.apply(this,arguments)};var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=r(8785),p={isPaginated:!1,contextInputParams:{apiBaseUrl:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},c={getProductData:Object.assign({},p,{queryType:"get",endpoint:"/products/",endpointResolver:function(e,t){return`${e}/${t.productId}/events?variantId=${t.variantId}`},editableInputParams:{productId:"",variantId:""},transformer:d.TransformData}),getStoreData:Object.assign({},p,{queryType:"get",endpoint:"/settings",endpointResolver:function(e,t){return`${e}?storeUrl=${t.storeUrl}`},editableInputParams:{storeUrl:""},transformer:d.TransformData}),getProductAllEvents:Object.assign({},p,{queryType:"get",endpoint:"/products/",endpointResolver:function(e,t){return`${e}/${t.productId}/allEvents`},editableInputParams:{productId:""},transformer:d.TransformData}),getSlotDetails:Object.assign({},p,{queryType:"post",endpoint:"/events",endpointResolver:function(e,t){return`${e}/${t.slotId}/employees/busy-slots`},inputResolver:function(e,t){return{employeeIds:e.employeeIds,dateFrom:e.dateFrom,dateTo:e.dateTo,inputTimezone:e.inputTimezone,slotId:e.slotId}},editableInputParams:{slotId:"",employeeIds:"",dateFrom:"",dateTo:"",inputTimezone:""},transformer:d.TransformData}),bookAppointment:Object.assign({},p,{queryType:"post",endpoint:"/storefront/events",endpointResolver:function(e,t){return`${e}/${t.eventId}/bookings`},inputResolver:function(e,t){return{eventId:e.eventId,userId:e.userId,isAdminCheckout:e.isAdminCheckout,productId:e.productId,variantId:e.variantId,orderId:e.orderId,price:e.price,customerEmail:e.customerEmail,contactEmail:e.contactEmail,contactPhone:e.contactPhone,orderProperties:e.orderProperties,quantity:e.quantity,firstName:e.firstName,lastName:e.lastName,employeeId:e.employeeId,startDate:e.startDate,startTime:e.startTime,endTime:e.endTime,dateFormat:e.dateFormat,timeFormat:e.timeFormat,timezone:e.timezone,variantTitle:e.variantTitle,variantFullTitle:e.variantFullTitle}},editableInputParams:{eventId:"",userId:"",isAdminCheckout:"",productId:"",variantId:"",orderId:"",price:0,customerEmail:"",contactEmail:"",contactPhone:"",orderProperties:"",quantity:0,firstName:"",lastName:"",employeeId:"",startDate:"",startTime:"",endTime:"",dateFormat:"",timeFormat:"",timezone:"",variantTitle:"",variantFullTitle:""},transformer:d.TransformData})},f=t.EasyAppointmentEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://servicify-appointments.herokuapp.com/api"}}]},g=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a){var i,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};try{var l,d,p=u.getNextPage,c=u.paginationMeta,f=null!=n?n:{},g=f.endpointResolver,m=f.endpoint,y=(i=f.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(i).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0];return a[1],r&&r.get(i)?Object.assign({},e,(0,o.default)({},i,r.get(i))):t&&t.get(i)?Object.assign({},e,(0,o.default)({},i,t.get(i))):e}),{})}),v=y(t,r),h=!0;n&&n.editableInputParams&&(l=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(h=n.checkInputVariabes(l))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(l=n.paginationResolver(l,c)),d=n.inputResolver?n.inputResolver(l,v):l,m=g&&g(m,Object.assign({},v,d),c);var b,I=r.get("queryRunner");if(h)try{b=yield I.runQuery(n.queryType,m,Object.assign({},d),Object.assign({},u))}catch(e){logger.error("error",e)}else b={errors:{message:"Missing input variables"},data:null};var P,R,w=b&&b.data?b.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,P=S,R=A}return{rawData:w,data:T,hasNextPage:P,paginationMeta:R,errors:[],hasError:!1}}catch(e){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}})),function(e,t,r,n,i){return a.apply(this,arguments)});function m(){return(m=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,l.GetRegisteredPlugin)(a),o=c[r];if(c[r])return yield g(i,t,e,o,Object.assign({},n),{})}))).apply(this,arguments)}t.default=(0,l.wrapDatasourceModel)({name:"easyAppointment",config:{apiBaseUrl:"https://servicify-appointments.herokuapp.com/api",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},_onPluginUpdate:function*(e,t,r,n,a,i,o){var s=yield(0,u.select)(l.selectPluginConfig,r,t),d=(0,l.GetRegisteredConfig)(s.get("subtype"))(s.config),p=s.set("config",d),c=e.stageModel.getModelValue([]).get(p.get("id")),f=null==c?void 0:c.get("queryRunner");return(f=(0,l.AjaxQueryRunner)()).initClient(p.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[p.get("id"),"queryRunner"],newValue:f}]}},get onPluginUpdate(){return this._onPluginUpdate},set onPluginUpdate(e){this._onPluginUpdate=e},getQueries:function(){return c},getQueryInputParams:function(e){var t=c&&c[e]?c[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl;return!!t&&{apiBaseUrl:t}},resolveClearCredentialConfigs:function(){return["apiBaseUrl"]},getPlatformIdentifier:function(){return"easyAppointment"},runQuery:function*(e,t,r,n,a,i){var o=c[n];if(o)return yield g(e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"easyAppointment",type:"datasource",name:"Easy Appointment",description:"",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:f})},8785:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformData=void 0,t.TransformData=function(e){return{data:e}}},7581:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.feraEditors=t.default=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(9793),c={isPaginated:!1,contextInputParams:{proxyUrl:"",appId:""},paginationResolver:function(e,t){return{}},endpointResolver:function(e,t){return e},inputResolver:function(e){return e},transformer:function(e){return e}},f={getAllReviews:Object.assign({},c,{queryType:"get",endpoint:"/reviews",editableInputParams:{sort_by:"",include_aggregate_rating:"",limit:"",subject:"both or product or store"},endpointResolver:function(e,t,r){var n,a=t.sort_by,i=t.include_aggregate_rating,o=t.limit,s=t.subject;return n=r?Number.parseInt(t.limit)+Number.parseInt(null==r?void 0:r.offset):0,`${e}?limit=${Number.parseInt(o)}&sort_by=${a}&offset=${n}&include_aggregate_rating=${i}&subject=${s}`},transformer:p.TransformReviews,isPaginated:!0}),getProductReviews:Object.assign({},c,{queryType:"get",endpoint:"/products",editableInputParams:{productId:"",include_aggregate_rating:"",limit:"",sort_by:""},endpointResolver:function(e,t,r){var n=t.productId,a=t.include_aggregate_rating,i=t.limit,o=t.sort_by;return`${e}/${n}/reviews?limit=${Number.parseInt(i)}&offset=${r?Number.parseInt(t.limit)+Number.parseInt(null==r?void 0:r.offset):0}&include_aggregate_rating=${a}&sort_by=${o}`},transformer:p.TransformProductReviews,isPaginated:!0}),submitReview:Object.assign({},c,{queryType:"post",endpoint:"/reviews/create",editableInputParams:{heading:"",body:"",isVerified:null,feraCustomerId:"",productId:"",rating:"",email:"",name:"",isProductReview:"true"},inputResolver:function(e){var t=null!=e?e:{};return{heading:t.heading,body:t.body,is_verified:t.isVerified,fera_customer_id:t.feraCustomerId,shopify_product_id:t.productId,rating:t.rating,email:t.email,name:t.name,isProductReview:t.isProductReview}},endpointResolver:function(e,t){return`${e}`},transformer:p.TransformSubmitReview}),getStoreRating:Object.assign({},c,{queryType:"get",endpoint:"/store/rating",editableInputParams:{},endpointResolver:function(e){return e},transformer:p.TransformStoreRating}),getProductRating:Object.assign({},c,{queryType:"get",endpoint:"/product/rating",editableInputParams:{productId:""},endpointResolver:function(e,t){return`/products/${t.productId}/rating`},transformer:p.TransformProductRating})},g=t.feraEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"Fera API Base Url",placeholder:""}},{type:"codeInput",name:"proxyUrl",props:{label:"Proxy API Base Url",placeholder:""}},{type:"codeInput",name:"appId",props:{label:"Apptile App Id",placeholder:""}},{type:"codeInput",name:"apiVersion",props:{label:"Fera Api Version",placeholder:"v3"}}]};t.default=(0,d.default)({name:"fera",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://api.fera.ai",proxyUrl:"https://api.apptile.io/fera",appId:"",apiVersion:"v3",queryRunner:"queryRunner"}),initDatasource:(a=(0,i.default)((function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl"),i=t.config.get("apiVersion"),o=r.get("publicKey");return n.initClient(`${a}/${i}/public`,(function(e){return e.headers=Object.assign({},e.headers,{"Content-Type":"application/json",public_key:null!=o?o:""}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}})),function(e,t,r){return a.apply(this,arguments)}),getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.appId;return!!t&&{appId:t}},resolveClearCredentialConfigs:function(){return["appId"]},getPlatformIdentifier:function(){return"fera"},runQuery:function*(e,t,r,n,a,i){var d,p,c,g=f[n];if(g){var m,y,v,h,b=null!=i?i:{},I=b.getNextPage,P=b.paginationMeta;if(g&&g.contextInputParams){var R=(y=g.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(y).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});m=R(t,r)}g&&g.editableInputParams&&(v=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,g.editableInputParams)),null!=g&&g.isPaginated&&g.paginationResolver&&I&&(v=a),h=g.inputResolver?yield(0,u.call)(g.inputResolver,v):v;var w=g.endpoint;g.endpointResolver&&(w=g.endpointResolver(w,v,P));var T=r.get("queryRunner"),_=null!=(d=null==r?void 0:r.get("appId"))?d:null,O=null!=(p=null==r?void 0:r.get("proxyUrl"))?p:null,S=null!=(c=null==r?void 0:r.get("apiVersion"))?c:null;if(!O||!S||!_)throw new Error("Missing parameters");"/reviews/create"===g.endpoint&&(T=(0,l.AjaxQueryRunner)()).initClient(`${O}`,(function(e){return e.headers=Object.assign({},e.headers,{"X-Shopify-App-Id":null!=_?_:""}),e}));var A,C,U=yield(0,u.call)(T.runQuery,g.queryType,w,Object.assign({},h,m)),j=U&&U.data?U.data:{},x=j;if(g&&g.transformer){var M=g.transformer(j);x=M.data,A=M.hasNextPage,C=M.paginationMeta}return yield{rawData:j,data:x,hasNextPage:A,paginationMeta:C}}},options:{propertySettings:{},pluginListing:{labelPrefix:"fera",type:"datasource",name:"Fera",description:"Fera integration",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g})},9793:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformSubmitReview=t.TransformStoreRating=t.TransformReviews=t.TransformProductReviews=t.TransformProductRating=void 0;var a=n(r(3216)),i=function(e){return{id:null==e?void 0:e.id,review_of:null==e?void 0:e.subject,is_verified:null==e?void 0:e.is_verified,shopify_product_id:null==e?void 0:e.external_product_id,fera_product_id:null==e?void 0:e.product_id,created_at:null==e?void 0:e.created_at,rating:null==e?void 0:e.rating,heading:null==e?void 0:e.heading,body:null==e?void 0:e.body,channel_code:null==e?void 0:e.channel_code,store_reply:null==e?void 0:e.store_reply,counts:e.counts,product:null!=e&&e.product?o(null==e?void 0:e.product):null,customer:null!=e&&e.customer?s(null==e?void 0:e.customer):null,media:null==e?void 0:e.media}},o=function(e){return{id:null==e?void 0:e.id,shopify_product_id:null==e?void 0:e.external_id,name:null==e?void 0:e.name,url:null==e?void 0:e.url,handle:null==e?void 0:e.handle,thumbnail_image_url:null==e?void 0:e.thumbnail_url,image_url:null==e?void 0:e.image_url,rating:(t=null==e?void 0:e.rating,{average:null==t?void 0:t.average,count:null==t?void 0:t.count,counts:null==t?void 0:t.counts}),counts:null==e?void 0:e.counts,tags:null==e?void 0:e.tags,variants:null==e?void 0:e.variants,price:null==e?void 0:e.price,formatted_price:null==e?void 0:e.formatted_price};var t},s=function(e){return{id:null==e?void 0:e.id,shopify_customer_id:null==e?void 0:e.external_id,display_name:null==e?void 0:e.display_name,name:null==e?void 0:e.name,display_location:null==e?void 0:e.display_location,generated_display_name:null==e?void 0:e.generated_display_name,email:null==e?void 0:e.email,is_anonymous:null==e?void 0:e.is_anonymous,avatar_url:null==e?void 0:e.avatar_url,is_verified:null==e?void 0:e.is_verified,media:[]}};t.TransformReviews=function(e){var t,r=e.data,n=e.meta,o=[];a.default.isArray(r)&&r.length>0&&(o=r.map((function(e){return i(e)})));var s=Math.ceil((null==n?void 0:n.total_count)/(null==(t=o)?void 0:t.length)),u=null==n?void 0:n.total_count;return{data:o,hasNextPage:s!==u,paginationMeta:{totalPages:s,totalReviews:u,offset:null==n?void 0:n.offset}}},t.TransformStoreRating=function(e){var t,r={};return e&&(r={review_of:null==(t=e)?void 0:t.subject,average:null==t?void 0:t.average,count:null==t?void 0:t.count,verified_count:null==t?void 0:t.verified_count,counts:null==t?void 0:t.counts}),{data:r}},t.TransformProductReviews=function(e){var t,r=e.data,n=e.meta,o=[];a.default.isArray(r)&&r.length>0&&(o=r.map((function(e){return i(e)})));var s=Math.ceil((null==n?void 0:n.total_count)/(null==(t=o)?void 0:t.length)),u=null==n?void 0:n.total_count;return{data:o,hasNextPage:s!==u,paginationMeta:{totalPages:s,totalReviews:u,offset:null==n?void 0:n.offset}}},t.TransformProductRating=function(e){var t={};return e&&(t={review_of:null==e?void 0:e.subject,average:null==e?void 0:e.average,count:null==e?void 0:e.count,shopify_product_id:null==e?void 0:e.external_product_id,fera_product_id:null==e?void 0:e.product_id}),{data:t}},t.TransformSubmitReview=function(e){return{data:{id:null==e?void 0:e.id,subject:null==e?void 0:e.subject,is_verified:null==e?void 0:e.is_verified,shopify_product_id:null==e?void 0:e.external_product_id,fera_product_id:null==e?void 0:e.product_id,shopify_customer_id:null==e?void 0:e.external_customer_id,fera_customer_id:null==e?void 0:e.customer_id,rating:null==e?void 0:e.rating,heading:null==e?void 0:e.heading,body:null==e?void 0:e.body,is_anonymous:null==e?void 0:e.is_anonymous,store_reply:null==e?void 0:e.store_reply,state:null==e?void 0:e.state,counts:null==e?void 0:e.counts,original_source:null==e?void 0:e.original_source,product:o(null==e?void 0:e.product),customer:s(null==e?void 0:e.customer)}}}},9701:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.findifyEditors=t.default=void 0;var a=n(r(7128)),i=n(r(5990)),o=n(r(7488)),s=r(804),u=n(r(827)),l=r(892),d=r(8296),p=r(6352),c=["collectionHandle"],f={GetCollection:{queryType:"post",endpoint:"/v3/smart-collection/collections/${collectionHandle}",endpointResolver:function(e){return`/v3/smart-collection/collections/${null==e?void 0:e.collectionHandle}`},contextInputParams:{key:"apiAccessKey",user:"user"},editableInputParams:{collectionHandle:"",limit:12,offset:0},inputResolver:function(e){var t=e.collectionHandle,r=(0,a.default)(e,c);return Object.assign({slot:`collections/${t}`},r)},isPaginated:!0,paginationResolver:function(e,t){var r=t.after;return Object.assign({},e,{after:r})}}},g=t.findifyEditors={basic:[{type:"codeInput",name:"apiBaseUrl",defultValue:"https://api-v3.findify.io",props:{label:"API Base url",placeholder:"https://api-v3.findify.io"}},{type:"codeInput",name:"apiAccessKey",props:{label:"Findify API Key",placeholder:""}}]},m=null;t.default=(0,u.default)({name:"Findify",config:{apiBaseUrl:"https://api-v3.findify.io",apiAccessKey:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){var r=t.config.get("apiAccessKey");return r&&(e.headers["x-key"]=`${r}`),e})),m={uid:p.Platform.select({native:(0,l.getUniqueDeviceId)(),web:(0,d.v4)()}),sid:(0,d.v4)()},{modelUpdates:[{selector:[r.get("id")].concat("user"),newValue:m},{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},runQuery:function*(e,t,r,n,a,u){var l=f[n];if(l){var d,p,c,g,m=u.getNextPage,y=u.paginationMeta;if(l&&l.contextInputParams){var v=(p=l.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(p).reduce((function(e,n){var a=(0,o.default)(n,2),s=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,i.default)({},s,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,i.default)({},s,t.get(u))):e}),{})});d=v(t,r)}l&&l.editableInputParams&&(c=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,o.default)(r,2),a=n[0],s=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,i.default)({},a,isNaN(s)&&typeof s==typeof t[a]?s:parseInt(s))):s?Object.assign({},e,(0,i.default)({},a,s)):e:e}),{})}(a,l.editableInputParams)),null!=l&&l.isPaginated&&l.paginationResolver&&m&&(c=l.paginationResolver(c,y)),g=l.inputResolver?l.inputResolver(c):c;var h=l.endpoint;l.endpointResolver&&(h=l.endpointResolver(c));var b,I,P=r.get("queryRunner"),R=yield(0,s.call)(P.runQuery,l.queryType,h,Object.assign({},g,d,{t_client:(new Date).valueOf()}),u),w=R&&R.data?R.data:{},T=w;if(l&&l.transformer){var _=l.transformer(w,l.transformers);T=_.data,b=_.hasNextPage,I=_.paginationMeta}return yield{rawData:w,data:T,hasNextPage:b,paginationMeta:I}}},options:{propertySettings:{},pluginListing:{labelPrefix:"findify",type:"datasource",name:"Findify Integration",description:"Findify store front integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g})},646:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.googleMapsDatasourcePropertySettings=t.googleMapsDatasourcePluginConfig=t.default=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=r(5050),d=(t.googleMapsDatasourcePluginConfig={getPlacesSuggestion:u.TriggerActionIdentifier,getPlaceDetails:u.TriggerActionIdentifier,predictions:[],sessionToken:""},t.googleMapsDatasourcePropertySettings={getPlacesSuggestion:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.getPlacesSuggestion},actionMetadata:{editableInputParams:{query:""}}},getPlaceDetails:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.getPlaceDetails},actionMetadata:{editableInputParams:{placeId:""}}}},new((0,s.default)((function e(){var t,r,n=this;(0,o.default)(this,e),this.getPlacesSuggestion=(t=(0,i.default)((function*(e,t,r,a,i){var o=r.get("sessionToken"),s=[];o&&""!==o||(o=n.generateUUID(),s.push({selector:a.concat(["sessionToken"]),newValue:o}),e((0,u.modelUpdateAction)(s,void 0,!0)));var l=i.query,d=(yield n.queryExecutor(r,t,"getSuggestion",{query:l,sessionToken:o})).data;return s.push({selector:a.concat(["predictions"]),newValue:d}),e((0,u.modelUpdateAction)(s,void 0,!0))})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.getPlaceDetails=(r=(0,i.default)((function*(e,t,r,a,i){var o=r.get("sessionToken"),s=i.placeId,l=[],d=(yield n.queryExecutor(r,t,"getPlaceDetails",{sessionToken:o,placeId:s,fields:"address_components"})).data;return l.push({selector:a.concat(["selectedPlace"]),newValue:d}),l.push({selector:a.concat(["predictions"]),newValue:[]}),l.push({selector:a.concat(["sessionToken"]),newValue:""}),e((0,u.modelUpdateAction)(l,void 0,!0))})),function(e,t,n,a,i){return r.apply(this,arguments)})}),[{key:"queryExecutor",value:(a=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,u.GetRegisteredPlugin)(a),o=this.getQueries()[r];return yield(0,l.executeQuery)(i,t,e,o,Object.assign({},n),{})})),function(e,t,r,n){return a.apply(this,arguments)})},{key:"getQueries",value:function(){var e,t=(0,u.GetRegisteredPluginInfo)("googleMaps");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}},{key:"generateUUID",value:function(){var e=4294967296*Math.random()>>>0,t=65536*Math.random()>>>0,r=16384|4096*Math.random()&4095,n=65536*Math.random()>>>0,a=32768|4096*Math.random()&4095;return`${this.padWithZeros(e,8)}-${this.padWithZeros(t,4)}-4${this.padWithZeros(r,3)}-${this.padWithZeros(n,4)}-${this.padWithZeros(a,4)}`}},{key:"padWithZeros",value:function(e,t){for(var r=e.toString(16);r.length<t;)r="0"+r;return r}}])));t.default=d},5050:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.GoogleMapsEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(2001),c=r(646),f={getSuggestion:{queryType:"get",endpoint:"/maps/api/place/autocomplete/json",endpointResolver:function(e,t){return`${e}?input=${encodeURIComponent(t.query)}&sessiontoken=${t.sessionToken}`},editableInputParams:{query:"",sessionToken:""},isPaginated:!1,transformer:p.GoogleMapsSuggestionsTransformer,checkInputVariabes:function(e){return!!e.query}},getPlaceDetails:{queryType:"get",endpoint:"/maps/api/place/details/json",endpointResolver:function(e,t){return`${e}?place_id=${t.placeId}&fields=${t.fields}&sessiontoken=${t.sessionToken}`},editableInputParams:{placeId:"",fields:"",sessionToken:""},isPaginated:!1,checkInputVariabes:function(e){return!!e.placeId},transformer:p.GoogleMapsPlaceDetailsTransformer}},g=Object.assign({},c.googleMapsDatasourcePropertySettings),m=t.GoogleMapsEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Url",placeholder:""}},{type:"codeInput",name:"apiKey",props:{label:"API KEY",placeholder:""}}]},y=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{var u;if(!n)throw new Error("Invalid Query");var l,d=null!=i?i:{},p=d.getNextPage,c=d.paginationMeta;if(n&&n.contextInputParams){var f=(j=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(j).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});l=f(t,r)}var g,m,y=!0;n&&n.editableInputParams&&(g=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(y=n.checkInputVariabes(g))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(g=n.paginationResolver(g,c)),m=n.inputResolver?n.inputResolver(g):g;var v=n.endpoint;n.endpointResolver&&(v=n.endpointResolver(v,g,c));var h=null!=(u=null==r?void 0:r.get("apiKey"))?u:null;if(!h)throw new Error("Please give an API KEY");var b,I,P,R=r.get("queryRunner"),w=(b=y?yield R.runQuery(n.queryType,`${v}&key=${h}`,Object.assign({},m,l)):{errors:{message:"Missing input variables"},data:null})&&b.data?b.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w,c),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,I=S,P=A}return{rawData:w,data:T,hasNextPage:I,paginationMeta:P}}catch(e){var C,U;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(C=e.request)&&C.response?new Error(JSON.parse(null==e||null==(U=e.request)?void 0:U.response).message):e],hasError:!0}}var j})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"googleMaps",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"http://localhost:3000",queryRunner:"queryrunner"},c.googleMapsDatasourcePluginConfig),initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl");return n.initClient(a,(function(e){return e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"googleMaps"},runQuery:function*(e,t,r,n,a,i){var o=f[n];if(o)return yield(0,u.call)(y,e,t,r,o,a,i)},options:{propertySettings:g,pluginListing:{labelPrefix:"googleMaps",type:"datasource",name:"Google Maps",description:"Google Maps AutoComplete",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:m})},2001:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleMapsSuggestionsTransformer=t.GoogleMapsPlaceDetailsTransformer=void 0;var a=n(r(3216)),i=r(892);t.GoogleMapsSuggestionsTransformer=function(e){if(e){var t=e.predictions;return{data:(0,i.jsonArrayMapper)([{field:"title",path:"description"},{field:"placeId",path:"place_id"}],t)}}},t.GoogleMapsPlaceDetailsTransformer=function(e){var t,r,n,i;if(e&&null!=e&&e.result){var o=e.result.address_components,s=null==(t=a.default.find(o,(function(e){return e.types.includes("administrative_area_level_1")})))?void 0:t.long_name,u=null==(r=a.default.find(o,(function(e){return e.types.includes("locality")})))?void 0:r.long_name;return{data:{state:s,country:null==(n=a.default.find(o,(function(e){return e.types.includes("country")})))?void 0:n.long_name,city:u,zip:null==(i=a.default.find(o,(function(e){return e.types.includes("postal_code")})))?void 0:i.long_name}}}}},9872:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.HRTechEditors=void 0;var a,i,o=n(r(2766)),s=n(r(5990)),u=n(r(7488)),l=r(804),d=r(892),p=n(r(827)),c={login:{queryType:"post",endpoint:"/users/login",editableInputParams:{email:"",password:""}},userVerification:{queryType:"get",endpoint:"/users/current"},getAllMessages:{queryType:"get",endpoint:"/users/current/messages"},sendMessage:{queryType:"post",endpoint:"/users/current/messages",editableInputParams:{message:""}}},f={setUserToken:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return null==e?void 0:e.get("setUserToken")},actionMetadata:{editableInputParams:{userToken:""}}},setUserData:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return null==e?void 0:e.get("setUserData")},actionMetadata:{editableInputParams:{userData:""}}}},g=t.HRTechEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API URL",placeholder:""}},{type:"codeInput",name:"apiKey",props:{label:"API Key",placeholder:""}}]},m={name:"HRTech",config:{isInitialized:!1,apiBaseUrl:"https://hrtech.apptile.io",apiKey:"",userToken:"",userData:"",setUserToken:"",setUserData:"",queryRunner:""},initDatasource:function*(e,t,r){var n=(0,d.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl"),i=yield d.LocalStorage.getValue("@userToken"),o=yield d.LocalStorage.getValue("@userData");return n.initClient(a,(function(e){return e})),{modelUpdates:[{selector:[t.get("id"),"isInitialized"],newValue:!0},{selector:[t.get("id"),"userToken"],newValue:i},{selector:[t.get("id"),"userData"],newValue:o},{selector:[t.get("id"),"setUserToken"],newValue:m.setUserToken},{selector:[t.get("id"),"setUserData"],newValue:m.setUserData},{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return c},getQueryInputParams:function(e){var t,r=null==c?void 0:c[e];return null!=(t=null==r?void 0:r.editableInputParams)?t:{}},getPlatformIdentifier:function(){return"HRTech"},runQuery:function*(e,t,r,n,a,i){var o,d=c[n],p=t.config.get("apiKey"),f=r.get("userToken");if(d){var g,m,y,v,h=null!=i?i:{},b=h.getNextPage,I=h.paginationMeta;if(d&&d.contextInputParams){var P=(m=d.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(m).reduce((function(e,n){var a=(0,u.default)(n,2),i=a[0],o=a[1];return r&&r.get(o)?Object.assign({},e,(0,s.default)({},i,r.get(o))):t&&t.get(o)?Object.assign({},e,(0,s.default)({},i,t.get(o))):e}),{})});g=P(t,r)}d&&d.editableInputParams&&(y=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,u.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,s.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i,10))):i?Object.assign({},e,(0,s.default)({},a,i)):e:e}),{})}(a,d.editableInputParams)),null!=d&&d.isPaginated&&d.paginationResolver&&b&&(y=d.paginationResolver(y,I)),v=d.inputResolver?yield(0,l.call)(d.inputResolver,y):y;var R=d.endpoint;d.endpointResolver&&(R=d.endpointResolver(R,y,I));var w,T,_=r.get("queryRunner"),O="login"!==R,S=yield(0,l.call)(_.runQuery,d.queryType,R,Object.assign({},v,g),{headers:Object.assign({"x-organization-id":p},O&&f?{Authorization:`Bearer ${f}`}:{})},i),A=null!=(o=null==S?void 0:S.data)?o:{},C=A;if(d&&d.transformer){var U=d.transformer(A,I);C=U.data,w=U.hasNextPage,T=U.paginationMeta}return{rawData:A,data:C,hasNextPage:w,paginationMeta:T}}},setUserToken:(i=(0,o.default)((function*(e,t,r,n,a,i,o){yield d.LocalStorage.setValue("@userToken",a.userToken||""),e((0,d.modelUpdateAction)([{selector:n.concat(["userToken"]),newValue:a.userToken}],void 0,!0))})),function(e,t,r,n,a,o,s){return i.apply(this,arguments)}),setUserData:(a=(0,o.default)((function*(e,t,r,n,a,i,o){yield d.LocalStorage.setValue("@userData",a.userData||""),e((0,d.modelUpdateAction)([{selector:n.concat(["userData"]),newValue:a.userData}],void 0,!0))})),function(e,t,r,n,i,o,s){return a.apply(this,arguments)}),options:{propertySettings:f,pluginListing:{labelPrefix:"HRTech",type:"datasource",name:"HRTech",description:"HRTech datasource!",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g};t.default=(0,p.default)(m)},740:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.instagramMediaEditors=t.default=void 0;var n=r(804),a=r(892),i={getPosts:{queryType:"get",endpoint:"/api/instagram/media/posts",endpointResolver:function(e,t,r,n){return`${e}?orgId=${r}&appId=${t}${n?"&limit="+n:""}`},editableInputParams:{limit:0}},getReels:{queryType:"get",endpoint:"/api/instagram/media/reels",endpointResolver:function(e,t,r,n){return`${e}?orgId=${r}&appId=${t}${n?"&limit="+n:""}`},editableInputParams:{limit:0}},getCarousel:{queryType:"get",endpoint:"/api/instagram/media/carousel",endpointResolver:function(e,t,r,n){return`${e}?orgId=${r}&appId=${t}${n?"&limit="+n:""}`},editableInputParams:{limit:0},transformer:function(e){var t=[];return e.forEach((function(e){"CAROUSEL_ALBUM"===e.media_type&&e.children.data.forEach((function(r){t.push(Object.assign({},e,r))}))})),t}}},o=t.instagramMediaEditors={basic:[{type:"codeInput",name:"appId",defultValue:"",props:{label:"App ID",placeholder:"Apptile App Id"}},{type:"codeInput",name:"orgId",defultValue:"",props:{label:"Org ID",placeholder:"Organization Id"}},{type:"codeInput",name:"apptileServerBaseUrl",defultValue:"",props:{label:"Apptile Server Base Url",placeholder:"https://api.apptile.local"}}]};t.default=(0,a.wrapDatasourceModel)({name:"instagramMedia",config:Object.assign({},a.baseDatasourceConfig),initDatasource:function*(e,t,r){var n=(0,a.AjaxQueryRunner)(),i=`${r.get("apptileServerBaseUrl")}/apptile-instagram-connector`;return n.initClient(i,(function(e){return e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return i},getQueryInputParams:function(e){var t=i&&i[e]?i[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},runQuery:function*(e,t,r,a,o,s){var u,l=i[a],d=r.get("appId"),p=r.get("orgId"),c=parseInt(o.limit)||void 0,f=null==l.endpointResolver?void 0:l.endpointResolver(l.endpoint,d,p,c),g=r.get("queryRunner"),m=(yield(0,n.call)(g.runQuery,l.queryType,f)).data;return u=l.transformer?l.transformer(m):m,yield{rawData:m,data:u,transformedHasError:!1,transformedError:[],queryHasNextPage:!1,paginationDetails:{}}},options:{propertySettings:{},pluginListing:{labelPrefix:"instagramMedia",type:"datasource",name:"Instagram Media",description:"Keep your users up to date with your latest Instagram Posts",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:o})},3684:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.authActionsDatasourcePropertySettings=t.authActionsDatasourcePluginConfig=t.authActionDatasourceEditor=void 0;var a,i=n(r(7488)),o=n(r(2766)),s=n(r(2584)),u=n(r(3664)),l=r(804),d=r(892),p=n(r(3216)),c=r(8784),f=r(1177),g=(t.authActionsDatasourcePluginConfig={signUpUser:d.TriggerActionIdentifier,verifySignUp:d.TriggerActionIdentifier,signInUser:d.TriggerActionIdentifier,verifySignIn:d.TriggerActionIdentifier,setSignInStep:d.TriggerActionIdentifier,setUpProfile:d.TriggerActionIdentifier,setSignUpStep:d.TriggerActionIdentifier,signInWithShopify:d.TriggerActionIdentifier,signUpWithShopify:d.TriggerActionIdentifier,resetCustomerData:d.TriggerActionIdentifier},t.authActionDatasourceEditor={},t.authActionsDatasourcePropertySettings={signUpUser:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.signUpUser},actionMetadata:{editableInputParams:{email:"",mobile:"",firstname:"",lastname:"",password:""}}},verifySignUp:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.verifySignUp},actionMetadata:{editableInputParams:{otp:"",successMessage:""}}},setUpProfile:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.setUpProfile},actionMetadata:{editableInputParams:{email:"",mobile:"",countryCode:"",firstname:"",lastname:"",dob:"",gender:"",successMessage:"",badParameterMessage:"",errorMessage:""}}},signInUser:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.signInUser},actionMetadata:{editableInputParams:{mobile:""}}},verifySignIn:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.verifySignIn},actionMetadata:{editableInputParams:{mobile:"",otp:"",successMessage:"",errorMessage:"",skipPostAuthRedirect:"{{true}}",badParameterMessage:""}}},setSignInStep:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.setSignInStep},actionMetadata:{editableInputParams:{signInPageStep:""}}},setSignUpStep:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.setSignUpStep},actionMetadata:{editableInputParams:{signUpPageStep:""}}},signInWithShopify:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return g.signInWithShopify},actionMetadata:{editableInputParams:{successMessage:"",badParameterMessage:"",errorMessage:""}}},signUpWithShopify:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.signUpWithShopify},actionMetadata:{editableInputParams:{successMessage:"",badParameterMessage:"",errorMessage:""}}},resetCustomerData:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return m.resetCustomerData},actionMetadata:{editableInputParams:{}}}},function(){function e(){var t,r;(0,s.default)(this,e),this.signInUser=(t=(0,o.default)((function*(t,r,n,a,i,o,s){var u=i.mobile,l=null==n?void 0:n.get("countryCode"),p=[{selector:a.concat(["authLoader"]),newValue:!0}];t((0,d.modelUpdateAction)(p,void 0,!0));var c=yield e.queryExecutor(n,r,"signIn",{mobile:u,countryCode:l}),f=(c.data,c.errors);if(f){var g=Array.isArray(f)?f[0]:f;console.error(g,"Error While Verifying OTP For Jolene");var m={mobile:u};e.setBadParamErrorMessage(t,r,n,a,!0,g,m,void 0)}else{var y=[{selector:a.concat(["mobile"]),newValue:u},{selector:a.concat(["signInPageStep"]),newValue:"VERIFY_SIGN_IN"},{selector:a.concat(["authLoader"]),newValue:!1}];t((0,d.modelUpdateAction)(y,void 0,!0))}})),function(e,r,n,a,i,o,s){return t.apply(this,arguments)}),this.signUpUser=(r=(0,o.default)((function*(t,r,n,a,i,o,s){try{var u=i,l=u.email,p=u.mobile,c=u.firstname,f=u.lastname,g=u.password,m=null==n?void 0:n.get("countryCode"),y=[{selector:a.concat(["authLoader"]),newValue:!0}];t((0,d.modelUpdateAction)(y,void 0,!0));var v=yield e.queryExecutor(n,r,"signUp",{email:l,mobile:p,countryCode:m,password:g,areUpdatesOpted:!0}),h=(v.data,v.errors);if(h){var b=Array.isArray(h)?h[0]:h;console.error(b,"Error While SignUp User For Jolene");var I={email:l,mobile:p,firstname:c,lastname:f,password:g};return void e.setBadParamErrorMessage(t,r,n,a,!0,b,I,void 0)}var P=[{selector:a.concat(["email"]),newValue:l},{selector:a.concat(["password"]),newValue:g},{selector:a.concat(["mobile"]),newValue:p},{selector:a.concat(["authLoader"]),newValue:!1},{selector:a.concat(["firstname"]),newValue:c},{selector:a.concat(["lastname"]),newValue:f},{selector:a.concat(["signUpPageStep"]),newValue:"VERIFY_SIGNUP"}];t((0,d.modelUpdateAction)(P,void 0,!0))}catch(e){console.log("Error signUpResponse",e)}})),function(e,t,n,a,i,o,s){return r.apply(this,arguments)}),this.verifySignUp=function*(t,r,n,a,i,o,s){var u=null==n?void 0:n.get("email"),p=null==n?void 0:n.get("mobile"),c=null==n?void 0:n.get("countryCode"),f=i,g=f.otp,m=f.successMessage;try{var y=[{selector:a.concat(["authLoader"]),newValue:!0}];t((0,d.modelUpdateAction)(y,void 0,!0));var v=yield(0,l.call)(e.queryExecutor,n,r,"verifySignUp",{email:u,mobile:p,otp:g,countryCode:c}),h=(v.data,v.errors);if(h){var b=Array.isArray(h)?h[0]:h;if(console.error(b,"Error While SignUp User For Jolene"),"User already exists on shopify"==b){var I=[{selector:a.concat(["signUpPageStep"]),newValue:"SIGN_UP"}];t((0,d.modelUpdateAction)(I,void 0,!0))}return void e.setBadParamErrorMessage(t,r,n,a,!0,b,{},void 0)}var P=[{selector:a.concat(["authLoader"]),newValue:!1},{selector:a.concat(["signUpPageStep"]),newValue:"PERSONAL_DETAILS"}];t((0,d.modelUpdateAction)(P,void 0,!0)),e.setSuccessMessage(t,r,n,a,m)}catch(i){console.log("Error while Verifying SignUp for Jolene",i),e.setBadParamErrorMessage(t,r,n,a,!0,i,{},void 0)}},this.setUpProfile=function*(t,r,n,a,i,o,s){var u=i.email,p=i.mobile,c=i.countryCode,f=i.firstname,g=i.lastname,m=i.dob,y=i.gender,v=i.successMessage,h=i.badParameterMessage,b=i.errorMessage,I=[{selector:a.concat(["authLoader"]),newValue:!0}];t((0,d.modelUpdateAction)(I,void 0,!0));var P=yield(0,l.call)(e.queryExecutor,n,r,"setUpProfile",{mobile:p,countryCode:c,firstname:f,lastname:g,dob:m,gender:y,email:u}),R=P.data,w=P.errors;if(w){var T=Array.isArray(w)?w[0]:w;return console.error(T,"Error While Setting Up Profile for Jolene"),void e.setBadParamErrorMessage(t,r,n,a,!0,T,{},void 0)}var _=R.email,O=R.password,S=[{selector:a.concat(["authLoader"]),newValue:!1},{selector:a.concat(["email"]),newValue:_},{selector:a.concat(["password"]),newValue:O}];t((0,d.modelUpdateAction)(S,void 0,!0)),yield e.signInWithShopify(t,r,n,a,{email:_,password:O,successMessage:v,badParameterMessage:h,errorMessage:b},void 0,void 0)},this.signUpWithShopify=function*(e,t,r,n,a,i,o){var s=a,u=null==r?void 0:r.get("email"),p=null==r?void 0:r.get("password"),f=null==r?void 0:r.get("mobile"),g=`+${null==r?void 0:r.get("countryCode")}${f}`;try{var m=yield(0,c.getShopifyDS)(),y=m.shopifyModelValues,v=m.shopifyConfig,h=y.get("signUpUser"),b=yield(0,l.call)(h,e,v,y,["shopify"],Object.assign({email:u,password:p,phone:g},s),!0),I=(b.signUpSuccess,b.error);I&&console.error(I);var P=[{selector:n.concat(["signUpPageStep"]),newValue:"SIGN_UP"}];e((0,d.modelUpdateAction)(P,void 0,!0))}catch(I){console.log("Error while Verifying SignUp for Jolene",I)}},this.setSignUpStep=function(e,t,r,n,a,i,o){try{var s=a.signUpPageStep,u=[{selector:n.concat(["signUpPageStep"]),newValue:s}];e((0,d.modelUpdateAction)(u,void 0,!0))}catch(e){console.log(e)}},this.setSignInStep=function(e,t,r,n,a,i,o){try{var s=a.signInPageStep,u=[{selector:n.concat(["signInPageStep"]),newValue:s}];e((0,d.modelUpdateAction)(u,void 0,!0))}catch(e){console.log(e)}},this.resetCustomerData=function(e,t,r,n,a,i,o){try{var s=[{selector:n.concat(["email"]),newValue:""},{selector:n.concat(["mobile"]),newValue:""},{selector:n.concat(["firstname"]),newValue:""},{selector:n.concat(["lastname"]),newValue:""}];e((0,d.modelUpdateAction)(s,void 0,!0))}catch(e){console.log(e)}},this.verifySignIn=function*(t,r,n,a,i,o,s){try{var u=i,p=u.mobile,f=u.otp,g=u.successMessage,m=u.errorMessage,y=u.skipPostAuthRedirect,v=u.badParameterMessage,h=null==n?void 0:n.get("countryCode"),b=[{selector:a.concat(["authLoader"]),newValue:!0}];t((0,d.modelUpdateAction)(b,void 0,!0));var I=yield(0,l.call)(e.queryExecutor,n,r,"verifySignIn",{mobile:p,countryCode:h,otp:f}),P=I.data,R=I.errors;if(R){var w=Array.isArray(R)?R[0]:R;return console.error(w,"Error While Verifying OTP For Jolene"),void e.setBadParamErrorMessage(t,r,n,a,!0,w,{},void 0)}var T=P.email,_=P.password,O=yield(0,c.getShopifyDS)(),S=O.shopifyModelValues,A=O.shopifyConfig,C=S.get("signInUser"),U=yield(0,l.call)(C,t,A,S,["shopify"],{email:T,password:_,successMessage:g,errorMessage:m,skipPostAuthRedirect:y,badParameterMessage:v}),j=(U.success,U.error);if(j)return void console.error(j);var x=[{selector:a.concat(["authLoader"]),newValue:!1},{selector:a.concat(["mobile"]),newValue:""},{selector:a.concat(["signInPageStep"]),newValue:"SIGN_IN"}];t((0,d.modelUpdateAction)(x,void 0,!0))}catch(e){console.log("Error signUpResponse",e)}}}return(0,u.default)(e,[{key:"setBadParamErrorMessage",value:function(e,t,r,n,a,o,s,u){var l=u||s,c=[];c.push({selector:n.concat(["authLoader"]),newValue:!1}),p.default.entries(o||[]).map((function(e){var t=(0,i.default)(e,2),r=t[0],a=t[1];return c.push({selector:n.concat([r]),newValue:a})})),toast.show(l,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,d.modelUpdateAction)(c,void 0,!0))}}],[{key:"queryExecutor",value:(r=(0,o.default)((function*(t,r,n,a){var i=t.get("pluginType"),o=(0,d.GetRegisteredPlugin)(i),s=e.getQueries()[n];return yield(0,f.executeQuery)(o,r,t,s,Object.assign({},a),{})})),function(e,t,n,a){return r.apply(this,arguments)})},{key:"getQueries",value:function(){var e,t=(0,d.GetRegisteredPluginInfo)("Jolene Otp Login");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}},{key:"setSuccessMessage",value:(t=(0,o.default)((function*(e,t,r,n,a){var i=[];i.push({selector:n.concat(["authLoader"]),newValue:!1}),toast.show(a,{type:"success",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,d.modelUpdateAction)(i,void 0,!0))})),function(e,r,n,a,i){return t.apply(this,arguments)})}]);var t,r}());a=g,g.signInWithShopify=function*(e,t,r,n,i,o,s){var u=i,p=u.email,f=u.password,g=u.successMessage,m=u.badParameterMessage,y=u.errorMessage;try{var v=yield(0,c.getShopifyDS)(),h=v.shopifyModelValues,b=v.shopifyConfig,I=h.get("signInUser"),P=(yield(0,l.call)(I,e,b,h,["shopify"],{email:p,password:f,successMessage:g,badParameterMessage:m,errorMessage:y},!0)).errorMessage;if(P)return void console.error(P);var R=[{selector:n.concat(["signUpPageStep"]),newValue:"SIGN_UP"},{selector:n.concat(["email"]),newValue:""},{selector:n.concat(["firstname"]),newValue:""},{selector:n.concat(["lastname"]),newValue:""},{selector:n.concat(["password"]),newValue:""},{selector:n.concat(["mobile"]),newValue:""}];e((0,d.modelUpdateAction)(R,void 0,!0))}catch(P){return console.log("Error while Verifying SignUp for Jolene",P),a.setBadParamErrorMessage(e,t,r,n,!1,P,{},void 0)}},g.setBadParamErrorMessage=function(e,t,r,n,a,o,s,u){var l=null!=u?u:o,c=[];c.push({selector:n.concat(["authLoader"]),newValue:!1}),p.default.entries(s||[]).map((function(e){var t=(0,i.default)(e,2),r=t[0],a=t[1];return c.push({selector:n.concat([r]),newValue:a})})),toast.show(l,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,d.modelUpdateAction)(c,void 0,!0))};var m=new g;t.default=m},2872:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.clickpostActionsDatasourcePropertySettings=t.clickpostActionsDatasourcePluginConfig=t.clickpostActionDatasourceEditor=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=(t.clickpostActionsDatasourcePluginConfig={getSecurityKey:u.TriggerActionIdentifier},t.clickpostActionDatasourceEditor={},t.clickpostActionsDatasourcePropertySettings={getSecurityKey:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return l.getSecurityKey},actionMetadata:{editableInputParams:{waybill:""}}}},new((0,s.default)((function e(){var t;(0,o.default)(this,e),this.getSecurityKey=(t=(0,i.default)((function*(t,r,n,a,i,o,s){try{var l=i.waybill;if(!l)return void e.setErrorMessage(t,r,n,a,"Waybill doesn't exist",void 0);var d=[{selector:a.concat(["returnLoader"]),newValue:!0}];t((0,u.modelUpdateAction)(d,void 0,!0));var p=null==n?void 0:n.get("apptileServerUrl"),c=null==n?void 0:n.get("clickpostJoleneUrl"),f=null==n?void 0:n.get("appId"),g=(0,u.AjaxQueryRunner)();g.initClient(c,(function(e){return e}));var m=yield g.runQuery("get",`/api/v1/track-order?waybill=${l}`,{},{}),y=(0,u.AjaxQueryRunner)();y.initClient(p,(function(e){return e}));var v=yield y.runQuery("get",`/apptile-clickpost/api/clickpost/get-security-key?appId=${f}&waybill=${l}&cp_id=${m.data.result.cp_id}`,{},{}),h=[{selector:a.concat(["securityKey"]),newValue:v.data.securityKey}],b=null==n?void 0:n.get("returnWebviewScreenId");t((0,u.modelUpdateAction)(h,void 0,!0));var I=[{selector:a.concat(["returnLoader"]),newValue:!1}];t((0,u.modelUpdateAction)(I,void 0,!0)),t((0,u.navigateToScreen)(b,{returnUrl:`${c}/returns?waybill=${l}&security_key=${v.data.securityKey}`}))}catch(i){console.error(i);var P=[{selector:a.concat(["returnLoader"]),newValue:!1}];return t((0,u.modelUpdateAction)(P,void 0,!0)),void e.setErrorMessage(t,r,n,a,i.message,"Something Went Wrong")}})),function(e,r,n,a,i,o,s){return t.apply(this,arguments)})}),null,[{key:"setErrorMessage",value:(a=(0,i.default)((function*(e,t,r,n,a,i){var o=i||a;toast.show(o,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}})})),function(e,t,r,n,i,o){return a.apply(this,arguments)})}])));t.default=l},1177:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.JoleneAuthEditors=void 0;var a,i=n(r(2766)),o=r(892),s=n(r(827)),u=r(3684),l=r(2872),d={signUp:{queryType:"post",endpoint:"/v1/sign-up/start",endpointResolver:function(e,t,r){return e},editableInputParams:{email:"",mobile:"",countryCode:"",password:"",areUpdatesOpted:""}},verifySignUp:{queryType:"post",endpoint:"/v1/sign-up/verify",endpointResolver:function(e,t,r){return e},editableInputParams:{email:"",mobile:"",otp:"",countryCode:""}},signIn:{queryType:"post",endpoint:"/v1/login/start",endpointResolver:function(e,t){return e},editableInputParams:{mobile:"",countryCode:""},isPaginated:!1},setUpProfile:{queryType:"post",endpoint:"/v1/sign-up/setup-profile",editableInputParams:{email:"",mobile:"",countryCode:"",firstname:"",lastname:"",dob:"",gender:""},isPaginated:!1},verifySignIn:{queryType:"post",endpoint:"/v1/login/verify",inputResolver:function(e){return{email:e.email,password:e.password}},editableInputParams:{mobile:"",otp:"",countryCode:""},isPaginated:!1}},p=Object.assign({},u.authActionsDatasourcePropertySettings,l.clickpostActionsDatasourcePropertySettings),c=t.JoleneAuthEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Url",placeholder:""}},{type:"codeInput",name:"countryCode",props:{label:"Country Code",placeholder:"91"}},{type:"codeInput",name:"apptileServerUrl",props:{label:"apptileServerUrl",placeholder:"https://api.apptile.io"}},{type:"codeInput",name:"clickpostJoleneUrl",props:{label:"clickpostJoleneUrl",placeholder:"https://jolene.clickpost.in"}},{type:"codeInput",name:"appId",props:{label:"appId",placeholder:"App Id"}},{type:"screenSelector",name:"returnWebviewScreenId",props:{label:"Return Webview Screen"}}]};t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var o=null!=i?i:{},s=(o.getNextPage,o.paginationMeta,n.endpoint),u=r.get("queryRunner"),l=yield u.runQuery(n.queryType,s,a),d=l&&l.data?l.data:{};return{rawData:d,data:d,hasNextPage:!1,paginationMeta:null}}catch(e){var p,c,f;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:null!=(p=null==e||null==(c=e.response)||null==(f=c.data)?void 0:f.message)?p:["Please Contact Support!"],hasError:!0}}})),function(e,t,r,n,i,o){return a.apply(this,arguments)}),t.default=(0,s.default)({name:"Jolene Otp Login",config:Object.assign({},o.baseDatasourceConfig,{apiBaseUrl:"https://qaqoqn2zyg.execute-api.ap-south-1.amazonaws.com/Dev",countryCode:"91",queryRunner:"queryrunner",email:"",password:"",mobile:"",firstname:"",lastname:"",securityKey:"",otpSentCount:"0",signInPageStep:"SIGN_IN",signUpPageStep:"SIGN_UP",authLoader:"false",returnLoader:!1},u.authActionsDatasourcePluginConfig,l.clickpostActionsDatasourcePluginConfig),initDatasource:function*(e,t,r){var n,a=(0,o.AjaxQueryRunner)(),i=null==(n=t.config)?void 0:n.get("apiBaseUrl");return a.initClient(i,(function(e){return e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:a}]}},getQueries:function(){return d},getQueryInputParams:function(e){var t=d&&d[e]?d[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"joleneAuth"},runQuery:function*(e,t,r,n,a,i){if(d[n])return{rawData:"",data:"",hasNextPage:!1,paginationMeta:null,errors:[],hasError:!1}},options:{propertySettings:p,pluginListing:{labelPrefix:"JoleneAuth",type:"datasource",name:"Jolene OTP Login",description:"Enable OTP Login for Jolene",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},8784:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateRandomPassword=function(e){for(var t="",r=0;r<e;r++)t+="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_-+=<>?"[Math.floor(79*Math.random())];return t},t.getShopifyDS=function*(){var e=(yield(0,n.select)()).stageModel.getModelValue([]).get("shopify"),t=(yield(0,n.select)(a.selectAppConfig)).getPlugin("shopify"),r=e.get("pluginType");return{shopifyConfig:t,shopifyModelValues:e,shopifyModel:(0,a.GetRegisteredPlugin)(r)}};var n=r(804),a=r(892)},4946:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.JoyLoyaltyEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p={getCustomerDetail:{queryType:"get",endpoint:"/customers?email={email}",endpointResolver:function(e,t){return e},editableInputParams:{shopifyCustomerAccessToken:""},isPaginated:!1},waysToEarn:{queryType:"get",endpoint:"/earning",endpointResolver:function(e,t){return e},editableInputParams:{},isPaginated:!1},pointsHistory:{queryType:"get",endpoint:"/activities?shopifyCustomerId={shopifyCustomerId}",endpointResolver:function(e,t){return e},editableInputParams:{shopifyCustomerAccessToken:""},isPaginated:!1},waysToEarnByCustomer:{queryType:"get",endpoint:"/earning-programs-by-customer?customerId={customerId}",endpointResolver:function(e,t){return e},editableInputParams:{shopifyCustomerAccessToken:""},isPaginated:!1},redeemCoupon:{queryType:"post",endpoint:"/redeem",endpointResolver:function(e,t){return e},inputResolver:function(e){return{programId:e.programId,redeemPoint:e.redeemPoint}},editableInputParams:{programId:"",redeemPoint:"",shopifyCustomerAccessToken:""},isPaginated:!1},awardSocialInteractionPoints:{queryType:"post",endpoint:"/earn/interact-social",endpointResolver:function(e,t){return e},inputResolver:function(e){return{shopifyCustomerId:e.shopifyCustomerId,earningId:e.earningId}},editableInputParams:{shopifyCustomerId:"",earningId:"",shopifyCustomerAccessToken:""},isPaginated:!1},listCoupons:{queryType:"get",endpoint:"/spending",endpointResolver:function(e,t){return e},editableInputParams:{},isPaginated:!1},spendingofSpecificProgram:{queryType:"get",endpoint:"/spending/{spendingProgramId}",endpointResolver:function(e,t){return e.replace("{spendingProgramId}",null==t?void 0:t.spendingProgramId)},editableInputParams:{spendingProgramId:"",shopifyCustomerAccessToken:""},isPaginated:!1},rewards:{queryType:"get",endpoint:"/rewards?customerId={customerId}",endpointResolver:function(e,t){return e},isPaginated:!1,editableInputParams:{shopifyCustomerAccessToken:"",before:"",after:""}},specificRewardDetails:{queryType:"get",endpoint:"/rewards/{customerRewardId}",endpointResolver:function(e,t){return e.replace("{customerRewardId}",null==t?void 0:t.customerRewardId)},editableInputParams:{customerRewardId:"",shopifyCustomerAccessToken:""},isPaginated:!1},listVipTiers:{queryType:"get",endpoint:"/tiers",endpointResolver:function(e,t){return e},editableInputParams:{shopifyCustomerAccessToken:""},isPaginated:!1}},c=t.JoyLoyaltyEditors={basic:[{type:"codeInput",name:"proxyUrl",props:{label:"proxyUrl",placeholder:"https://api.apptile.io/joy-loyalty-proxy"}},{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:"https://dev-api.joy.so/rest_api/v1"}},{type:"codeInput",name:"appId",props:{label:"app Id",placeholder:""}}]},f=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(C=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(C).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariables&&(m=n.checkInputVariables(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,f,p));var v,h,b,I=r.get("queryRunner"),P=(v=m?yield I.runQuery(n.queryType,y,Object.assign({},g,u),{headers:{"x-shopify-customer-access-token":(null==a?void 0:a.shopifyCustomerAccessToken)||null}}):{errors:{message:"Missing input variables"},data:null})&&v.data?v.data:{},R=P;if(n&&n.transformer){var w=n.transformer(P,p),T=w.data,_=w.hasNextPage,O=w.paginationMeta;R=T,h=_,b=O}return{rawData:P,data:R,hasNextPage:h,paginationMeta:b}}catch(e){var S,A;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(S=e.request)&&S.response?new Error(JSON.parse(null==e||null==(A=e.request)?void 0:A.response).message):e],hasError:!0}}var C})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"joyLoyalty",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://dev-api.joy.so/rest_api/v1",localProxyUrl:"https://api.apptile.local/joy-loyalty-proxy",proxyUrl:"https://api.apptile.io/joy-loyalty-proxy",appId:"",joyLoyaltyCustomerId:"",points:"",queryRunner:"queryrunner"}),resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.joyLoyaltyAppId,n=e.secretKey,a=e.appId;return!!(t&&r&&n)&&{appId:a,apiBaseUrl:t,joyloyaltyappid:r,secretkey:n}},initDatasource:function*(e,t,r){var n,a=(0,l.AjaxQueryRunner)(),i=r.get("proxyUrl");i.endsWith("/")&&(i=i.slice(0,-1));var o=null==(n=t.config)?void 0:n.get("appId");return a.initClient(i,(function(e){return e.headers=Object.assign({"x-shopify-app-id":null!=o?o:""},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:a}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"joyLoyalty"},runQuery:function*(e,t,r,n,a,i){var o=p[n];if(o)return yield(0,u.call)(f,e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"joyLoyalty",type:"datasource",name:"Joy Loyalty",description:"Reward Tracker for JoyLoyalty",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},979:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.JudgeMeEditors=void 0;var a=n(r(5990)),i=n(r(7488)),o=r(804),s=n(r(827)),u=r(892),l=r(6352),d=r(8631),p={getProduct:{queryType:"get",endpoint:"/products",endpointResolver:function(e,t){var r;return`${e}/${null!=(r=t.judgeMeProductId)?r:-1}?handle=${t.handle}`},editableInputParams:{handle:""},transformer:d.transformGetProductData},listProductReviews:{queryType:"get",endpoint:"/reviews",endpointResolver:function(e,t,r){var n,a=(null!=r?r:{}).after,i=void 0===a?1:a;return`${e}?product_id=${t.judgeMeProductId}&per_page=${null!=(n=t.size)?n:10}&page=${i}${t.rating?`&rating=${t.rating}`:""}`},editableInputParams:{judgeMeProductId:"",size:"",rating:""},transformer:d.transformListReviewsData,isPaginated:!0},getProductReviewCount:{queryType:"get",endpoint:"/reviews/count",endpointResolver:function(e,t){return`${e}?product_id=${t.judgeMeProductId}${t.rating?`&rating=${t.rating}`:""}`},editableInputParams:{judgeMeProductId:"",rating:""}},postProductReview:{queryType:"post",endpoint:"/reviews",editableInputParams:{username:"",email:"",rating:"",body:"",productId:"",title:""},inputResolver:function(e){return{platform:"shopify",name:e.username,email:e.email,rating:e.rating,body:e.body,id:e.productId,title:e.title}}}},c=t.JudgeMeEditors={basic:[{type:"codeInput",name:"shopDomain",props:{label:"Shop domain",placeholder:""}},{type:"codeInput",name:"apiToken",props:{label:"API Key",placeholder:""}},{type:"codeInput",name:"proxyUrl",props:{label:"Proxy Url",placeholder:""}}]};t.default=(0,s.default)({name:"judgeMe",config:Object.assign({},u.baseDatasourceConfig,{apiBaseUrl:"https://judge.me/api/v1",proxyUrl:"https://api.apptile.io/judge-me-proxy/",shopDomain:"",apiToken:"",queryRunner:"queryrunner"}),initDatasource:function*(e,t,r){var n=(0,u.AjaxQueryRunner)(),a="web"===l.Platform.OS?t.config.get("proxyUrl"):t.config.get("apiBaseUrl");return n.initClient(a,(function(e){return e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"judgeMe"},runQuery:function*(e,t,r,n,s,u){var d=p[n],c=t.config.get("shopDomain"),f=t.config.get("apiToken"),g=t.config.get("apiBaseUrl");if(d){var m,y,v,h,b=null!=u?u:{},I=b.getNextPage,P=b.paginationMeta;if(d&&d.contextInputParams){var R=(y=d.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(y).reduce((function(e,n){var o=(0,i.default)(n,2),s=o[0],u=o[1];return r&&r.get(u)?Object.assign({},e,(0,a.default)({},s,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,a.default)({},s,t.get(u))):e}),{})});m=R(t,r)}d&&d.editableInputParams&&(v=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return t&&void 0!==t[o]?"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e:e}),{})}(s,d.editableInputParams)),null!=d&&d.isPaginated&&d.paginationResolver&&I&&(v=d.paginationResolver(v,P)),h=d.inputResolver?yield(0,o.call)(d.inputResolver,v):v;var w=d.endpoint;d.endpointResolver&&(w=d.endpointResolver(w,v,P)),w=w.includes("?")?`${w}&api_token=${f}&shop_domain=${c}`:`${w}?api_token=${f}&shop_domain=${c}`;var T,_,O=r.get("queryRunner"),S=yield(0,o.call)(O.runQuery,d.queryType,"web"===l.Platform.OS?"":w,Object.assign({},h,m),"web"===l.Platform.OS&&u?Object.assign({},u,{headers:{"x-base-url":g+w}}):u),A=S&&S.data?S.data:{},C=A;if(d&&d.transformer){var U=d.transformer(A,P);C=U.data,T=U.hasNextPage,_=U.paginationMeta}return yield{rawData:A,data:C,hasNextPage:T,paginationMeta:_}}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.shopDomain,n=e.apiToken;return!!(t&&r&&n)&&{apiBaseUrl:t,shopDomain:r,apiToken:n}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","shopDomain","apiToken"]},options:{propertySettings:{},pluginListing:{labelPrefix:"judgeMe",type:"datasource",name:"Judge Me",description:"Boost Sales with Judge.me Product Reviews!",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},8631:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.transformListReviewsData=t.transformGetReviewCount=t.transformGetProductData=void 0;var a=n(r(3216));t.transformGetProductData=function(e){return{data:a.default.pick(e.product,["id","external_id","handle"])}},t.transformListReviewsData=function(e){var t=e.reviews,r=e.current_page;return{data:t,hasNextPage:!(0===t.length),paginationMeta:{after:r+1}}},t.transformGetReviewCount=function(e){return{data:{count:e.count}}}},3729:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.livelyEditors=t.livelyApiRecords=t.executeQuery=t.default=void 0;var a,i=n(r(5990)),o=n(r(7488)),s=n(r(5971)),u=n(r(2766)),l=n(r(7128)),d=r(892),p=n(r(827)),c=r(6452),f=n(r(3216)),g=r(804),m=["pastStreamsWidgetId","limit"],y=["shoppableFeedId"],v=["feedId"],h=["store_product_id","company_id"],b={isPaginated:!1,contextInputParams:{brandId:"",pastStreamsWidgetId:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).startIndex;return r?Object.assign({},e,{startIndex:r}):e}},I=t.livelyApiRecords={GetShoppableFeed:Object.assign({},b,{queryType:"get",endpoint:"/widget/plugin/shoppable-feeds/",endpointResolver:function(e,t){var r=t.pastStreamsWidgetId,n=t.limit,a=void 0===n?50:n;return(0,l.default)(t,m),`${e}${r}?limit=${a}`},transformer:function(e){return{data:null==e?void 0:e.data,hasNextPage:!1,paginationMeta:void 0}},isPaginated:!1,editableInputParams:{pastStreamsWidgetId:"",limit:""}}),GetShoppableChunks:Object.assign({},b,{queryType:"get",endpoint:"/live-streaming/plugin/shoppable-feeds/chunks",endpointResolver:function(e,t){var r=t.shoppableFeedId;return(0,l.default)(t,y),`${e}?shoppable_feed_id=${r}&page=1`},transformer:function(e){var t=null==e?void 0:e.data;return t.feeds=t.streaming_shoppable_feeds,delete t.streaming_shoppable_feeds,{data:t,hasNextPage:!1,paginationMeta:void 0}},isPaginated:!1,editableInputParams:{shoppableFeedId:""}}),GetFeedProductsSeek:Object.assign({},b,{queryType:"get",endpoint:"/live-streaming/product/time/",endpointResolver:function(e,t){var r=t.feedId;return(0,l.default)(t,v),`${e}${r}`},transformer:function(e,t,r){var n=t.productsMapping;return r?{data:n,hasNextPage:!1,paginationMeta:void 0}:{data:n.map((function(t){var r;return Object.assign({},t,{seeks:null==e||null==(r=e.data)?void 0:r[t.product_id]})})),hasNextPage:!1,paginationMeta:void 0}},isPaginated:!1,editableInputParams:{productsMapping:{},feedId:""}}),incrementView:Object.assign({},b,{queryType:"post",endpoint:"/event-count/view-count",endpointResolver:function(e){return e},editableInputParams:{shoppable_feed_id:""},inputResolver:function(e){return{shoppable_feed_id:e.shoppable_feed_id}}}),GetPdpShoppableFeed:Object.assign({},b,{queryType:"get",endpoint:"/shoppable-feeds/product/v2",endpointResolver:function(e,t){var r=t.store_product_id,n=t.company_id;return(0,l.default)(t,h),`${e}?store_product_id=${r}&company_id=${n}`},transformer:function(e){return{data:null==e?void 0:e.data,hasNextPage:!1,paginationMeta:void 0}},isPaginated:!1,editableInputParams:{store_product_id:"",company_id:""}})},P={getLiveStreamIdentifier:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return n=(0,u.default)((function*(e,t,r,n){var a,i,o,u,l=null==r?void 0:r.get("brandId"),p=yield(0,c.getLiveStreamingData)(l),g=[].concat((0,s.default)(n),["currentLiveStreams"]),m=[].concat((0,s.default)(n),["upcomingLiveStreams"]),y=null!=(a=null==p||null==(i=p.data)?void 0:i.data)?a:[],v={data:null==y||null==(o=y.filter((function(e){return 2==(null==e?void 0:e.streaming_status)})))?void 0:o.sort((function(e,t){return e.start_time_unix-t.start_time_unix}))},h={data:null==y||null==(u=y.filter((function(e){return 1==(null==e?void 0:e.streaming_status)})))?void 0:u.sort((function(e,t){return e.start_time_unix-t.start_time_unix}))},b=[];return f.default.isEqual(r.get("currentLiveStreams"),v)||b.push({selector:g,newValue:v}),f.default.isEqual(r.get("upcomingLiveStreams"),h)||b.push({selector:m,newValue:h}),b.length>0&&e((0,d.modelUpdateAction)(b,void 0,!0)),p.data})),function(e,t,r,a){return n.apply(this,arguments)};var n}}},R=t.livelyEditors={basic:[{type:"codeInput",name:"brandId",props:{label:"Brand Id"}},{type:"codeInput",name:"pastStreamsWidgetId",props:{label:"Past Streams Widget Id"}}]};t.executeQuery=(a=(0,u.default)((function*(e,t,r,n,a,i){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:void 0,errors:[],hasError:!1}})),function(e,t,r,n,i,o){return a.apply(this,arguments)}),t.default=(0,p.default)({name:"lively",config:Object.assign({},d.baseDatasourceConfig,{queryRunner:"",brandId:"",pastStreamsWidgetId:"",getLiveStreamIdentifier:"action"}),initDatasource:function*(e,t,r){var n=(0,d.AjaxQueryRunner)();return n.initClient("https://api.lively.li"),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return I},getQueryInputParams:function(e){var t=I&&I[e]?I[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.brandId;return!!t&&{brandId:t}},resolveClearCredentialConfigs:function(){return["brandId"]},getPlatformIdentifier:function(){return"lively"},runQuery:function*(e,t,r,n,a,s){var u,l=I[n];if(l){var d,p,c=s.getNextPage,f=s.paginationMeta,m=null!=l?l:{},y=m.endpointResolver,v=m.endpoint,h=(u=m.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(u).reduce((function(e,n){var a=(0,o.default)(n,2),s=a[0];return a[1],r&&r.get(s)?Object.assign({},e,(0,i.default)({},s,r.get(s))):t&&t.get(s)?Object.assign({},e,(0,i.default)({},s,t.get(s))):e}),{})}),b=h(t,r),P=!0;l&&l.editableInputParams&&(d=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,o.default)(r,2),a=n[0],s=n[1];return t&&void 0!==t[a]&&"number"==typeof t[a]?Object.assign({},e,(0,i.default)({},a,isNaN(s)&&typeof s==typeof t[a]?s:parseInt(s))):s?Object.assign({},e,(0,i.default)({},a,s)):e}),{})}(a,l.editableInputParams),null!=l&&l.checkInputVariabes&&(P=l.checkInputVariabes(d))),null!=l&&l.isPaginated&&l.paginationResolver&&c&&(d=l.paginationResolver(d,f)),p=l.inputResolver?l.inputResolver(d,b):d,v=y&&y(v,Object.assign({},b,p),c);var R,w=r.get("queryRunner");if(P)try{var T;R=yield(0,g.call)(w.runQuery,l.queryType,v,p,Object.assign({},s,{headers:Object.assign({},l.headers,{"x-company-id":(null==(T=p)?void 0:T.company_id)||(null==b?void 0:b.brandId),"X-Request-Source":"APPTILE"})}))}catch(A){logger.error("error",A),R={error:A}}else R={errors:{message:"Missing input variables"},data:null};var _,O,S=R&&R.data?R.data:{},A=R&&R.error?R.error:null,C=S;if(l&&l.transformer){var U=l.transformer(S,a,A);C=U.data,_=U.hasNextPage,O=U.paginationMeta}return yield{rawData:S,data:C,hasNextPage:_,paginationMeta:O,errors:A?[A]:[],hasError:!!A}}},options:{propertySettings:P,pluginListing:{labelPrefix:"lively",type:"datasource",name:"Lively Integration",description:"Lively Widgets integration",section:"Integrations",icon:"datasource"}},editors:R})},6452:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getLiveStreamingData",{enumerable:!0,get:function(){return n.getLiveStreamingData}});var n=r(2748)},2607:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.livelyEditors=t.livelyApiRecords=t.executeQuery=t.default=void 0;var a,i=n(r(2766)),o=r(892),s=t.livelyApiRecords={},u=t.livelyEditors={basic:[{type:"codeInput",name:"brandId",props:{label:"Brand Id"}}]};t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:void 0,errors:[],hasError:!1}})),function(e,t,r,n,i,o){return a.apply(this,arguments)}),t.default=(0,o.wrapDatasourceModel)({name:"livelyShoppable",config:Object.assign({},o.baseDatasourceConfig,{brandId:""}),initDatasource:function*(e,t,r){},getQueries:function(){return s},getQueryInputParams:function(e){var t=s&&s[e]?s[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.brandId;return!!t&&{brandId:t}},resolveClearCredentialConfigs:function(){return["brandId"]},getPlatformIdentifier:function(){return"livelyShoppable"},runQuery:function*(e,t,r,n,a,i){},options:{propertySettings:{},pluginListing:{labelPrefix:"livelyShoppable",type:"datasource",name:"Lively Shoppable Integration",description:"Lively Widgets integration",section:"Integrations",icon:"datasource"}},editors:u})},2422:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.LoyaltyLionEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p={chooseVoucher:{queryType:"get",endpoint:"/customers/{merchantId}/available_rewards",endpointResolver:function(e,t){return e.replace("{merchantId}",null==t?void 0:t.merchantId)},editableInputParams:{merchantId:"",shopifyCustomerAccessToken:""},isPaginated:!1},listGeneratedCoupons:{queryType:"get",endpoint:"/customers/{merchantId}/transactions",endpointResolver:function(e,t){return e.replace("{merchantId}",null==t?void 0:t.merchantId)},editableInputParams:{merchantId:"",shopifyCustomerAccessToken:""},isPaginated:!1,transformer:r(9180).TransformedListGeneratedCupons},listTransactions:{queryType:"get",endpoint:"/customers/{merchantId}/transactions",endpointResolver:function(e,t){return e.replace("{merchantId}",null==t?void 0:t.merchantId)},editableInputParams:{merchantId:"",shopifyCustomerAccessToken:""},isPaginated:!1},getCustomerDetails:{queryType:"get",endpoint:"/customers?email={email}",endpointResolver:function(e,t){return e.replace("{email}",null==t?void 0:t.email)},editableInputParams:{email:"",shopifyCustomerAccessToken:""},isPaginated:!1},saveBirthday:{queryType:"patch",endpoint:"/customers/{merchantId}",endpointResolver:function(e,t){return e.replace("{merchantId}",null==t?void 0:t.merchantId)},editableInputParams:{birthday:"",merchantId:"",shopifyCustomerAccessToken:""},inputResolver:function(e){return{customer:{birthday:e.birthday}}},isPaginated:!1},registerActivities:{queryType:"post",endpoint:"/activities",editableInputParams:{activityName:"",merchantId:"",customerId:"",email:"",shopifyCustomerAccessToken:""},inputResolver:function(e){return{name:e.activityName,customer_email:e.email,customer_id:e.customerId,merchant_id:e.merchantId,state:"approved"}},isPaginated:!1},generateCoupon:{queryType:"post",endpoint:"/customers/{merchantId}/claimed_rewards",endpointResolver:function(e,t){return e.replace("{merchantId}",null==t?void 0:t.merchantId)},editableInputParams:{merchantId:"",reward_id:"",shopifyCustomerAccessToken:""},inputResolver:function(e){return{reward_id:Number(e.reward_id)}},isPaginated:!1},addPoints:{queryType:"post",endpoint:"/customers/{merchantId}/points",endpointResolver:function(e,t){return e.replace("{merchantId}",null==t?void 0:t.merchantId)},editableInputParams:{merchantId:"",points:"",reason:"",shopifyCustomerAccessToken:""},inputResolver:function(e){return{points:Number(e.points),reason:e.reason}},isPaginated:!1},removePoints:{queryType:"post",endpoint:"/customers/{merchantId}/remove_points",endpointResolver:function(e,t){return e.replace("{merchantId}",null==t?void 0:t.merchantId)},editableInputParams:{merchantId:"",points:"",reason:"",shopifyCustomerAccessToken:""},inputResolver:function(e){return{points:Number(e.points),reason:e.reason}},isPaginated:!1}},c=t.LoyaltyLionEditors={basic:[{type:"codeInput",name:"proxyUrl",props:{label:"proxyUrl",placeholder:"https://api.apptile.io/loyalty-lion-proxy"}},{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:"https://api.loyaltylion.com/v2/"}},{type:"codeInput",name:"appId",props:{label:"app Id",placeholder:""}}]},f=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(C=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(C).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariables&&(m=n.checkInputVariables(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,f,p));var v,h,b,I=r.get("queryRunner"),P=(v=m?yield I.runQuery(n.queryType,y,Object.assign({},g,u),{headers:{"x-shopify-customer-access-token":(null==a?void 0:a.shopifyCustomerAccessToken)||null}}):{errors:{message:"Missing input variables"},data:null})&&v.data?v.data:{},R=P;if(n&&n.transformer){var w=n.transformer(P,p),T=w.data,_=w.hasNextPage,O=w.paginationMeta;R=T,h=_,b=O}return{rawData:P,data:R,hasNextPage:h,paginationMeta:b}}catch(e){var S,A;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(S=e.request)&&S.response?new Error(JSON.parse(null==e||null==(A=e.request)?void 0:A.response).message):e],hasError:!0}}var C})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"loyaltyLion",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://api.loyaltylion.com/v2/",proxyUrl:"https://api.apptile.io/loyalty-lion-proxy",appId:"",queryRunner:"queryrunner"}),resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.username,n=e.password,a=e.appId;return!!(t&&r&&n)&&{appId:a,apiBaseUrl:t,username:r,password:n}},initDatasource:function*(e,t,r){var n,a=(0,l.AjaxQueryRunner)(),i=r.get("proxyUrl");i.endsWith("/")&&(i=i.slice(0,-1));var o=null==(n=t.config)?void 0:n.get("appId");return a.initClient(i,(function(e){return e.headers=Object.assign({"x-shopify-app-id":o},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:a}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"loyaltyLion"},runQuery:function*(e,t,r,n,a,i){var o=p[n];if(o)return yield(0,u.call)(f,e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"loyaltyLion",type:"datasource",name:"Loyalty Lion",description:"Reward Tracker for LoyaltyLion",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},9180:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformedListGeneratedCupons=void 0,t.TransformedListGeneratedCupons=function(e,t){return{data:e.transactions.filter((function(e){return"claimed_reward"===e.resource})).map((function(e){return{id:e.id,createdAt:e.created_at,customerId:e.customer.id,customerEmail:e.customer.email,merchantId:e.customer.merchant_id,pointsApproved:e.customer.points_approved,pointsPending:e.customer.points_pending,pointsSpent:e.customer.points_spent,pointsChange:e.points_approved||e.points_pending,resource:e.resource,rewardId:e.claimed_reward.reward.id,rewardTitle:e.claimed_reward.reward.title,rewardDescription:e.claimed_reward.reward.description,rewardSiteId:e.claimed_reward.reward.site_id,rewardUrl:e.claimed_reward.reward.target_site.url,rewardSortKey:e.claimed_reward.reward.sort_key,rewardKind:e.claimed_reward.reward.kind,rewardMethod:e.claimed_reward.reward.method,rewardDiscountType:e.claimed_reward.reward.discount_type,rewardDiscountAmount:e.claimed_reward.reward.discount_amount,redeemableType:e.claimed_reward.redeemable.redeemable_type,voucherCode:e.claimed_reward.redeemable.code,voucherUsedAt:e.claimed_reward.redeemable.used_at,voucherUsageCount:e.claimed_reward.redeemable.usage_count,voucherDiscountAmount:e.claimed_reward.redeemable.discount_amount,voucherUsageLimit:e.claimed_reward.redeemable.usage_limit,voucherState:e.claimed_reward.state,expiresAt:e.claimed_reward.expires_at,adjustmentNote:e.adjustment?e.adjustment.note:null}}))}}},944:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.meragiAuthActionsPropertySettings=t.meragiAuthActionsPluginConfig=t.MERAGI_ACCESS_TOKEN=void 0;var a,i,o,s=n(r(2766)),u=r(892),l=r(8571),d=r(3216),p=t.MERAGI_ACCESS_TOKEN="MERAGI_ACCESS_TOKEN",c=(t.meragiAuthActionsPluginConfig={loginUser:u.TriggerActionIdentifier,signOutUser:u.TriggerActionIdentifier,verifyOtp:u.TriggerActionIdentifier,user:"",accessToken:"",authLoader:!1,isloggedInUser:"",signInRedirectScreenId:"",otpContext:""},function(){var e,t=(0,u.GetRegisteredPluginInfo)("meragi");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}),f=(a=(0,s.default)((function*(e,t){yield u.LocalStorage.setValue(e,t)})),function(e,t){return a.apply(this,arguments)}),g=(i=(0,s.default)((function*(e,t,r,n,a,i,o){var s=[{selector:n.concat(["authLoader"]),newValue:!0}];e((0,u.modelUpdateAction)(s));var d=a.phone,p=null;try{var f,g=c(),m=yield(0,l.queryRunner)(null==g?void 0:g.LoginUser,t,r,{phone:d});null!=m&&m.data&&null!=m&&null!=(f=m.data)&&f.id&&(p=m.data)}catch(e){return console.log("Error signInResponse",e),{success:!1,errorMessage:e}}finally{var y=[{selector:n.concat(["authLoader"]),newValue:!1},{selector:n.concat(["otpContext"]),newValue:p}];e((0,u.modelUpdateAction)(y))}})),function(e,t,r,n,a,o,s){return i.apply(this,arguments)}),m=(o=(0,s.default)((function*(e,t,r,n,a,i,o){var s=null==r?void 0:r.get("otpContext");if((0,d.isEmpty)(s))console.error("verifyOtp called with no otpContext");else{var g=s.eventId,m=s.id,y=s.contactNumber;logger.info("[DEBUG] data in otp context",y,g,m);var v=[{selector:n.concat(["authLoader"]),newValue:!0}];e((0,u.modelUpdateAction)(v));var h=a.otp,b=null,I=null;try{var P,R,w=c(),T=yield(0,l.queryRunner)(null==w?void 0:w.VerifyOtp,t,r,{id:y,eventId:g,otp:h});T&&null!=T&&null!=(P=T.data)&&P.accessToken?b=null==T||null==(R=T.data)?void 0:R.accessToken:console.log("Error verifyOtp",T);var _=yield(0,l.queryRunner)(null==w?void 0:w.GetUser,t,r,{accessToken:b});_&&_.data&&(I=_.data),yield f(p,b)}catch(e){return console.log("Error signInResponse",e),{success:!1,errorMessage:e}}finally{var O=[{selector:n.concat(["authLoader"]),newValue:!1},{selector:n.concat(["accessToken"]),newValue:b},{selector:n.concat(["user"]),newValue:I}];e((0,u.modelUpdateAction)(O))}}})),function(e,t,r,n,a,i,s){return o.apply(this,arguments)});t.meragiAuthActionsPropertySettings={isloggedInUser:{getValue:function(e){var t=null==e?void 0:e.user,r=null==e?void 0:e.accessToken;return!!t&&!!r}},loginUser:{type:u.TriggerActionIdentifier,getValue:function(){return g},actionMetadata:{editableInputParams:{phone:""}}},verifyOtp:{type:u.TriggerActionIdentifier,getValue:function(){return m},actionMetadata:{editableInputParams:{otp:""}}},user:{updatesProps:["isloggedInUser"]},accessToken:{updatesProps:["isloggedInUser"]}}},6645:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.MeragiEditors=void 0;var a=r(804),i=r(892),o=r(1653),s=n(r(827)),u=r(944),l=r(8571),d={isPaginated:!1,contextInputParams:{eventId:"",accessToken:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).startIndex;return r?Object.assign({},e,{startIndex:r}):e}},p={LoginUser:Object.assign({},d,{queryType:"post",endpoint:"/api/v2/user/",endpointResolver:function(e,t,r){return`${e}${t.eventId}/login`},isPaginated:!1,editableInputParams:{phone:""},checkInputVariabes:function(e){return!!e.phone}}),VerifyOtp:Object.assign({},d,{queryType:"post",endpoint:"/api/v2/user/",endpointResolver:function(e,t,r){t.id;var n=t.eventId;return t.otp,`${e}${n}/verifyOtp`},isPaginated:!1,editableInputParams:{id:"",eventId:"",otp:""},checkInputVariabes:function(e){var t=e.id,r=e.eventId,n=e.otp;return!!t&&!!r&&!!n}}),GetUser:Object.assign({},d,{queryType:"get",endpoint:"/api/v2/user/",endpointResolver:function(e,t,r){return`${e}${t.eventId}/me`},headerResolver:function(e){var t=e.accessToken;return t?{Authorization:"Bearer "+t}:{}},isPaginated:!1,editableInputParams:{}}),GetEvents:Object.assign({},d,{queryType:"get",endpoint:"/api/v2/event/",endpointResolver:function(e,t,r){return`${e}${t.eventId}/programs${(0,o.jsonToQueryString)({})}`},headerResolver:function(e){var t=e.accessToken;return t?{Authorization:"Bearer "+t}:{}},isPaginated:!1,editableInputParams:{}}),GetItinerary:Object.assign({},d,{queryType:"get",endpoint:"/api/v2/event/",endpointResolver:function(e,t,r){return`${e}${t.eventId}/itinerary`},headerResolver:function(e){var t=e.accessToken;return t?{Authorization:"Bearer "+t}:{}},isPaginated:!1,editableInputParams:{}})},c=Object.assign({},u.meragiAuthActionsPropertySettings),f=t.MeragiEditors={basic:[{type:"codeInput",name:"eventId",props:{label:"Meragi Event ID",placeholder:""}}]};t.default=(0,s.default)({name:"meragi",config:Object.assign({eventId:"",queryRunner:"queryrunner"},u.meragiAuthActionsPluginConfig),initDatasource:function*(e,t,r){var n=(0,i.AjaxQueryRunner)();n.initClient("https://meragi-api.apptile.io",void 0);var o=yield(0,a.call)(i.LocalStorage.getValue,u.MERAGI_ACCESS_TOKEN);return{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n},{selector:[t.get("id"),"accessToken"],newValue:o}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.eventId;return!!t&&{eventId:t}},resolveClearCredentialConfigs:function(){return[]},getPlatformIdentifier:function(){return"meragi"},runQuery:function*(e,t,r,n,i,o){var s=p[n];if(s){var u,d,c=yield(0,a.call)(l.queryRunner,s,t,r,i,o),f=c&&c.data?c.data:{},g=f;if(s&&s.transformer){var m=null==r?void 0:r.get("shopifyDS"),y=s.transformer(f,null==m?void 0:m.formatCurrency);g=y.data,u=y.hasNextPage,d=y.paginationMeta}return yield{rawData:f,data:g,hasNextPage:u,paginationMeta:d,errors:[],hasError:!1}}},options:{propertySettings:c,pluginListing:{labelPrefix:"meragi",type:"datasource",name:"Meragi",description:"Meragi event source.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:f})},8571:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.makeInputVariablesTypeCompatible=t.contextInputParamsResolver=void 0,t.queryRunner=function(e,t,r,n){return d.apply(this,arguments)};var a=n(r(2766)),i=n(r(5990)),o=n(r(7488)),s=r(3216),u=t.contextInputParamsResolver=function(e,t,r){var n=t.get("config");if(n&&!(0,s.isEmpty)(e))return Object.entries(e).reduce((function(e,t){var a=(0,o.default)(t,2),s=a[0];return a[1],n&&n.get(s)?Object.assign({},e,(0,i.default)({},s,n.get(s))):r&&r.get(s)?Object.assign({},e,(0,i.default)({},s,r.get(s))):e}),{})},l=t.makeInputVariablesTypeCompatible=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,o.default)(r,2),a=n[0],s=n[1];return t&&void 0!==t[a]&&"number"==typeof t[a]?Object.assign({},e,(0,i.default)({},a,isNaN(s)&&typeof s==typeof t[a]?s:parseInt(s))):s?Object.assign({},e,(0,i.default)({},a,s)):e}),{})};function d(){return d=(0,a.default)((function*(e,t,r,n){var a,i,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},s=o.getNextPage,d=o.paginationMeta,p=null!=e?e:{},c=p.endpointResolver,f=p.endpoint,g=p.contextInputParams,m=p.headerResolver,y=u(g,t,r),v=!0;e&&e.editableInputParams&&(a=l(n,e.editableInputParams),null!=e&&e.checkInputVariabes&&(v=e.checkInputVariabes(a))),null!=e&&e.isPaginated&&e.paginationResolver&&s&&(a=e.paginationResolver(a,d)),i=e.inputResolver?e.inputResolver(a,y):a,f=c&&c(f,Object.assign({},y,i),s);var h,b=m?m(Object.assign({},y,i)):{},I=r.get("queryRunner");if(v)try{h=yield I.runQuery(e.queryType,f,i,Object.assign({},o,{headers:Object.assign({},b)}))}catch(e){logger.error("error",e)}else h={errors:{message:"Missing input variables"},data:null};return h})),d.apply(this,arguments)}},6935:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(5971)),i=n(r(2766)),o=n(r(3664)),s=n(r(2584)),u=r(892),l=new((0,o.default)((function e(){var t,r;(0,s.default)(this,e),this.setFilters=(t=(0,i.default)((function*(e,t,r,n,i){var o=i.filterName,s=i.value,l=r.get("selectedFilters"),d=l.find((function(e){return e.field===o}));console.log(d,"selectedFilters"),d?d.value.push(s):l.push({field:o,value:[s]}),console.log(l,"selectedFilters");var p=[{selector:n.concat(["selectedFilters"]),newValue:(0,a.default)(l)}];e((0,u.modelUpdateAction)(p,void 0,!0))})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.removeFilters=(r=(0,i.default)((function*(e,t,r,n,i){var o=i.filterName,s=i.value,l=r.get("selectedFilters"),d=l.find((function(e){return e.field===o}));d.value=d.value.filter((function(e){return e===s}));var p=[{selector:n.concat(["selectedFilters"]),newValue:(0,a.default)(l)}];e((0,u.modelUpdateAction)(p,void 0,!0))})),function(e,t,n,a,i){return r.apply(this,arguments)})})));t.default=l},7087:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.nostoQueryTypeEnum=t.default=t.NostoEditorConfig=void 0;var a=n(r(827)),i=r(892),o=r(4682),s=r(804),u=r(2228),l=n(r(6935)),d=r(1545),p=r(6036),c=t.nostoQueryTypeEnum=function(e){return e.SEARCH="SEARCH",e.RECOMMENDATIONS="RECOMMENDATIONS",e}({}),f={setFilters:{type:i.TriggerActionIdentifier,getValue:function(e,t,r){return l.default.setFilters},actionMetadata:{editableInputParams:{filterName:"",value:""}}}},g={Search:{queryType:"query",nostoQueryType:c.SEARCH,gqlTag:o.SearchGQL,transformer:u.nostoSearchTransformer,editableInputParams:{accountId:"",query:"",size:"",from:"",sortBy:"",sortOrder:"",filter:"{{[]}}",collectionId:""},isPaginated:!0,paginationResolver:function(e,t){var r=e.products.size;return e.products.from=Number.parseInt(t+r),Object.assign({},e,{from:Number.parseInt(t+r)})},inputResolver:function(e){var t,r=e.sortBy,n=e.sortOrder,a=e.filter;e.size=Number.parseInt(e.size),e.from=Number.parseInt(null!=(t=e.from)?t:0);var i=Object.assign({},e,{products:{size:e.size,from:e.from,facets:["*"],categoryId:e.collectionId}});return r&&n&&""!==r.trim()&&""!==n.trim()&&(i.products.sort=[{field:r,order:n}]),a&&Array.isArray(a)&&a.length>0&&(i.products.filter=a),i}},CreateNewCustomerSession:{queryType:"mutation",nostoQueryType:c.RECOMMENDATIONS,gqlTag:p.createCustomerSession},ProductPageRecommendations:{queryType:"mutation",nostoQueryType:c.RECOMMENDATIONS,gqlTag:p.productPageRecommendations,editableInputParams:{productId:"",customerId:"",slotId:"",ref:""},transformer:u.productPageRecommendationsTransformer},CartPageRecommendations:{queryType:"mutation",nostoQueryType:c.RECOMMENDATIONS,gqlTag:p.cartPageRecommendations,editableInputParams:{customerId:"",targetUrl:"",slotId:"",cartItems:""},inputResolver:function(e){var t=e.cartItems;return Object.assign({},e,{cartItems:t})},transformer:u.cartPageRecommendationsTransformer},SearchPageRecommendations:{queryType:"mutation",nostoQueryType:c.RECOMMENDATIONS,gqlTag:p.searchPageRecommendations,editableInputParams:{searchTerm:"",customerId:"",slotId:""},transformer:u.searchPageRecommendationsTransformer},RandomRecommendations:{queryType:"query",nostoQueryType:c.RECOMMENDATIONS,gqlTag:o.FetchRandomRecommendations,transformer:u.nostoRandomRecommendations,editableInputParams:{minProducts:1,maxProducts:10},isPaginated:!1},OrderConversionTracker:{queryType:"mutation",nostoQueryType:c.RECOMMENDATIONS,gqlTag:p.orderConversionTrackerMutation,editableInputParams:{customerId:"",customerInfo:"",orderNumber:"",orderStatus:"",ref:"",purchasedItems:"",paymentProvider:""},isPaginated:!1}},m=t.NostoEditorConfig={basic:[{type:"codeInput",name:"accountId",defultValue:"",props:{label:"Nosto Account Id",placeholder:""}},{type:"codeInput",name:"apiToken",defultValue:"",props:{label:"Nosto api token",placeholder:""}}]};t.default=(0,a.default)({name:"Nosto",config:{apiBaseUrl:"https://api.nosto.com/v1/graphql",searchBaseUrl:"https://search.nosto.com/v1/graphql",searchQueryRunner:"queryrunner",recommendationsQueryRunner:"queryrunner",apiToken:"",accountId:"",setFilters:"action",selectedFilters:"{{[]}}"},initDatasource:function*(e,t,r){},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.searchBaseUrl,n=e.apiToken,a=e.accountId;return!!(t&&r&&n&&a)&&{apiBaseUrl:t,searchBaseUrl:r,apiToken:n,accountId:a}},onPluginUpdate:function*(e,t,r,n,a,o,u){var l=yield(0,s.select)(i.selectPluginConfig,r,t),p=(0,i.GetRegisteredConfig)(l.get("subtype"))(l.config),c=l.set("config",p);if(o){var f,m,y,v=(0,i.ApolloQueryRunner)(),h=(0,i.ApolloQueryRunner)(),b=null==(f=c.config)?void 0:f.get("searchBaseUrl"),I=null==(m=c.config)?void 0:m.get("apiBaseUrl"),P=null==(y=c.config)?void 0:y.get("apiToken");return v.initClient(b,(function(){return{}})),h.initClient(I,(function(){return{headers:{"Content-Type":"application/json",Authorization:"Basic "+d.Buffer.from(":"+P).toString("base64")}}})),yield(0,s.spawn)((function*(){var e=g.CreateNewCustomerSession;try{var t="NOSTO_CUSTOMER_ID",r=yield(0,s.call)(i.LocalStorage.getValue,t);if(!r){var n=yield(0,s.call)(h.runQuery,e.queryType,e.gqlTag,{},{errorPolicy:"all"}),a=n.data;n.errors,i.LocalStorage.setValue(t,null==a?void 0:a.newSession),yield(0,s.put)((0,i.modelUpdateAction)([{selector:[c.get("id"),"nostoCustomerId"],newValue:null==a?void 0:a.newSession}]))}r&&(yield(0,s.put)((0,i.modelUpdateAction)([{selector:[c.get("id"),"nostoCustomerId"],newValue:r}])))}catch(e){console.error(e)}})),{modelUpdates:[{selector:[c.get("id"),"searchQueryRunner"],newValue:v},{selector:[c.get("id"),"recommendationsQueryRunner"],newValue:h}]}}},runQuery:function*(e,t,r,n,a,i){var o=g[n],u=null!=i?i:{},l=u.getNextPage,d=u.paginationMeta;if(o){var p,f=r.get("searchQueryRunner"),m=r.get("recommendationsQueryRunner");o.nostoQueryType===c.RECOMMENDATIONS&&(p=m),o.nostoQueryType===c.SEARCH&&(p=f);var y="";o&&o.inputResolver&&(a=o.inputResolver(a)),"string"==typeof o.gqlTag||"object"==typeof o.gqlTag?y=o.gqlTag:"function"==typeof o.gqlTag&&(y=o.gqlTag(a)),null!=o&&o.isPaginated&&o.paginationResolver&&l&&(a=o.paginationResolver(a,d));var v=yield(0,s.call)(p.runQuery,o.queryType,y,Object.assign({},a),{errorPolicy:"all"}),h=v.data;if(v.errors,o&&o.transformer)var b=o.transformer(h),I=b.data,P=b.hasNextPage,R=b.paginationMeta;return{rawData:h,data:I,hasNextPage:P,paginationMeta:R}}},getQueries:function(){return g},getQueryInputParams:function(e){var t=g&&g[e]?g[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"nosto"},options:{propertySettings:f,pluginListing:{labelPrefix:"nosto",type:"datasource",name:"Nosto",description:"Nosto Product and Search Filter",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:m})},6036:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.searchPageRecommendations=t.productPageRecommendations=t.orderConversionTrackerMutation=t.createCustomerSession=t.cartPageRecommendations=void 0;var a=n(r(8209)),i=(t.createCustomerSession=a.default`
  mutation {
    newSession(referer: "https://app.apptile.io")
  }
`,"\n    productId\n    name\n    ratingValue\n    reviewCount\n    imageUrl\n    thumbUrl\n    description\n    availability\n    price\n    listPrice\n    url\n");t.productPageRecommendations=a.default`
  mutation ($productId: String!, $customerId: String!, $slotId: [String!]!, $ref: String) {
    updateSession(by: BY_CID, id: $customerId, params: {event: {type: VIEWED_PRODUCT, target: $productId, ref: $ref}}) {
      pages {
        forProductPage(
          params: {isPreview: false, imageVersion: VERSION_8_400_400, slotIds: $slotId}
          product: $productId
        ) {
          divId
          resultId
          primary {
            ${i}
          }
        }
      }
    }
  }
`,t.cartPageRecommendations=a.default`
  mutation updateSessionMutation(
    $customerId: String!
    $targetUrl: String!
    $slotId: [String!]!
    $cartItems: [InputItem]
  ) {
    updateSession(
      by: BY_CID
      id: $customerId
      params: {event: {type: VIEWED_PAGE, target: $targetUrl}, cart: {items: $cartItems}}
    ) {
      pages {
        forCartPage(params: {isPreview: false, imageVersion: VERSION_8_400_400, slotIds: $slotId}, value: 100) {
          divId
          resultId
          primary {
            ${i}
          }
        }
      }
    }
  }
`,t.searchPageRecommendations=a.default`
  mutation ($customerId: String!, $searchTerm: String!, $slotId: [String!]!) {
    updateSession(by: BY_CID, id: $customerId, params: {event: {type: SEARCHED_FOR, target: $searchTerm}}) {
      pages {
        forSearchPage(
          params: {isPreview: false, imageVersion: VERSION_8_400_400, slotIds: $slotId}
          term: $searchTerm
        ) {
          divId
          resultId
          primary {
            ${i}
          }
        }
      }
    }
  }
`,t.orderConversionTrackerMutation=a.default`
  mutation (
    $customerId: String!
    $orderNumber: String!
    $orderStatus: String!
    $paymentProvider: String
    $ref: String
    $purchasedItems: [InputItem!]!
    $customerInfo: InputCustomerInfoEntity
  ) {
    placeOrder(
      by: BY_CID
      id: $customerId
      params: {
        customer: $customerInfo
        order: {
          number: $orderNumber
          orderStatus: $orderStatus
          paymentProvider: $paymentProvider
          ref: $ref
          purchasedItems: $purchasedItems
        }
      }
    ) {
      id
    }
  }
`},4682:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.SearchGQL=t.FetchTopListRecommendations=t.FetchSearchRecommendations=t.FetchRelatedRecommendations=t.FetchRandomRecommendations=void 0;var a=n(r(8209));t.SearchGQL=a.default`
  query Search($accountId: String!, $query: String!, $products: InputSearchProducts) {
    search(accountId: $accountId, query: $query, products: $products) {
      products {
        total
        from
        size
        hits {
          productId
          name
          ratingValue
          reviewCount
          imageUrl
          thumbUrl
          description
          availability
          price
          priceText
          priceCurrencyCode
          url
          customFields {
            key
            value
          }
          variantId
          realVariantIds
        }
        facets {
          ... on SearchTermsFacet {
            id
            field
            type
            name
            data {
              value
              count
              selected
            }
          }
        }
      }
    }
  }
`,t.FetchTopListRecommendations=a.default`
  query {
    recos(preview: false, image: VERSION_7_200_200) {
      toplist(hours: 168, sort: BUYS, params: {minProducts: 1, maxProducts: 10}) {
        primary {
          name
          productId
        }
      }
    }
  }
`,t.FetchRandomRecommendations=a.default`
  query ($minProducts: Int!, $maxProducts: Int!) {
    recos(preview: false, image: VERSION_7_200_200) {
      random(params: {minProducts: $minProducts, maxProducts: $maxProducts}) {
        primary {
          name
          productId
        }
      }
    }
  }
`,t.FetchRelatedRecommendations=a.default`
  query ($productId: String!) {
    recos(preview: false, image: VERSION_7_200_200) {
      related(relationship: VIEWED_TOGETHER, productIds: [$productId], params: {minProducts: 1, maxProducts: 10}) {
        primary {
          name
          productId
        }
      }
    }
  }
`,t.FetchSearchRecommendations=a.default`
  query ($searchTerm: String!) {
    recos(preview: false, image: VERSION_7_200_200) {
      search(term: $searchTerm, params: {minProducts: 1, maxProducts: 10}) {
        primary {
          name
          productId
        }
      }
    }
  }
`},2228:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.searchPageRecommendationsTransformer=t.productPageRecommendationsTransformer=t.nostoSearchTransformer=t.nostoRandomRecommendations=t.nostoProductTransformer=t.cartPageRecommendationsTransformer=void 0;var a=n(r(3216)),i=t.nostoProductTransformer=function(e){return e};t.nostoSearchTransformer=function(e){var t;console.log("Products Data",e);var r=(null!=(t=null==e?void 0:e.search)?t:{}).products,n=r.hits,a=r.from,i=void 0===a?0:a,o=i+r.size<r.total;return n.forEach((function(e){var t=e.url.split("/");e.handle=t[t.length-1]})),{data:{products:n,filters:r.facets.reduce((function(e,t){if(void 0!==t.name){var r=t.type;"terms"===r&&(e[t.name]={field:t.field,fieldKeys:t.data,type:r})}return e}),{})},hasNextPage:o,paginationMeta:i}},t.nostoRandomRecommendations=function(e){return{data:e.recos.random.primary,hasNextPage:!1,paginationMeta:0}},t.productPageRecommendationsTransformer=function(e){var t,r,n,o,s,u,l;return{data:{products:null==(t=a.default.first(null==e||null==(n=e.updateSession)||null==(o=n.pages)?void 0:o.forProductPage))||null==(r=t.primary)?void 0:r.map((function(e){return i(e)})),resultId:null==(s=a.default.first(null==e||null==(u=e.updateSession)||null==(l=u.pages)?void 0:l.forProductPage))?void 0:s.resultId},hasNextPage:!1,paginationMeta:null}},t.searchPageRecommendationsTransformer=function(e){var t,r,n,o,s,u,l;return{data:{products:null==(t=a.default.first(null==e||null==(n=e.updateSession)||null==(o=n.pages)?void 0:o.forSearchPage))||null==(r=t.primary)?void 0:r.map((function(e){return i(e)})),resultId:null==(s=a.default.first(null==e||null==(u=e.updateSession)||null==(l=u.pages)?void 0:l.forSearchPage))?void 0:s.resultId},hasNextPage:!1,paginationMeta:null}},t.cartPageRecommendationsTransformer=function(e){var t,r,n,o,s,u,l;return{data:{products:null==(t=a.default.first(null==e||null==(n=e.updateSession)||null==(o=n.pages)?void 0:o.forCartPage))||null==(r=t.primary)?void 0:r.map((function(e){return i(e)})),resultId:null==(s=a.default.first(null==e||null==(u=e.updateSession)||null==(l=u.pages)?void 0:l.forCartPage))?void 0:s.resultId},hasNextPage:!1,paginationMeta:null}}},8863:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.OkendoEditors=void 0,t.runQuery=function(e,t,r,n){return y.apply(this,arguments)};var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(5715),c={isPaginated:!1,contextInputParams:{apiBaseUrl:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},f={getAggregatedData:Object.assign({},c,{queryType:"get",endpoint:"/stores/",endpointResolver:function(e,t){return`${e}${t.userId}/products/shopify-${t.handle}/review_aggregate`},editableInputParams:{userId:"",handle:""},transformer:p.TransformGetAggregatedReviews}),listProductReviews:Object.assign({},c,{queryType:"get",endpoint:"/stores/",endpointResolver:function(e,t,r){return void 0===(null==r?void 0:r.nextUrl)?`${e}${t.userId}/products/shopify-${t.handle}/reviews?limit=${t.limit}`:r.nextUrl},editableInputParams:{userId:"",handle:"",limit:25},transformer:p.TransformGetReviews,isPaginated:!0}),postCustomerReview:Object.assign({},c,{queryType:"post",endpoint:"/stores/",endpointResolver:function(e,t){return`${e}${t.userId}/products/shopify-${t.handle}/reviews`},transformer:p.TransformPostReview,inputResolver:function(e,t){var r=e.message,n=e.rating,a=e.reviewerName,i=e.reviewerEmail,o=e.reviewTitle,s=e.userId,u=e.handle;return{body:r,rating:Number(n),reviewer:{name:a},reviewerEmail:i,title:o,handle:u,userId:s}},editableInputParams:{message:"",rating:0,reviewerName:"",reviewerEmail:"",reviewTitle:"",handle:"",userId:""}})},g=t.OkendoEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://api.okendo.io/v1"}},{type:"codeInput",name:"okendoUserId",props:{label:"Okendo User ID",placeholder:""}}]},m=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a){var i,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};try{var l,d,p=u.getNextPage,c=u.paginationMeta,f=null!=n?n:{},g=f.endpointResolver,m=f.endpoint,y=(i=f.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(i).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0];return a[1],r&&r.get(i)?Object.assign({},e,(0,o.default)({},i,r.get(i))):t&&t.get(i)?Object.assign({},e,(0,o.default)({},i,t.get(i))):e}),{})}),v=y(t,r),h=!0;n&&n.editableInputParams&&(l=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(h=n.checkInputVariabes(l))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(l=n.paginationResolver(l,c)),d=n.inputResolver?n.inputResolver(l,v):l,m=g&&g(m,Object.assign({},v,d),c);var b,I=r.get("queryRunner");if(h)try{b=yield I.runQuery(n.queryType,m,Object.assign({},d),Object.assign({},u))}catch(e){logger.error("error",e)}else b={errors:{message:"Missing input variables"},data:null};var P,R,w=b&&b.data?b.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,P=S,R=A}return{rawData:w,data:T,hasNextPage:P,paginationMeta:R,errors:[],hasError:!1}}catch(e){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}})),function(e,t,r,n,i){return a.apply(this,arguments)});function y(){return(y=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,l.GetRegisteredPlugin)(a),o=f[r];if(f[r])return yield m(i,t,e,o,Object.assign({},n),{})}))).apply(this,arguments)}t.default=(0,d.default)({name:"okendoReviews",config:{apiBaseUrl:"https://api.okendo.io/v1/",okendoUserId:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},_onPluginUpdate:function*(e,t,r,n,a,i,o){var s=yield(0,u.select)(l.selectPluginConfig,r,t),d=(0,l.GetRegisteredConfig)(s.get("subtype"))(s.config),p=s.set("config",d),c=e.stageModel.getModelValue([]).get(p.get("id")),f=null==c?void 0:c.get("queryRunner");return(f=(0,l.AjaxQueryRunner)()).initClient(p.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[p.get("id"),"queryRunner"],newValue:f}]}},get onPluginUpdate(){return this._onPluginUpdate},set onPluginUpdate(e){this._onPluginUpdate=e},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.okendoUserId;return!(!t||!r)&&{apiBaseUrl:t,okendoUserId:r}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","okendoUserId"]},getPlatformIdentifier:function(){return"okendoReviews"},runQuery:function*(e,t,r,n,a,i){var o=f[n];if(o)return yield m(e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"okendoReviews",type:"datasource",name:"Okendo",description:"",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g})},5715:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformPostReview=t.TransformGetReviews=t.TransformGetAggregatedReviews=void 0;var a=n(r(5971));t.TransformGetAggregatedReviews=function(e){return{data:e}},t.TransformGetReviews=function(e){var t=!1;return void 0!==(null==e?void 0:e.nextUrl)&&(t=!0),{data:(0,a.default)(e.reviews),paginationMeta:{nextUrl:e.nextUrl},hasNextPage:t}},t.TransformPostReview=function(e){return{data:e}}},2595:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.OmegaEstimateEditors=t.OmegaEstimateApiRecords=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(892),l=n(r(827)),d={isPaginated:!1,contextInputParams:{},endpointResolver:function(e,t,r){return e},apiBaseUrlResolver:function(e){return e.get("apiBaseUrl")},transformer:function(e){return{data:e,hasNextPage:!1,paginationMeta:{}}},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e},inputResolver:function(e){return e},queryHeadersResolver:function(e,t){return{}}},p=t.OmegaEstimateApiRecords={FetchShippingMethods:Object.assign({},d,{queryType:"get",endpoint:"/s/api/public-endpoint/shop-metafield",editableInputParams:{},contextInputParams:{shopUrl:"",apiKey:""},transformer:function(e){var t,r;return{data:null!=(t=null==(r=e.data.app)?void 0:r.shippingMethods)?t:[]}},endpointResolver:function(e,t,r){var n=r.shopUrl,a=r.apiKey;return`${e}?shop=${encodeURIComponent(n)}&key=${encodeURIComponent(a)}`}})},c=t.OmegaEstimateEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://estimated.omegatheme.com"}},{type:"codeInput",name:"shopUrl",props:{label:"Shopify Shop Url",placeholder:""}},{type:"codeInput",name:"apiKey",props:{label:"API KEY",placeholder:""}}]},f=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{var l,d,p=null!=n?n:{},c=p.endpointResolver,f=p.contextInputParams,g=p.editableInputParams,m=p.endpoint,y=function(e){return function(t,r){var n=t.get("config");if(n)return Object.entries(e).reduce((function(e,t){var a=(0,s.default)(t,2),i=a[0];return a[1],n&&n.get(i)?Object.assign({},e,(0,o.default)({},i,n.get(i))):r&&r.get(i)?Object.assign({},e,(0,o.default)({},i,r.get(i))):e}),{})}}(f),v=y(t,r);g&&(l=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,g)),m=c&&c(m,l,v),d=n.inputResolver?n.inputResolver(l):l;var h=n.apiBaseUrlResolver(r),b={};n.queryHeadersResolver&&(b=n.queryHeadersResolver(a,v));var I=(0,u.AjaxQueryRunner)();I.initClient(h,(function(e){return e.headers=Object.assign({},e.headers,Object.assign({},b,{"Content-Type":"application/json"})),e}));var P,R,w=yield I.runQuery(n.queryType,m,Object.assign({},d),{headers:{"Content-Type":"application/json"}}),T=w&&w.data?w.data:{},_=T;if(n&&n.transformer){var O=n.transformer(T,null,r),S=O.data,A=O.hasNextPage,C=O.paginationMeta;_=S,P=A,R=C}return{rawData:T,data:_,hasNextPage:P,paginationMeta:R,errors:[],hasError:!1}}catch(e){var U,j;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:(null==e||null==(U=e.response)||null==(j=U.data)?void 0:j.errors)||[null==e?void 0:e.message],hasError:!0}}})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,l.default)({name:"OmegaEstimate",config:{apiBaseUrl:"https://estimated.omegatheme.com",queryRunner:"queryrunner"},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl;return!!t&&{apiBaseUrl:t}},onPluginUpdate:function*(e,t,r,n,a,i,o){},resolveClearCredentialConfigs:function(){return["apiBaseUrl"]},getPlatformIdentifier:function(){return"omegaEstimate"},runQuery:function*(e,t,r,n,a,i){var o=p[n];if(o)return yield f(e,t,r,o,a,i)},options:{propertySettings:{},pluginListing:{labelPrefix:"OmegaEstimate",type:"datasource",name:"OmegaEstimate",description:"OmegaEstimate Delivery Estimate Integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},2018:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.PazoEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=n(r(3216)),c={getReport:{queryType:"post",endpoint:"/salesReport",endpointResolver:function(e,t){return`${e}`},editableInputParams:{apiKey:"",fromDate:"",toDate:""},isPaginated:!1,transformer:function(e,t){var r=p.default.keyBy(null==e?void 0:e.departments,(function(e){return null==e?void 0:e._id})),n=p.default.keyBy(null==e?void 0:e.sites,(function(e){return null==e?void 0:e._id}));for(var a in n){var i=n[a];for(var o of i.depts){var s;o.name=null==(s=r[null==o?void 0:o._id])?void 0:s.name}}var u=[];for(var l of null==e?void 0:e.siteGroups){var d=Object.assign({},l,{sitesData:[]});for(var c of l.sites)d.sitesData.push(n[c]);u.push(d)}return{data:Object.assign({},e,{siteGroups:u}),hasNextPage:!1,paginationMeta:t}}}},f=t.PazoEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:""}}]},g=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(C=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(C).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariables&&(m=n.checkInputVariables(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,f,p));var v,h,b,I=r.get("queryRunner"),P=(v=m?yield I.runQuery(n.queryType,y,Object.assign({},g,u)):{errors:{message:"Missing input variables"},data:null})&&v.data?v.data:{},R=P;if(n&&n.transformer){var w=n.transformer(P,p),T=w.data,_=w.hasNextPage,O=w.paginationMeta;R=T,h=_,b=O}return console.log("Pazo Query Data",R),{rawData:P,data:R,hasNextPage:h,paginationMeta:b}}catch(e){var S,A;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(S=e.request)&&S.response?new Error(JSON.parse(null==e||null==(A=e.request)?void 0:A.response).message):e],hasError:!0}}var C})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"pazo",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://internal.gopazo.com/api/v5",queryRunner:"queryrunner"}),initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl");return n.initClient(a,(function(e){return e.headers=Object.assign({},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return c},getQueryInputParams:function(e){var t=c&&c[e]?c[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"pazo"},runQuery:function*(e,t,r,n,a,i){var o=c[n];if(o)return yield(0,u.call)(g,e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"pazo",type:"datasource",name:"Pazo",description:"Pazo Reporting API",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:f})},5217:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.preOrderWodEditors=t.default=void 0;var a,i=n(r(2766)),o=r(892),s=n(r(827)),u={},l=t.preOrderWodEditors={basic:[]};t.default=(0,s.default)({name:"preOrderWod",config:Object.assign({},o.baseDatasourceConfig),initDatasource:(a=(0,i.default)((function*(e,t,r){var n=(0,o.AjaxQueryRunner)();return{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}})),function(e,t,r){return a.apply(this,arguments)}),getQueries:function(){return u},getPlatformIdentifier:function(){return"preOrderWod"},options:{propertySettings:{},pluginListing:{labelPrefix:"preOrderWod",type:"datasource",name:"Preorder Now WOD",description:"Recharge Payments integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:l})},4084:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.rechargePaymentsEditors=t.default=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=n(r(3216)),l=r(804),d=r(892),p=r(1653),c=n(r(827)),f=r(7691),g={isPaginated:!1,contextInputParams:{apiBaseUrl:"",rechargeVersion:"",appId:""},paginationResolver:function(e,t){return{}},endpointResolver:function(e,t){return e},inputResolver:function(e){return{}},transformer:function(e){return e}},m={getAllCharges:Object.assign({},g,{queryType:"get",endpoint:"/charges/",editableInputParams:{customerAccessToken:"",scheduledAtMin:"",scheduledAtMax:"",sortByField:"scheduled_at",reverse:!1,customerId:"",limit:10},isPaginated:!0,paginationMeta:{page:1},paginationResolver:function(e,t){var r=t.page;return Object.assign({},e,{page:r})},endpointResolver:function(e,t){var r=null!=t?t:{},n=r.scheduledAtMin,a=r.scheduledAtMax,i=r.sortByField,o=r.reverse,s=r.customerId,l=r.limit,d=r.page,c=i?`${i}-${o?"desc":"asc"}`:void 0,f=u.default.omitBy({scheduled_at_min:n,scheduled_at_max:a,customer_id:s,limit:l,sort_by:c},u.default.isNil);return f.page=d||1,`${e}${(0,p.jsonToQueryString)(f)}`},transformer:f.TransformChargeList}),getAllSubscriptions:Object.assign({},g,{queryType:"get",endpoint:"/subscriptions/",editableInputParams:{customerAccessToken:"",status:"",limit:10},isPaginated:!0,paginationMeta:{page:1},paginationResolver:function(e,t){var r=t.page;return Object.assign({},e,{page:r})},endpointResolver:function(e,t){var r=null!=t?t:{},n=r.status,a=r.page;return"all"===n?`${e}${(0,p.jsonToQueryString)({page:a||1})}`:`${e}${(0,p.jsonToQueryString)({status:n,page:a||1})}`},transformer:f.TransformSubscriptionList}),getSubscription:Object.assign({},g,{queryType:"get",endpoint:"/subscriptions/",editableInputParams:{subscriptionId:"",customerAccessToken:""},endpointResolver:function(e,t){return`${e}${(null!=t?t:{}).subscriptionId}/`},transformer:f.TransformSubscriptionData}),getCharge:Object.assign({},g,{queryType:"get",endpoint:"/charges/",editableInputParams:{chargeId:"",customerAccessToken:""},endpointResolver:function(e,t){return`${e}${(null!=t?t:{}).chargeId}/`},transformer:f.TransformChargeData}),cancelSubscription:Object.assign({},g,{queryType:"post",endpoint:"/subscriptions/",editableInputParams:{subscriptionId:"",cancellationReason:"",customerAccessToken:""},endpointResolver:function(e,t){return`${e}${(null!=t?t:{}).subscriptionId}/cancel`},inputResolver:function(e){return{cancellation_reason:e.cancellationReason}},transformer:f.TransformSubscriptionAction}),activateSubscription:Object.assign({},g,{queryType:"post",endpoint:"/subscriptions/",editableInputParams:{subscriptionId:"",customerAccessToken:""},endpointResolver:function(e,t){return`${e}${(null!=t?t:{}).subscriptionId}/activate`},transformer:f.TransformSubscriptionAction}),skipSubscriptionCharge:Object.assign({},g,{queryType:"post",endpoint:"/charges/",editableInputParams:{chargeId:"",purchaseItemIds:"",customerAccessToken:""},endpointResolver:function(e,t){return`${e}${(null!=t?t:{}).chargeId}/skip`},inputResolver:function(e){return{purchase_item_ids:e.purchaseItemIds}},transformer:f.TransformChargeAction}),unSkipSubscriptionCharge:Object.assign({},g,{queryType:"post",endpoint:"/charges/",editableInputParams:{chargeId:"",purchaseItemIds:"",customerAccessToken:""},endpointResolver:function(e,t){return`${e}${(null!=t?t:{}).chargeId}/unskip`},inputResolver:function(e){return{purchase_item_ids:e.purchaseItemIds}},transformer:f.TransformChargeAction}),getAllRetentionStrategies:Object.assign({},g,{queryType:"get",endpoint:"/retention_strategies",editableInputParams:{customerAccessToken:""},endpointResolver:function(e,t){return`${e}`},transformer:f.TransformRetentionStartegies}),getPlans:Object.assign({},g,{queryType:"get",endpoint:"/plans",editableInputParams:{customerAccessToken:"",page:1,limit:50,productId:"",type:"subscription"},endpointResolver:function(e,t){var r=t.page,n=t.limit,a=t.productId,i=t.type,o=u.default.omitBy({page:r,limit:n,productId:a,type:i},u.default.isNil);return`${e}${(0,p.jsonToQueryString)(o)}`},transformer:f.TransformPlans}),getPlansPublicApi:Object.assign({},g,{queryType:"get",endpoint:"/public-api/plans",editableInputParams:{page:1,limit:50,productId:"",type:"onetime"},endpointResolver:function(e,t){var r=t.page,n=t.limit,a=t.productId,i=t.type,o=u.default.omitBy({page:r,limit:n,productId:a,type:i},u.default.isNil);return`${e}${(0,p.jsonToQueryString)(o)}`},transformer:f.TransformPlans})},y=t.rechargePaymentsEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Url",placeholder:""}},{type:"codeInput",name:"rechargeVersion",props:{label:"Recharge Version",placeholder:""}},{type:"codeInput",name:"appId",props:{label:"Apptile App Id",placeholder:""}}]};t.default=(0,c.default)({name:"Payment Recharge",config:Object.assign({},d.baseDatasourceConfig,{apiBaseUrl:"https://api.apptile.io",appId:"",rechargeVersion:"2021-11",queryRunner:"queryRunner"}),initDatasource:(a=(0,i.default)((function*(e,t,r){var n=(0,d.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){var r,n;return e.headers=Object.assign({},e.headers,{"X-Shopify-App-Id":null!=(r=null==(n=t.config)?void 0:n.get("appId"))?r:"","Content-Type":"application/json"}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}})),function(e,t,r){return a.apply(this,arguments)}),getQueries:function(){return m},getQueryInputParams:function(e){var t=m&&m[e]?m[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.proxyUrl,r=e.apiVersion,n=e.appId;return!!(t&&r&&n)&&{apiBaseUrl:t,appId:n,rechargeVersion:r}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","appId","rechargeVersion"]},getPlatformIdentifier:function(){return"rechargePayments"},runQuery:function*(e,t,r,n,a,i){try{var u,d,p=m[n];if(!p)return;var c,f,g=null!=p?p:{},y=g.endpointResolver,v=g.endpoint;p&&p.editableInputParams&&(c=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,p.editableInputParams));var h=i.getNextPage,b=i.paginationMeta;logger.info("isPaginated",null==p?void 0:p.isPaginated,h),logger.info("isPaginated",b||p.paginationMeta),null!=p&&p.isPaginated&&p.paginationResolver&&h&&(c=p.paginationResolver(c,b||p.paginationMeta)),v=y&&y(v,c),f=p.inputResolver?p.inputResolver(c):c;var I,P,R=r.get("queryRunner"),w=yield(0,l.call)(R.runQuery,p.queryType,v,Object.assign({},f),{headers:{"x-shopify-customer-access-token":null!=(u=null==(d=c)?void 0:d.customerAccessToken)?u:""}}),T=w&&w.data?w.data:{},_=T;if(p&&p.transformer){var O=p.transformer(T,c),S=O.data,A=O.hasNextPage,C=O.paginationMeta;_=S,I=A,P=C}return yield{rawData:T,data:_,hasNextPage:I,paginationMeta:P,errors:[],hasError:!1}}catch(e){return logger.error(e),yield{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!1}}},options:{propertySettings:{},pluginListing:{labelPrefix:"rechargePayments",type:"datasource",name:"Recharge Payments",description:"Recharge Payments integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:y})},7691:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformSubscriptionList=t.TransformSubscriptionData=t.TransformSubscriptionAction=t.TransformSubscription=t.TransformRetentionStartegies=t.TransformPlans=t.TransformChargeList=t.TransformChargeData=t.TransformChargeAction=t.TransformCharge=void 0;var a=n(r(7128)),i=n(r(3216)),o=["line_items"],s=t.TransformCharge=function(e){var t=e.line_items,r=(0,a.default)(e,o),n=i.default.pick(r,["id","status","scheduled_at","type","total_price","currency"]);return Object.assign({},n,{line_items:t&&t.length>0?t.map((function(e){return i.default.pick(e,["purchase_item_id","handle","images","quantity","sku","title","variant_title","total_price","unit_price"])})):[]})},u=t.TransformSubscription=function(e){return i.default.pick(e,["id","address_id","customer_id","cancelled_at","charge_interval_frequency","expire_after_specific_number_of_charges","has_queued_charges","is_prepaid","is_skippable","is_swappable","max_retries_reached","next_charge_scheduled_at","order_interval_frequency","order_interval_unit","presentment_currency","price","product_title","quantity","sku","status","variant_title"])};t.TransformChargeList=function(e,t){var r=i.default.get(e,"charges",[]),n=[];r.forEach((function(e){var t=i.default.merge({},e);e.line_items.forEach((function(e){t.line_items=[e],n.push(s(t))}))}));var a=t.page;return{data:n,hasNextPage:!!e.next_cursor,paginationMeta:{page:parseInt(a||"1",10)+1}}},t.TransformSubscriptionList=function(e,t){var r=i.default.get(e,"subscriptions",[]).map((function(e){return u(e)})),n=t.page;return{data:r,hasNextPage:!!e.next_cursor,paginationMeta:{page:parseInt(n||"1",10)+1}}},t.TransformChargeData=function(e){return{data:Object.assign({},s(e.charge),{shipping_address:e.charge.shipping_address})}},t.TransformSubscriptionData=function(e){return{data:u(e.subscription)}},t.TransformChargeAction=function(e){var t,r;return{data:{id:null==e?void 0:e.charge.id,address_id:null==e?void 0:e.charge.address_id,customer_id:null==e||null==(t=e.charge)||null==(r=t.customer)?void 0:r.id}}},t.TransformRetentionStartegies=function(e){return{data:e.retention_strategies}},t.TransformSubscriptionAction=function(e){return{data:i.default.pick(e.subscription,["id","address_id","customer_id"])}},t.TransformPlans=function(e){return{data:e.plans.map((function(e){var t,r,n,a,i,o,s;return{id:null==(t=e)?void 0:t.id,discount_amount:null==(r=e)?void 0:r.discount_amount,discount_type:null==(n=e)?void 0:n.discount_type,external_plan_id:null==(a=e)?void 0:a.external_plan_id,external_plan_name:null==(i=e)?void 0:i.external_plan_name,sort:null==(o=e)?void 0:o.sort_order,type:null==(s=e)?void 0:s.type}}))}}},9023:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=r(2367),d=new((0,s.default)((function e(){var t,r,n=this;(0,o.default)(this,e),this.initiateCheckout=(t=(0,i.default)((function*(e,t,r,a,i){var o=i.lineItems,s=i.note,l=i.customerAccessToken,d=i.loggedInNavigateTo,p=i.nonLoggedInNavigateTo;if(l){var c=(yield n.queryExecutor(r,t,"initiateCheckout",{lineItems:o,note:s,customerAccessToken:l})).data;c&&c.checkoutUrl&&e((0,u.navigateToScreen)(d,{checkoutUrl:c.checkoutUrl}))}else e((0,u.navigateToScreen)(p,{}))})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.getViewManageSubscriptionUrl=(r=(0,i.default)((function*(e,t,r,a,i){var o=i.customerAccessToken,s=i.navigateTo,l=(yield n.queryExecutor(r,t,"getViewManageSubscriptionUrl",{customerAccessToken:o})).data;l&&l.manageUrl&&e((0,u.navigateToScreen)(s,{manageUrl:l.manageUrl}))})),function(e,t,n,a,i){return r.apply(this,arguments)})}),[{key:"queryExecutor",value:(a=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,u.GetRegisteredPlugin)(a),o=this.getQueries()[r];return yield(0,l.executeQuery)(i,t,e,o,Object.assign({},n),{})})),function(e,t,r,n){return a.apply(this,arguments)})},{key:"getQueries",value:function(){var e,t=(0,u.GetRegisteredPluginInfo)("Recurpay");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}}]));t.default=d},2367:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.recurpayEditors=t.executeQuery=t.default=void 0;var a,i,o=n(r(2766)),s=n(r(5990)),u=n(r(7488)),l=n(r(3216)),d=r(804),p=r(892),c=r(1653),f=n(r(827)),g=r(9140),m=n(r(9023)),y={isPaginated:!1,contextInputParams:{proxyUrl:"",appId:""},paginationResolver:function(e,t){return{}},endpointResolver:function(e,t){return e},inputResolver:function(e){return e},transformer:function(e){return e}},v={getPlans:Object.assign({},y,{queryType:"post",endpoint:"/storefront/plans",editableInputParams:{productId:""},endpointResolver:function(e,t){var r=t.productId,n=l.default.omitBy({productId:r},l.default.isNil);return`${e}${(0,c.jsonToQueryString)(n)}`},transformer:g.TransformPlans}),initiateCheckout:Object.assign({},y,{queryType:"post",endpoint:"/storefront/checkout",editableInputParams:{lineItems:"",note:"",customerAccessToken:""},inputResolver:function(e){return{lineItems:e.lineItems,note:e.note}},transformer:g.TransformCheckoutUrl}),getViewManageSubscriptionUrl:Object.assign({},y,{queryType:"get",endpoint:"/storefront/view/subscriptions",editableInputParams:{customerAccessToken:""},inputResolver:function(e){return{}},transformer:g.TransformgetViewManageSubscriptionUrl})},h={initiateCheckout:{type:p.TriggerActionIdentifier,getValue:function(e,t,r){return m.default.initiateCheckout},actionMetadata:{editableInputParams:{lineItems:"",note:"",customerAccessToken:"",loggedInNavigateTo:"",nonLoggedInNavigateTo:""}}},getViewManageSubscriptionUrl:{type:p.TriggerActionIdentifier,getValue:function(e,t,r){return m.default.getViewManageSubscriptionUrl},actionMetadata:{editableInputParams:{customerAccessToken:"",navigateTo:""}}}},b=t.recurpayEditors={basic:[{type:"codeInput",name:"proxyUrl",props:{label:"API Url",placeholder:""}},{type:"codeInput",name:"appId",props:{label:"Apptile App Id",placeholder:""}}]},I=t.executeQuery=(a=(0,o.default)((function*(e,t,r,n,a,i){try{var o;if(!n)throw new Error("Invalid Query");var l,d=null!=i?i:{},p=d.getNextPage,c=d.paginationMeta;if(n&&n.contextInputParams){var f=(x=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(x).reduce((function(e,n){var a=(0,u.default)(n,2),i=a[0],o=a[1];return r&&r.get(o)?Object.assign({},e,(0,s.default)({},i,r.get(o))):t&&t.get(o)?Object.assign({},e,(0,s.default)({},i,t.get(o))):e}),{})});l=f(t,r)}var g,m,y=!0;n&&n.editableInputParams&&(g=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,u.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,s.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,s.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(y=n.checkInputVariabes(g))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(g=n.paginationResolver(g,c)),m=n.inputResolver?n.inputResolver(g):g;var v=n.endpoint;if(n.endpointResolver&&(v=n.endpointResolver(v,g,c)),null==(o=null==r?void 0:r.get("proxyUrl"))||!o)throw new Error("Please give an API KEY");var h,b,I,P,R,w=r.get("queryRunner"),T=(h=y?yield w.runQuery(n.queryType,v,Object.assign({},m,l),{headers:{"x-shopify-customer-access-token":null!=(b=null==(I=g)?void 0:I.customerAccessToken)?b:""}}):{errors:{message:"Missing input variables"},data:null})&&h.data?h.data:{},_=T;if(n&&n.transformer){var O=n.transformer(T,c),S=O.data,A=O.hasNextPage,C=O.paginationMeta;_=S,P=A,R=C}return{rawData:T,data:_,hasNextPage:P,paginationMeta:R}}catch(e){var U,j;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(U=e.request)&&U.response?new Error(JSON.parse(null==e||null==(j=e.request)?void 0:j.response).message):e],hasError:!0}}var x})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,f.default)({name:"Recurpay",config:Object.assign({},p.baseDatasourceConfig,{proxyUrl:"https://api.apptile.io/recurpay",appId:"",queryRunner:"queryRunner",initiateCheckout:"actions",getViewManageSubscriptionUrl:"actions"}),initDatasource:(i=(0,o.default)((function*(e,t,r){var n=(0,p.AjaxQueryRunner)();return n.initClient(t.config.get("proxyUrl"),(function(e){var r,n;return e.headers=Object.assign({},e.headers,{"X-Shopify-App-Id":null!=(r=null==(n=t.config)?void 0:n.get("appId"))?r:"","Content-Type":"application/json"}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}})),function(e,t,r){return i.apply(this,arguments)}),getQueries:function(){return v},getQueryInputParams:function(e){var t=v&&v[e]?v[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.appId;return!!t&&{appId:t}},resolveClearCredentialConfigs:function(){return["appId"]},getPlatformIdentifier:function(){return"recurpay"},runQuery:function*(e,t,r,n,a,i){var o=v[n];if(o)return yield(0,d.call)(I,e,t,r,o,a,i)},options:{propertySettings:h,pluginListing:{labelPrefix:"recurpay",type:"datasource",name:"Recurpay",description:"Recurpay integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:b})},9140:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformgetViewManageSubscriptionUrl=t.TransformPlans=t.TransformCheckoutUrl=void 0,t.TransformPlans=function(e){return{data:e.plans.map((function(e){var t,r,n,a,i,o,s,u,l,d=(null==(t=e)?void 0:t.pricing_policy.find((function(e){return e.discount}))).discount;return{plan_id:e.id,selling_plan_id:null==(r=e)?void 0:r.selling_plan_id,selling_plan_name:null==(n=e)?void 0:n.name,description:null==(a=e)?void 0:a.description,status:null==(i=e)?void 0:i.status,discount_type:null==d?void 0:d.type,discount_value:null==d?void 0:d.value,frequency:null==(o=e)||null==(s=o.delivery_policy)?void 0:s.frequency,interval:null==(u=e)||null==(l=u.delivery_policy)?void 0:l.interval}}))}},t.TransformCheckoutUrl=function(e){var t;return{data:{checkoutUrl:null==e||null==(t=e.checkout)?void 0:t.url}}},t.TransformgetViewManageSubscriptionUrl=function(e){var t;return{data:{manageUrl:null==e||null==(t=e.account)?void 0:t.url}}}},1672:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RestApiEditors=void 0;var a=r(804),i=r(892),o=n(r(827)),s=r(1653),u={endpoint:"/",queryHeaders:{},queryParams:{},queryCookies:{}},l={isPaginated:!0,endpointResolver:function(e,t){return e},inputResolver:function(e){return e},paginationResolver:function(e,t,r,n){var a=(null!=t?t:{}).after;return r&&n&&a?Object.assign({},e,{after:a}):e}},d={Get:Object.assign({queryType:"get",editableInputParams:Object.assign({},u)},l),Post:Object.assign({queryType:"post",editableInputParams:Object.assign({},u,{queryPayload:{}})},l),Put:Object.assign({queryType:"put",editableInputParams:Object.assign({},u,{queryPayload:{}})},l),Patch:Object.assign({queryType:"patch",editableInputParams:Object.assign({},u,{queryPayload:{}})},l),Delete:Object.assign({queryType:"delete",editableInputParams:Object.assign({},u)},l)},p=t.RestApiEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://api-v3.RestApi.io"}},{type:"codeInput",name:"authHeaders",props:{label:"RestApi Headers",placeholder:'{"Authorization": "Basic XXXXX"}'}}]};t.default=(0,o.default)({name:"RestApi",config:{apiBaseUrl:"https://api-v3.RestApi.io",authHeaders:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,i.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){var t,n=null!=(t=null==r?void 0:r.get("authHeaders"))?t:{};try{"string"==typeof n&&(n=JSON.parse(n))}catch(e){}return e.headers=Object.assign({},e.headers,n),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return d},getQueryInputParams:function(e){var t=d&&d[e]?d[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},runQuery:function*(e,t,r,n,i,o){try{var u,l=d[n];if(!l)return;var p=null!=l?l:{},c=p.endpointResolver,f=p.transformer,g=null!=i?i:{},m=g.endpoint,y=g.queryCookies,v=g.queryHeaders,h=g.queryParams,b=(0,s.GetProcessedInput)(i,l,o,t,r),I=b.contextInputParam,P=b.typedDataVariables;m=c&&c(m,P);var R=y?{Cookie:(0,s.jsonToCookies)(y)}:{},w=(0,s.jsonToQueryString)(h),T=null!=(u=null==P?void 0:P.queryPayload)?u:{};try{"string"==typeof T&&(T=JSON.parse(T))}catch(e){}var _,O,S=r.get("queryRunner"),A=yield(0,a.call)(S.runQuery,l.queryType,m+w,Object.assign({},T,I),{headers:Object.assign({},R,v),t_client:(new Date).valueOf()},o),C=A&&A.data?A.data:{},U=C;if(f){var j=f(C),x=j.data,M=j.hasNextPage,E=j.paginationMeta;U=x,_=M,O=E}return yield{rawData:C,data:U,hasNextPage:_,paginationMeta:O}}catch(e){throw logger.error(e),e}},options:{propertySettings:{},pluginListing:{labelPrefix:"RestApi",type:"datasource",name:"RestApi Integration",description:"RestApi Integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:p})},1653:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.makeInputVariablesTypeCompatible=t.makeInputParamsResolver=t.jsonToQueryString=t.jsonToCookies=t.GetProcessedInput=void 0;var a=n(r(5990)),i=n(r(7488)),o=r(3216),s=(t.jsonToCookies=function(e){var t="";return e&&Object.entries(e).forEach((function(r){var n=(0,i.default)(r,1)[0];t+=`${n}=${e[n]}; `})),t||""},t.jsonToQueryString=function(e){return e?"?"+Object.keys(e).map((function(t){return encodeURIComponent(t)+"="+encodeURIComponent(e[t])})).join("&"):""},t.makeInputParamsResolver=function(e){return e?function(t,r){var n=t.get("config");if(n)return Object.entries(e).reduce((function(e,t){var o=(0,i.default)(t,2),s=o[0],u=o[1];return n&&n.get(u)?Object.assign({},e,(0,a.default)({},s,n.get(u))):r&&r.get(u)?Object.assign({},e,(0,a.default)({},s,r.get(u))):e}),{})}:function(){}}),u=t.makeInputVariablesTypeCompatible=function(e,t){return e?Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e}),{}):e};t.GetProcessedInput=function(e,t,r,n,a){var i=null!=r?r:{},l=i.getNextPage,d=i.paginationMeta,p=null!=t?t:{},c=p.contextInputParams,f=p.editableInputParams,g=p.isPaginated,m=p.paginationResolver,y=p.inputResolver,v=s(c)(n,a),h=e;return Object.keys(e).forEach((function(t){e[t]&&(0,o.isObject)(e[t])&&f[t]&&(h[t]=u(e[t],f[t]))})),h=m?m(h,d,g,l):h,{contextInputParam:v,typedDataVariables:y&&y(h)}}},2888:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.ReviewsIoReviewsEditors=void 0,t.runQuery=function(e,t,r,n){return y.apply(this,arguments)};var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(286),c={isPaginated:!1,contextInputParams:{apiBaseUrl:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},f={getAggregatedData:Object.assign({},c,{queryType:"get",endpoint:"/reviews",endpointResolver:function(e,t){return`${e}?store=${t.appKey}&sku=${t.variantId}&type=product_review&page=1${t.per_page?`&per_page=${t.per_page}`:""}${t.sort?`&sort=${t.sort}`:""}`},editableInputParams:{variantId:"",per_page:10,sort:"date",appKey:""},transformer:p.TransformAggregatedData,inputResolver:function(e,t){var r=e.per_page,n=e.star,a=e.sort,i=e.direction,o=e.variantId;return{per_page:r,star:n,sort:a,direction:i,appKey:e.appKey,variantId:o}}}),listProductReviews:Object.assign({},c,{queryType:"get",endpoint:"/reviews",endpointResolver:function(e,t,r){var n=(null!=r?r:{}).after,a=void 0===n?1:n;return`${e}?store=${t.appKey}&sku=${t.variantId}&type=product_review${a?`&page=${a}`:""}${t.per_page?`&per_page=${t.per_page}`:""}${t.sort?`&sort=${t.sort}`:""}`},editableInputParams:{variantId:"",appKey:"",page:1,per_page:10,sort:"date"},transformer:p.TransformGetReviews,inputResolver:function(e,t){var r=e.per_page,n=e.star,a=e.sort,i=e.direction,o=e.variantId;return{per_page:r,star:n,sort:a,page:e.page,appKey:e.appKey,direction:i,variantId:o}},isPaginated:!0}),postCustomerReview:Object.assign({},c,{queryType:"post",endpoint:"/product/review/new",endpointResolver:function(e,t){return`${e}?store=${t.appKey}`},transformer:p.TransformPostReview,inputResolver:function(e,t){return{rating:e.rating,review:e.review,email:e.email,name:e.name,sku:e.sku,appKey:e.appKey}},editableInputParams:{sku:"",appKey:"",name:"",email:"",rating:"",review:""}})},g=t.ReviewsIoReviewsEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://api.reviews.io"}},{type:"codeInput",name:"appKey",props:{label:"ReviewsIoReviews Store Key",placeholder:""}}]},m=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a){var i,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};try{var l,d,p=u.getNextPage,c=u.paginationMeta,f=null!=n?n:{},g=f.endpointResolver,m=f.endpoint,y=(i=f.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(i).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0];return a[1],r&&r.get(i)?Object.assign({},e,(0,o.default)({},i,r.get(i))):t&&t.get(i)?Object.assign({},e,(0,o.default)({},i,t.get(i))):e}),{})}),v=y(t,r),h=!0;n&&n.editableInputParams&&(l=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(h=n.checkInputVariabes(l))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(l=n.paginationResolver(l,c)),d=n.inputResolver?n.inputResolver(l,v):l,m=g&&g(m,Object.assign({},v,d),c);var b,I=r.get("queryRunner");if(h)try{b=yield I.runQuery(n.queryType,m,Object.assign({},d),Object.assign({},u))}catch(e){logger.error("error",e)}else b={errors:{message:"Missing input variables"},data:null};var P,R,w=b&&b.data?b.data:{},T=w;if(n&&n.transformer){var _,O=null!=c&&c.after?null==c?void 0:c.after:null==(_=d)?void 0:_.page,S=n.transformer(w,O),A=S.data,C=S.hasNextPage,U=S.paginationMeta;T=A,P=C,R=U}return{rawData:w,data:T,hasNextPage:P,paginationMeta:R,errors:[],hasError:!1}}catch(e){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}})),function(e,t,r,n,i){return a.apply(this,arguments)});function y(){return(y=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,l.GetRegisteredPlugin)(a),o=f[r];if(f[r])return yield m(i,t,e,o,Object.assign({},n),{})}))).apply(this,arguments)}t.default=(0,d.default)({name:"reviewsIoReviews",config:{apiBaseUrl:"https://api.reviews.io",appKey:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},_onPluginUpdate:function*(e,t,r,n,a,i,o){var s=yield(0,u.select)(l.selectPluginConfig,r,t),d=(0,l.GetRegisteredConfig)(s.get("subtype"))(s.config),p=s.set("config",d),c=e.stageModel.getModelValue([]).get(p.get("id")),f=null==c?void 0:c.get("queryRunner");return(f=(0,l.AjaxQueryRunner)()).initClient(p.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[p.get("id"),"queryRunner"],newValue:f}]}},get onPluginUpdate(){return this._onPluginUpdate},set onPluginUpdate(e){this._onPluginUpdate=e},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.appKey;return!(!t||!r)&&{apiBaseUrl:t,appKey:r}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","appKey"]},getPlatformIdentifier:function(){return"reviewsIoReviews"},runQuery:function*(e,t,r,n,a,i){var o=f[n];if(o)return yield m(e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"reviewsIoReviews",type:"datasource",name:"ReviewsIo Reviews",description:"",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g})},286:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformPostReview=t.TransformGetReviews=t.TransformAggregatedData=void 0,t.TransformAggregatedData=function(e){return{data:{stats:e.stats.ratings,review_count:e.review_count,average_rating:e.average_rating}}},t.TransformGetReviews=function(e,t){var r=e.reviews;return{data:r,hasNextPage:!(0===r.length),paginationMeta:{after:t+1}}},t.TransformPostReview=function(e){return{data:e}}},2920:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.VaccinationTrackerEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p={addChild:{queryType:"post",endpoint:"/add-child",endpointResolver:function(e,t){return`${e}`},editableInputParams:{firstName:"",lastName:"",dob:"",parentId:"",gender:""},isPaginated:!1},getChild:{queryType:"get",endpoint:"/child",endpointResolver:function(e,t){return`${e}/${null==t?void 0:t.childId}`},editableInputParams:{childId:""},isPaginated:!1},getChildren:{queryType:"get",endpoint:"/children",endpointResolver:function(e,t){return`/${null==t?void 0:t.parentId}${e}`},editableInputParams:{parentId:""},isPaginated:!1},addVaccinationMapping:{queryType:"post",endpoint:"/add-vaccination-mapping",endpointResolver:function(e,t){return`${e}`},editableInputParams:{childId:"",vaccinationId:""},isPaginated:!1}},c=t.VaccinationTrackerEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:""}}]},f=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(C=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(C).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariables&&(m=n.checkInputVariables(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,f,p));var v,h,b,I=r.get("queryRunner"),P=(v=m?yield I.runQuery(n.queryType,y,Object.assign({},g,u)):{errors:{message:"Missing input variables"},data:null})&&v.data?v.data:{},R=P;if(n&&n.transformer){var w=n.transformer(P,p),T=w.data,_=w.hasNextPage,O=w.paginationMeta;R=T,h=_,b=O}return{rawData:P,data:R,hasNextPage:h,paginationMeta:b}}catch(e){var S,A;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(S=e.request)&&S.response?new Error(JSON.parse(null==e||null==(A=e.request)?void 0:A.response).message):e],hasError:!0}}var C})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"vaccinationTracker",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://rforrabbit.apptile.io/vaccination/api",queryRunner:"queryrunner"}),initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl");return n.initClient(a,(function(e){return e.headers=Object.assign({},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"vaccinationTracker"},runQuery:function*(e,t,r,n,a,i){var o=p[n];if(o)return yield(0,u.call)(f,e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"vaccinationTracker",type:"datasource",name:"Vaccination Tracker",description:"Vaccination Tracker for RforRabbit",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},6627:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.RiseAILoyaltyEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p={getGiftCard:{queryType:"get",endpoint:"/customer",endpointResolver:function(e,t){return`${e}/${t.customerId}/profile`},editableInputParams:{customerId:"",customerAccessToken:""},isPaginated:!1,authenticated:!0}},c=t.RiseAILoyaltyEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:"https://api.apptile.io/rise-ai-proxy"}},{type:"codeInput",name:"x-apptile-app-id",props:{label:"x-apptile-app-id",placeholder:""}}]},f=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(j=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(j).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariables&&(m=n.checkInputVariables(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f,u):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,g,p));var v,h,b=r.get("queryRunner"),I=r.get("x-apptile-app-id");n.authenticated&&(v=g.customerAccessToken);var P,R,w=(h=m?yield b.runQuery(n.queryType,y,Object.assign({},g,u),{headers:{"x-app-id":I,"x-shopify-customer-access-token":v}}):{errors:{message:"Missing input variables"},data:null})&&h.data?h.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w,p),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,P=S,R=A}return{rawData:w,data:T,hasNextPage:P,paginationMeta:R}}catch(e){var C,U;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(C=e.request)&&C.response?new Error(JSON.parse(null==e||null==(U=e.request)?void 0:U.response).message):e],hasError:!0}}var j})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"riseAI",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://api.apptile.io/rise-ai-proxy",queryRunner:"queryrunner","x-apptile-app-id":""}),initDatasource:function*(e,t,r){var n,a=(0,l.AjaxQueryRunner)(),i=t.config.get("apiBaseUrl"),o=null==(n=t.config)?void 0:n.get("x-apptile-app-id");return a.initClient(i,(function(e){return e.headers=Object.assign({},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:a},{selector:[t.get("id"),"x-apptile-app-id"],newValue:o}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.appId;return!!t&&{"x-apptile-app-id":t}},resolveClearCredentialConfigs:function(){return["x-apptile-app-id"]},getPlatformIdentifier:function(){return"riseAI"},runQuery:function*(e,t,r,n,a,i){var o=p[n];if(o)return yield(0,u.call)(f,e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"riseAI",type:"datasource",name:"Rise AI Loyalty and Rewards",description:"Rise AI Loyalty and Rewards",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},8e3:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.RivoRewardsEditors=void 0;var a=n(r(5990)),i=n(r(7488)),o=r(804),s=r(892),u=n(r(827)),l=r(3503),d={isPaginated:!1,contextInputParams:{proxyUrl:"",platformType:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).startIndex;return r?Object.assign({},e,{startIndex:r}):e}},p={getWaysToEarn:Object.assign({},d,{queryType:"get",endpoint:"/api/earning-rules",endpointResolver:function(e,t,r){var n=t.per_page,a=t.page;return r&&(a=Number.parseInt(null==r?void 0:r.nextPage)),`${e}?pagination[per_page]=${n}&pagination[page]=${a}`},transformer:l.TransformEarningRules,isPaginated:!0,editableInputParams:{per_page:100,page:1},checkInputVariabes:function(e){var t=e.per_page,r=e.page;return!!t&&!!r}}),getWaysToReedem:Object.assign({},d,{queryType:"get",endpoint:"/api/rewards",endpointResolver:function(e,t,r){var n=t.per_page,a=t.page,i=t.sort_by,o=t.sort_type,s=a;return r&&(s=Number.parseInt(null==r?void 0:r.nextPage)),void 0!==o?`${e}?pagination[per_page]=${n}&pagination[page]=${s}&sort[order_direction]=${i}&sort[order_type]=${o}`:`${e}?pagination[per_page]=${n}&pagination[page]=${s}&sort[order_direction]=${i}`},transformer:l.TransfromAllRewards,isPaginated:!0,editableInputParams:{per_page:100,page:1,sort_by:"asc or desc",sort_type:"name or points_amount or redeemed_count or dont fill thi field"},checkInputVariabes:function(e){var t=e.per_page,r=e.page,n=e.sort_by;return!!t&&!!r&&!!n}}),generateCouponCode:Object.assign({},d,{queryType:"post",endpoint:"/api/points-redemptions/create",endpointResolver:function(e){return e},editableInputParams:{shopifyCustomerId:"",rewardsId:1234,pointsAmount:"",creditsAmount:""},transformer:l.TransformCouponCode,inputResolver:function(e){return{shopifyCustomerId:e.shopifyCustomerId,rewardsId:e.rewardsId,pointsAmount:e.pointsAmount,creditsAmount:e.creditsAmount}}}),getCustomerDetails:Object.assign({},d,{queryType:"get",endpoint:"/api/customers",endpointResolver:function(e,t){return`${e}/${t.shopifyCustomerId}`},transformer:l.TransformSingleCsutomer,editableInputParams:{shopifyCustomerId:""},checkInputVariabes:function(e){return!!e.shopifyCustomerId}}),updateCustomer:Object.assign({},d,{queryType:"put",endpoint:"/api/customers",endpointResolver:function(e,t){var r=t.shopifyCustomerId;return console.log(r,t,"xxx"),`${e}/${r}/update`},transformer:l.TransformSingleCsutomer,editableInputParams:{shopifyCustomerId:"",month:"",day:""},inputResolver:function(e){var t=e.month,r=e.day,n=e.shopifyCustomerId;return{month:Number(t),day:Number(r),shopifyCustomerId:n}},checkInputVariabes:function(e){return!!e.shopifyCustomerId}}),fetchCoupons:Object.assign({},d,{queryType:"get",endpoint:"/api/points-redemptions",endpointResolver:function(e,t,r){var n=t.per_page,a=t.page,i=t.sort_by,o=t.sort_type,s=t.source,u=t.reward_id,l=t.code,d=t.used,p=t.referred_email,c=t.shopifyCustomerId,f=a;r&&(f=Number.parseInt(null==r?void 0:r.nextPage));var g={"filters[customer_identifier]":c,"pagination[per_page]":n,"pagination[page]":f,"sort[order_direction]":i};return void 0!==o&&""!==o&&(g["sort[order_type]"]=o),void 0!==s&&""!==s&&(g["filters[source]"]=s),void 0!==u&&""!==u&&(g["filters[reward_id]"]=u),void 0!==l&&""!==l&&(g["filters[code]"]=l),void 0!==d&&""!==d&&(g["filters[used]"]=d),void 0!==p&&""!==p&&(g["filters[referred_email]"]=p),`${e}?${Object.keys(g).map((function(e){return`${encodeURIComponent(e)}=${encodeURIComponent(g[e])}`})).join("&")}`},transformer:l.TransformRedemptionHistory,isPaginated:!0,editableInputParams:{shopifyCustomerId:"",source:"",reward_id:"",code:"",used:"",referred_email:"",per_page:100,page:1,sort_by:"asc or desc",sort_type:""}}),fetchTransactions:Object.assign({},d,{queryType:"get",endpoint:"/api/points-events",endpointResolver:function(e,t,r){var n=t.per_page,a=t.page,i=t.sort_by,o=t.sort_type,s=t.source,u=t.shopifyCustomerId,l=a;r&&(l=Number.parseInt(null==r?void 0:r.nextPage));var d={"filters[customer_identifier]":u,"pagination[per_page]":n,"pagination[page]":l,"sort[order_direction]":i};return void 0!==o&&""!==o&&(d["sort[order_type]"]=o),void 0!==s&&""!==s&&(d["filters[source]"]=s),`${e}?${Object.keys(d).map((function(e){return`${encodeURIComponent(e)}=${encodeURIComponent(d[e])}`})).join("&")}`},transformer:l.TransformPointsHistory,isPaginated:!0,editableInputParams:{shopifyCustomerId:"",source:"",per_page:100,page:1,sort_by:"asc or desc",sort_type:""}}),getALLVipTiers:Object.assign({},d,{queryType:"get",endpoint:"/api/vip-tiers",endpointResolver:function(e,t,r){var n=t.per_page,a=t.page,i=t.sort_by,o=t.sort_type,s=a;return r&&(s=Number.parseInt(null==r?void 0:r.nextPage)),void 0!==o?`${e}?pagination[per_page]=${n}&pagination[page]=${s}&&sort[order_direction]=${i}&sort[order_type]=${o}`:`${e}?pagination[per_page]=${n}&pagination[page]=${s}&&sort[order_direction]=${i}`},transformer:l.TransformVipTiers,isPaginated:!0,editableInputParams:{per_page:100,page:1,sort_by:"",sort_type:"name or threshold,or perks"},checkInputVariabes:function(e){var t=e.per_page,r=e.page;return!!t&&!!r}}),getSingleVipTier:Object.assign({},d,{queryType:"get",endpoint:"/api/vip-tiers",endpointResolver:function(e,t){return`${e}/${t.vipTierId}`},transformer:l.TransformSingleVipTier,editableInputParams:{vipTierId:""},checkInputVariabes:function(e){return!!e.vipTierId}})},c=t.RivoRewardsEditors={basic:[{type:"codeInput",name:"proxyUrl",props:{label:"Proxy Base Url",placeholder:"https://api.apptile.io/rivo-rewards"}},{type:"codeInput",name:"appId",props:{label:"Apptile App Id",placeholder:""}}]};t.default=(0,u.default)({name:"rivo",config:{proxyUrl:"https://api.apptile.io/rivo-rewards",appId:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n,a=(0,s.AjaxQueryRunner)(),i=null!=(n=null==r?void 0:r.get("appId"))?n:null;return a.initClient(r.get("proxyUrl"),(function(e){return e.headers={"Content-Type":"application/json","x-shopify-app-id":i},e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:a}]}},getQueries:function(){return p},getQueryInputParams:function(e){var t=p&&p[e]?p[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.proxyUrl,r=e.appId;return!(!t&&!r)&&{proxyUrl:t,appId:r}},resolveClearCredentialConfigs:function(){return["appId"]},getPlatformIdentifier:function(){return"rivo"},runQuery:function*(e,t,r,n,s,u){var l,d=p[n];if(d){var c,f,g=u.getNextPage,m=u.paginationMeta,y=null!=d?d:{},v=y.endpointResolver,h=y.endpoint,b=(l=y.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(l).reduce((function(e,n){var o=(0,i.default)(n,2),s=o[0];return o[1],r&&r.get(s)?Object.assign({},e,(0,a.default)({},s,r.get(s))):t&&t.get(s)?Object.assign({},e,(0,a.default)({},s,t.get(s))):e}),{})}),I=b(t,r),P=!0;d&&d.editableInputParams&&(c=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return t&&void 0!==t[o]&&"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e}),{})}(s,d.editableInputParams),null!=d&&d.checkInputVariabes&&(P=d.checkInputVariabes(c))),null!=d&&d.isPaginated&&d.paginationResolver&&g&&(c=d.paginationResolver(c,m)),f=d.inputResolver?d.inputResolver(c,I):c,h=v&&v(h,Object.assign({},I,f),m);var R,w=r.get("queryRunner");if(P)try{R=yield(0,o.call)(w.runQuery,d.queryType,h,f,Object.assign({},u))}catch(e){logger.error("error",JSON.stringify(e))}else R={errors:{message:"Missing input variables"},data:null};var T,_,O=R&&R.data?R.data:{},S=O;if(d&&d.transformer){var A=d.transformer(O);S=A.data,T=A.hasNextPage,_=A.paginationMeta}return yield{rawData:O,data:S,hasNextPage:T,paginationMeta:_,errors:[],hasError:!1}}},options:{propertySettings:{},pluginListing:{labelPrefix:"rivo",type:"datasource",name:"Rivo",description:"Rivo: Loyalty & Referrals",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:c})},3503:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransfromAllRewards=t.TransformVipTiers=t.TransformSingleVipTier=t.TransformSingleCsutomer=t.TransformRedemptionHistory=t.TransformPointsHistory=t.TransformEarningRules=t.TransformCouponCode=void 0;var a=n(r(7488));function i(e){var t=e.split("?")[1].split("&"),r={};return t.forEach((function(e){var t=e.split("="),n=(0,a.default)(t,2),i=n[0],o=n[1];if(i=decodeURIComponent(i),o=decodeURIComponent(o),i.includes("pagination[")){var s=i.match(/pagination\[(.*?)\]/)[1];r[s]=o}})),r}t.TransformEarningRules=function(e){var t,r={links:{self:(t=e).links.self,next:t.links.next,last:t.links.last},earningRules:t.data.map((function(e){var t,r;return{id:e.attributes.id,title:e.attributes.title,status:e.attributes.status,trigger:e.attributes.trigger,pointsAmount:e.attributes.points_amount,creditsAmount:e.attributes.credits_amount,balanceAmount:e.attributes.balance_amount,description:null!=(t=e.attributes.description)?t:"",url:null!=(r=e.attributes.url)?r:"",prettyEarningsText:e.attributes.pretty_earnings_text,pointsType:e.attributes.points_type,currencyBaseAmount:e.attributes.currency_base_amount,multipliers:e.attributes.multipliers,multiBalanceSettingsByTiers:e.attributes.multi_balance_settings_by_tiers}}))},n=i(r.links.self),a=i(r.links.next),o=i(r.links.last),s=o.page>n.page,u={currentPage:n.page,totalPages:o.page,nextPage:s?a.page:o.page};return{data:r.earningRules,hasNextPage:s,paginationMeta:u}},t.TransformVipTiers=function(e){var t,r={links:{self:(t=e).links.self,next:t.links.next,last:t.links.last},vipTiers:t.data.map((function(e){return{id:e.attributes.id,name:e.attributes.name,threshold:e.attributes.threshold,perks:e.attributes.perks}}))},n=i(r.links.self),a=i(r.links.next),o=i(r.links.last),s=o.page>n.page,u={currentPage:n.page,totalPages:o.page,nextPage:s?a.page:o.page};return{data:r.vipTiers,hasNextPage:s,paginationMeta:u}},t.TransformCouponCode=function(e){var t=e.data,r=function(e,t){return{id:t,name:e.name,pointsAmount:e.points_amount,creditsAmount:parseFloat(e.credits_amount),appliedAt:e.applied_at,code:e.code,expiresAt:e.expires_at,usedAt:e.used_at,rewardDetails:{id:e.reward.id,name:e.reward.name,pointsRequired:e.reward.points_amount,rewardType:e.reward.reward_type,displayText:e.reward.pretty_display_rewards,expiryMonths:e.reward.expiry_months,rewardValue:e.reward.reward_value,createdAt:e.reward.created_at,updatedAt:e.reward.updated_at},customerDetails:{id:e.customer.id,email:e.customer.email,fullName:`${e.customer.first_name} ${e.customer.last_name}`,loyaltyStatus:e.customer.loyalty_status,pointsTally:e.customer.points_tally,referralCode:e.customer.referral_code,referralUrl:e.customer.referral_url,vipTier:e.customer.vip_tier}}}(t.attributes,t.id);return{data:r}},t.TransformSingleCsutomer=function(e){var t,r;return{data:(t=e.data,{id:(r=t.attributes).id,email:r.email,firstName:r.first_name,lastName:r.last_name,acceptsMarketing:r.accepts_marketing,ordersCount:r.orders_count,verifiedEmail:r.verified_email,totalSpent:r.total_spent,shopifyTags:r.shopify_tags,loyaltyStatus:r.loyalty_status,pointsTally:r.points_tally,creditsTally:r.credits_tally,dob:r.dob,dobLastUpdatedAt:r.dob_last_updated_at,referralUrl:r.referral_url,referralCode:r.referral_code,vipTier:r.vip_tier,pointsExpireAt:r.points_expire_at})}},t.TransformSingleVipTier=function(e){var t;return{data:{id:(t=e.data).attributes.id,name:t.attributes.name,threshold:t.attributes.threshold,perks:t.attributes.perks}}},t.TransfromAllRewards=function(e){var t,r={links:{self:(t=e).links.self,next:t.links.next,last:t.links.last},rewards:t.data.map((function(e){return{id:e.attributes.id,name:e.attributes.name,enabled:e.attributes.enabled,pointsAmount:e.attributes.points_amount,pointsType:e.attributes.points_type,rewardType:e.attributes.reward_type,source:e.attributes.source,displayText:e.attributes.pretty_display_rewards,minOrderValueInCents:e.attributes.min_order_value_in_cents,expiryMonths:e.attributes.expiry_months,rewardValue:e.attributes.reward_value,redeemedCount:e.attributes.redeemed_count,createdAt:e.attributes.created_at,updatedAt:e.attributes.updated_at,termsOfService:{rewardType:e.attributes.terms_of_service.reward_type,appliesTo:e.attributes.terms_of_service.applies_to,expiryMonths:e.attributes.terms_of_service.expiry_months,showTos:e.attributes.terms_of_service.show_tos}}}))},n=i(r.links.self),a=i(r.links.next),o=i(r.links.last),s=o.page>n.page,u={currentPage:n.page,totalPages:o.page,nextPage:s?a.page:o.page};return{data:r.rewards,hasNextPage:s,paginationMeta:u}},t.TransformRedemptionHistory=function(e){var t,r={links:{self:(t=e).links.self,next:t.links.next,last:t.links.last},redemptionHistory:t.data.map((function(e){var t=e.attributes;return{id:t.id,pointsAmount:t.points_amount,creditsAmount:t.credits_amount,appliedAt:t.applied_at,name:t.name,code:t.code,expiresAt:t.expires_at,usedAt:t.used_at,refundedAt:t.refunded_at,revokedAt:t.revoked_at,reward:{id:t.reward.id,name:t.reward.name,enabled:t.reward.enabled,pointsAmount:t.reward.points_amount,pointsType:t.reward.points_type,rewardType:t.reward.reward_type,source:t.reward.source,prettyDisplayRewards:t.reward.pretty_display_rewards,minOrderValueInCents:t.reward.min_order_value_in_cents,expiryMonths:t.reward.expiry_months,rewardValue:t.reward.reward_value,redeemedCount:t.reward.redeemed_count,createdAt:t.reward.created_at,updatedAt:t.reward.updated_at,termsOfService:{rewardType:t.reward.terms_of_service.reward_type,appliesTo:t.reward.terms_of_service.applies_to,expiryMonths:t.reward.terms_of_service.expiry_months,showTos:t.reward.terms_of_service.show_tos}},customer:{id:t.customer.id,email:t.customer.email,firstName:t.customer.first_name,lastName:t.customer.last_name,acceptsMarketing:t.customer.accepts_marketing,ordersCount:t.customer.orders_count,verifiedEmail:t.customer.verified_email,totalSpent:t.customer.total_spent,shopifyTags:t.customer.shopify_tags,loyaltyStatus:t.customer.loyalty_status,pointsTally:t.customer.points_tally,creditsTally:t.customer.credits_tally,dob:t.customer.dob,dobLastUpdatedAt:t.customer.dob_last_updated_at,referralUrl:t.customer.referral_url,referralCode:t.customer.referral_code,vipTier:t.customer.vip_tier,pointsExpireAt:t.customer.points_expire_at}}}))},n=i(r.links.self),a=i(r.links.next),o=i(r.links.last),s=o.page>n.page,u={currentPage:n.page,totalPages:o.page,nextPage:s?a.page:o.page};return{data:r.redemptionHistory,hasNextPage:s,paginationMeta:u}},t.TransformPointsHistory=function(e){var t,r={links:{self:(t=e).links.self,next:t.links.next,last:t.links.last},pointsHistory:t.data.map((function(e){var t=e.attributes;return{id:t.id,pointsAmount:t.points_amount,creditsAmount:t.credits_amount,pointsDiff:t.points_diff,appliedAt:t.applied_at,internalNote:t.internal_note,externalNote:t.external_note,source:t.source,customer:{id:t.customer.id,email:t.customer.email,firstName:t.customer.first_name,lastName:t.customer.last_name,acceptsMarketing:t.customer.accepts_marketing,ordersCount:t.customer.orders_count,verifiedEmail:t.customer.verified_email,totalSpent:t.customer.total_spent,shopifyTags:t.customer.shopify_tags,loyaltyStatus:t.customer.loyalty_status,pointsTally:t.customer.points_tally,creditsTally:t.customer.credits_tally,dob:t.customer.dob,dobLastUpdatedAt:t.customer.dob_last_updated_at,referralUrl:t.customer.referral_url,referralCode:t.customer.referral_code,vipTier:t.customer.vip_tier,pointsExpireAt:t.customer.points_expire_at}}}))},n=i(r.links.self),a=i(r.links.next),o=i(r.links.last),s=o.page>n.page,u={currentPage:n.page,totalPages:o.page,nextPage:s?a.page:o.page};return{data:r.pointsHistory,hasNextPage:s,paginationMeta:u}}},2403:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.initCheckoutWithTokenV2=t.initCheckoutWithToken=void 0;var a,i,o=n(r(2766)),s=r(892),u=n(r(3216)),l=r(6352);t.initCheckoutWithToken=(a=(0,o.default)((function*(e,t,r,n,a){var i=a,o=null==r?void 0:r.get("shopfloCheckoutScreenId"),d=null==r?void 0:r.get("appId"),p=null==r?void 0:r.get("queryRunner"),c=i.storeFrontAccessToken,f=i.customerAccessToken,g=i.currentCheckout,m=i.storeDomain,y=i.discounts,v=null==g?void 0:g.lines;if(u.default.isArray(v)&&v.length){var h,b={tags:["apptile-mobile-app","apptile-"+l.Platform.OS]},I=yield p.runQuery("post","/",Object.assign({checkoutId:g.checkoutId,discounts:y},b),{headers:{"x-shopify-app-id":null!=d?d:"","x-shopify-customer-access-token":null!=f?f:"","x-shopify-storefront-access-token":null!=c?c:"","x-shopify-store-name":null!=m?m:""}});if(null!=(h=I.data)&&h.error);else{var P,R,w,T,_=null==I||null==(P=I.data)||null==(R=P.response)?void 0:R.token_id,O=null==I||null==(w=I.data)||null==(T=w.response)?void 0:T.checkout_url,S=[];S.push({selector:n.concat(["tokenId"]),newValue:_}),S.push({selector:n.concat(["checkoutUrl"]),newValue:O}),e((0,s.modelUpdateAction)(S,void 0,!0)),e((0,s.navigateToScreen)(o,{sfToken:_}))}}})),function(e,t,r,n,i){return a.apply(this,arguments)}),t.initCheckoutWithTokenV2=(i=(0,o.default)((function*(e,t,r,n,a){var i=a,o=null==r?void 0:r.get("shopfloCheckoutScreenId"),d=null==r?void 0:r.get("appId"),p=null==r?void 0:r.get("queryRunner"),c=i.storeFrontAccessToken,f=i.customerAccessToken,g=i.currentCart,m=i.storeDomain,y=i.discounts,v=null==g?void 0:g.lines;if(u.default.isArray(v)&&v.length){var h,b={tags:["apptile-mobile-app","apptile-"+l.Platform.OS]},I=yield p.runQuery("post","/v2/",Object.assign({cartId:g.id,discounts:y},b),{headers:{"x-shopify-app-id":null!=d?d:"","x-shopify-customer-access-token":null!=f?f:"","x-shopify-storefront-access-token":null!=c?c:"","x-shopify-store-name":null!=m?m:""}});if(null!=(h=I.data)&&h.error);else{var P,R,w,T,_=null==I||null==(P=I.data)||null==(R=P.response)?void 0:R.token_id,O=null==I||null==(w=I.data)||null==(T=w.response)?void 0:T.checkout_url,S=[];S.push({selector:n.concat(["tokenId"]),newValue:_}),S.push({selector:n.concat(["checkoutUrl"]),newValue:O}),e((0,s.modelUpdateAction)(S,void 0,!0)),e((0,s.navigateToScreen)(o,{sfToken:_}))}}})),function(e,t,r,n,a){return i.apply(this,arguments)})},4309:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.ShopFloEditors=t.ShopFloApiRecords=void 0;var a,i=n(r(2766)),o=r(892),s=n(r(827)),u=r(2403),l=t.ShopFloApiRecords={},d={initiateCheckout:{type:o.TriggerActionIdentifier,getValue:function(e,t,r){return u.initCheckoutWithToken},actionMetadata:{editableInputParams:{storeDomain:"",storeFrontAccessToken:"",customerAccessToken:"",currentCheckout:{},discounts:{}}}},initiateCheckoutV2:{type:o.TriggerActionIdentifier,getValue:function(e,t,r){return u.initCheckoutWithTokenV2},actionMetadata:{editableInputParams:{storeDomain:"",storeFrontAccessToken:"",customerAccessToken:"",currentCart:{},discounts:{}}}}},p=t.ShopFloEditors={basic:[{type:"codeInput",name:"appId",props:{label:"Apptile App Id"}},{type:"codeInput",name:"proxyUrl",props:{label:"Proxy URL"}},{type:"screenSelector",name:"shopfloCheckoutScreenId",props:{label:"ShopFlo Checkout Screen"}}]};t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:void 0,errors:[],hasError:!1}})),function(e,t,r,n,i,o){return a.apply(this,arguments)}),t.default=(0,s.default)({name:"ShopFlo",config:Object.assign({},o.baseDatasourceConfig,{appId:"",proxyUrl:"",tokenId:"",checkoutUrl:"",shopfloCheckoutScreenId:"",queryRunner:"queryRunner",initiateCheckout:"action",initiateCheckoutV2:"action"}),initDatasource:function*(e,t,r){var n=(0,o.AjaxQueryRunner)();return n.initClient(t.config.get("proxyUrl")),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return l},getQueryInputParams:function(e){var t=l&&l[e]?l[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"shopFlo"},resolveCredentialConfigs:function(e){var t=e.merchantId;return!!t&&{merchantId:t}},resolveClearCredentialConfigs:function(){return["merchantId"]},runQuery:function*(e,t,r,n,a,i){},options:{propertySettings:d,pluginListing:{labelPrefix:"ShopFlo",type:"datasource",name:"ShopFlo Integration",description:"ShopFlo Checkout integration",section:"Integrations",icon:"datasource"}},editors:p})},5967:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.simplyOTPLoginActionDsPropertySettings=t.simplyOTPLoginActionDsPluginConfig=t.simplyOTPLoginActionDatasourceEditor=t.default=void 0;var a,i,o=n(r(7488)),s=n(r(2766)),u=n(r(2584)),l=n(r(3664)),d=r(892),p=n(r(3216)),c=r(8218),f=r(4059),g=(t.simplyOTPLoginActionDsPluginConfig={sendOTP:d.TriggerActionIdentifier,verifyOTP:d.TriggerActionIdentifier,updateCustomer:d.TriggerActionIdentifier,resetSignInSteps:d.TriggerActionIdentifier,currentSignInStep:"SEND_OTP"},t.simplyOTPLoginActionDatasourceEditor={},t.simplyOTPLoginActionDsPropertySettings={sendOTP:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return g.sendOTP},actionMetadata:{editableInputParams:{type:"",username:"",countryCode:"",recaptchatoken:"",shopDomain:""}}},verifyOTP:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return g.verifyOTP},actionMetadata:{editableInputParams:{otp:"",successMessage:"",skipPostAuthRedirect:!1,forceUpdateProfile:!1,shopDomain:""}}},updateCustomer:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return g.updateCustomer},actionMetadata:{editableInputParams:{email:"",phone:"",firstname:"",lastname:"",successMessage:"",shopDomain:"",acceptEmailMarketing:"true or false",acceptSmsMarketing:"true or false",acceptWhatsappMarketing:"true or false"}}},resetSignInSteps:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return g.resetSignInSteps},actionMetadata:{editableInputParams:{}}}},new((0,l.default)((function e(){var t,r,n,a,i,o,l=this;(0,u.default)(this,e),this.requestShopifyUserSignIn=(t=(0,s.default)((function*(e,t,r,n,a,i,o,s,u,l,p){try{var c={pluginConfig:i.getPlugin("shopify"),pluginModel:o.getPluginModel("","shopify"),pluginSelector:["shopify"],eventModelJS:{value:"signInUser",params:{email:s,password:u,successMessage:l,skipPostAuthRedirect:!!p}}};e((0,d.triggerAction)(c))}catch(e){console.log("Error while triggering requestShopifyUserSignIn",e)}})),function(e,r,n,a,i,o,s,u,l,d,p){return t.apply(this,arguments)}),this.loginUser=(r=(0,s.default)((function*(e,t,r,n,a,i,o,s,u,c,g){if(p.default.isEmpty(s)){var m=[{selector:n.concat(["currentSignInStep"]),newValue:"UPDATE_CUSTOMER"},{selector:n.concat(["authLoader"]),newValue:!1}];e((0,d.modelUpdateAction)(m,void 0,!0))}else{if(s.includes("account/activate"))try{var y={pluginConfig:i.getPlugin("shopify"),pluginModel:o.getPluginModel("","shopify"),pluginSelector:["shopify"],eventModelJS:{value:"customerActivateByUrl",params:{activationUrl:s,password:Date.now().toString(),successMessage:u,skipPostAuthRedirect:!!c}}};e((0,d.triggerAction)(y))}catch(a){l.setBadParamErrorMessage(e,t,r,n,!0,{},"Unknown error occured. Please try again.","Unknown error occured. Please try again."),console.log("Error while activating account",a)}else{var v=(0,f.getQueryParamByNameFromUrl)(s,"logintoken"),h=(0,f.parseSimplyOTPJwt)(v),b=null==h?void 0:h.jti,I=null==h?void 0:h.iss;l.requestShopifyUserSignIn(e,t,r,n,a,i,o,b,I,u,c)}var P=[{selector:n.concat(["authLoader"]),newValue:!1}];e((0,d.modelUpdateAction)(P,void 0,!0))}})),function(e,t,n,a,i,o,s,u,l,d,p){return r.apply(this,arguments)}),this.sendOTP=(n=(0,s.default)((function*(e,t,r,n,a,i,o){var s,u=a.type,c=a.username,f=a.countryCode,g=a.recaptchatoken,m=a.shopDomain,y=[{selector:n.concat(["authLoader"]),newValue:!0}];e((0,d.modelUpdateAction)(y,void 0,!0));var v=yield l.queryExecutor(r,t,"sendOTP",{type:u,username:"phone"===u?`+${f}${c}`:c,recaptchatoken:g,shopDomain:m}),h=v.data,b=v.errors;if(500!==h.status&&200===h.status){var I=[{selector:n.concat(["type"]),newValue:u},{selector:n.concat(["username"]),newValue:c},{selector:n.concat(["countryCode"]),newValue:f},{selector:n.concat(["otpId"]),newValue:null==h||null==(s=h.data)?void 0:s.otpId},{selector:n.concat(["currentSignInStep"]),newValue:"VERIFY_OTP"},{selector:n.concat(["authLoader"]),newValue:!1},{selector:n.concat(["recaptchatoken"]),newValue:g}];e((0,d.modelUpdateAction)(I,void 0,!0))}else{var P;console.error(`Error while sending OTP ${b}`);var R=(null==(P=p.default.first(b))?void 0:P.message)||"An Unknown error occured!";l.setBadParamErrorMessage(e,t,r,n,!0,{},R,"")}})),function(e,t,r,a,i,o,s){return n.apply(this,arguments)}),this.verifyOTP=(a=(0,s.default)((function*(e,t,r,n,a,i,o){var s=a.otp,u=a.successMessage,c=a.skipPostAuthRedirect,f=a.forceUpdateProfile,g=a.shopDomain,m=[{selector:n.concat(["authLoader"]),newValue:!0}];e((0,d.modelUpdateAction)(m,void 0,!0));var y=r.get("type"),v=null==r?void 0:r.get("username"),h=null==r?void 0:r.get("countryCode"),b=r.get("otpId"),I=yield l.queryExecutor(r,t,"verifyOTP",{otp:s,type:y,username:"phone"===y?`+${h}${v}`:v,otpId:b,forceUpdateProfile:f,shopDomain:g}),P=I.data,R=I.errors;if(500!==P.status&&200===P.status){var w=null==P?void 0:P.data.redirect_url;l.loginUser(e,t,r,n,a,i,o,w,u,c,P.data)}else{var T;console.error(`Error while verifying OTP ${R}`);var _=(null==(T=p.default.first(R))?void 0:T.message)||P.message||"An Unknown error occured!";l.setBadParamErrorMessage(e,t,r,n,!0,{},_,"");var O=[{selector:n.concat(["authLoader"]),newValue:!1}];e((0,d.modelUpdateAction)(O,void 0,!0))}})),function(e,t,r,n,i,o,s){return a.apply(this,arguments)}),this.updateCustomer=(i=(0,s.default)((function*(e,t,r,n,a,i,o){var s,u=a.email,c=a.firstname,f=a.lastname,g=a.successMessage,m=a.phone,y=a.shopDomain,v=a.acceptEmailMarketing,h=a.acceptSmsMarketing,b=a.acceptWhatsappMarketing,I=[{selector:n.concat(["authLoader"]),newValue:!0}];e((0,d.modelUpdateAction)(I,void 0,!0));var P=r.get("otpId"),R=r.get("countryCode"),w={firstname:c,lastname:f,otpId:P,email:u,acceptEmailMarketing:v,acceptSmsMarketing:h,acceptWhatsappMarketing:b,shopDomain:y};p.default.isEmpty(m)||(w.phone=`+${R}${m}`);var T=yield l.queryExecutor(r,t,"updateCustomerDetails",w),_=T.data,O=T.errors;if(500!==_.status&&200===_.status){var S=null==_||null==(s=_.data)?void 0:s.redirect_url;l.loginUser(e,t,r,n,a,i,o,S,g,void 0,_.data)}else{var A;console.error(`Error while updating customer ${O}`);var C=(null==(A=p.default.first(O))?void 0:A.message)||"An Unknown error occured!";l.setBadParamErrorMessage(e,t,r,n,!0,{},C,"")}})),function(e,t,r,n,a,o,s){return i.apply(this,arguments)}),this.resetSignInSteps=(o=(0,s.default)((function*(e,t,r,n,a,i,o){var s=[{selector:n.concat(["currentSignInStep"]),newValue:""},{selector:n.concat(["authLoader"]),newValue:!1}];e((0,d.modelUpdateAction)(s,void 0,!0))})),function(e,t,r,n,a,i,s){return o.apply(this,arguments)})}),[{key:"queryExecutor",value:(i=(0,s.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,d.GetRegisteredPlugin)(a),o=this.getQueries()[r];return yield(0,c.executeQuery)(i,t,e,o,Object.assign({},n),{})})),function(e,t,r,n){return i.apply(this,arguments)})},{key:"getQueries",value:function(){var e,t=(0,d.GetRegisteredPluginInfo)("simplyOTPLogin");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}},{key:"setSuccessMessage",value:(a=(0,s.default)((function*(e,t,r,n,a){var i=[];i.push({selector:n.concat(["authLoader"]),newValue:!1}),toast.show(a,{type:"success",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,d.modelUpdateAction)(i,void 0,!0))})),function(e,t,r,n,i){return a.apply(this,arguments)})},{key:"setBadParamErrorMessage",value:function(e,t,r,n,a,i,s,u){var l=u||s,c=[];c.push({selector:n.concat(["authLoader"]),newValue:!1}),p.default.entries(i||[]).map((function(e){var t=(0,o.default)(e,2),r=t[0],a=t[1];return c.push({selector:n.concat([r]),newValue:a})})),toast.show(l,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,d.modelUpdateAction)(c,void 0,!0))}}])));t.default=g},4059:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.getQueryParamByNameFromUrl=function(e,t){t=t.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},t.isJWTValid=function(e,t,r){return s.apply(this,arguments)},t.parseSimplyOTPJwt=function(e){var t=null==e?void 0:e.split(".")[1];if(!t)throw new Error(`invlid token ${e}`);var r=o.Buffer.from(t,"base64");return JSON.parse(r.toString())};var a=n(r(2766)),i=n(r(8352)),o=r(1545);function s(){return(s=(0,a.default)((function*(e,t,r){if(!e)return!1;try{return(yield i.default.post(`${t}/generate-jwt/verify`,{token:e},{headers:{"Content-Type":"application/json","x-shopify-app-id":r}})).data.valid}catch(e){return!1}}))).apply(this,arguments)}},8218:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.SimplyOTPLoginEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(892),l=n(r(827)),d=r(5967),p=r(4059),c=n(r(8352)),f=n(r(1432)),g={sendOTP:{queryType:"post",endpoint:"/simplyotplogin",endpointResolver:function(e,t){return`${e}/${t.apiVersion}/otp`},editableInputParams:{type:"",username:"",recaptchatoken:"",shopDomain:""},inputResolver:function(e){var t=e.type,r=e.username,n=(e.countryCode,e.recaptchatoken);return{username:r,type:t,recaptcha_token:f.default.isEmpty(n)?"":n}},headersResolver:function(e){return{action:"sendOTP",shop_name:e.shopDomain}}},verifyOTP:{queryType:"post",endpoint:"/simplyotplogin",endpointResolver:function(e,t){return`${e}/${t.apiVersion}/otp`},editableInputParams:{type:"",username:"",otp:"",otpId:"",forceUpdateProfile:!1,shopDomain:""},inputResolver:function(e){var t=e.type,r={username:e.username,type:t,otp:e.otp,otp_id:e.otpId};return e.forceUpdateProfile?r:Object.assign({},r,{force_update_profile:!1})},headersResolver:function(e){return{action:"verifyOTP",shop_name:e.shopDomain}}},updateCustomerDetails:{queryType:"post",endpoint:"/simplyotplogin",endpointResolver:function(e,t){return`${e}/${t.apiVersion}/otp`},editableInputParams:{firstname:"",lastname:"",email:"",otpId:"",phone:"",acceptEmailMarketing:"true or false",acceptSmsMarketing:"true or false",acceptWhatsappMarketing:"true or false",shopDomain:""},inputResolver:function(e){var t=e.otpId,r=e.firstname,n=e.lastname,a=e.phone,i=e.email,o=e.acceptEmailMarketing,s=e.acceptSmsMarketing,u=e.acceptWhatsappMarketing,l={first_name:r,last_name:n,otp_id:t};return a&&(l.phone_no=a),i&&(l.email=i),o&&(l.accept_email_marketing=o),s&&(l.accept_sms_marketing=s),u&&(l.accept_whatsapp_marketing=u),l},headersResolver:function(e){return{action:"updateEmail",shop_name:e.shopDomain}}}},m=Object.assign({},d.simplyOTPLoginActionDsPropertySettings),y=t.SimplyOTPLoginEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Url",placeholder:"https://omqkhavcch.execute-api.ap-south-1.amazonaws.com"}},{type:"codeInput",name:"apiVersion",props:{label:"Api Version",placeholder:"v6"}},{type:"codeInput",name:"proxyUrl",props:{label:"SimplyOtp Proxy Url",placeholder:""}},{type:"codeInput",name:"appId",props:{label:"Apptile App Id",placeholder:""}}]},v=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{var l,d,f,g;if(!n)throw new Error("Invalid Query");var m=null!=i?i:{},y=(m.getNextPage,m.paginationMeta,null!=n?n:{}),v=y.endpointResolver,h=y.headersResolver,b=y.editableInputParams,I=y.endpoint,P=null==(l=t.config)?void 0:l.get("apiVersion");I=v&&v(I,Object.assign({},a,{apiVersion:P}));var R=h&&h(a),w=r.get("queryRunner"),T=function(e,t){return e?Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e}),{}):e}(a,b),_=n.inputResolver?n.inputResolver(T):T,O=null!=(d=null==r?void 0:r.get("proxyUrl"))?d:null,S=null!=(f=null==(g=t.config)?void 0:g.get("appId"))?f:null,A=yield u.LocalStorage.getValue("SIMPLY_OTP_JWT_TOKEN");(yield(0,p.isJWTValid)(A,O,S))||(yield c.default.get(`${O}/generate-jwt`,{headers:{"Content-Type":"application/json","x-shopify-app-id":S}}).then((function(e){A=e.data.token,u.LocalStorage.setValue("SIMPLY_OTP_JWT_TOKEN",e.data.token)})).catch((function(e){console.error("Error: generating token",e)})));var C=yield w.runQuery(n.queryType,I,_,{headers:Object.assign({},R,{Authorization:`Bearer ${A}`,"Content-Type":"application/json"})}),U=C&&C.data?C.data:{};return{rawData:U,data:U,hasNextPage:!1,paginationMeta:null}}catch(e){var j,x;return console.error(e),{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:null==e||null==(j=e.response)||null==(x=j.data)?void 0:x.message,hasError:!0}}})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,l.default)({name:"simplyOTPLogin",config:Object.assign({},u.baseDatasourceConfig,{queryRunner:"queryrunner",authLoader:"false",apiBaseUrl:"=",apiVersion:"",proxyUrl:"https://api.apptile.io/simply-otp",appId:""},d.simplyOTPLoginActionDsPluginConfig),initDatasource:function*(e,t,r){var n=(0,u.AjaxQueryRunner)(),a=null==r?void 0:r.get("apiBaseUrl");return n.initClient(a,(function(e){return e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"}),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return g},getQueryInputParams:function(e){var t=g&&g[e]?g[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.appId;return!!t&&{appId:t}},resolveClearCredentialConfigs:function(){return["appId"]},getPlatformIdentifier:function(){return"simplyOtp"},runQuery:function*(e,t,r,n,a,i){var o=g[n];if(o)return yield v(e,t,r,o,a,i)},options:{propertySettings:m,pluginListing:{labelPrefix:"simplyOTPLogin",type:"datasource",name:"Simply OTP Login",description:"Simply OTP Login",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:y})},7378:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.SmileEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d={fetchCustomer:{queryType:"get",endpoint:"/api/customer",editableInputParams:{email:""},endpointResolver:function(e,t){var r="";return null!=t&&t.email&&(r=t.email),`${e}?email=${r}`}},fetchCustomerTransactions:{queryType:"get",endpoint:"/api/points_transactions",editableInputParams:{customerId:""},endpointResolver:function(e,t){return`${e}?customer_id=${null==t?void 0:t.customerId}`}},fetchWaysToRedeem:{queryType:"get",endpoint:"/api/points_products"}},p=t.SmileEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:"https://api.apptile.io/smile"}},{type:"codeInput",name:"appId",props:{label:"app Id",placeholder:""}}]},c=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(C=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(C).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariables&&(m=n.checkInputVariables(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,f,p));var v,h,b,I=r.get("queryRunner"),P=(v=m?yield I.runQuery(n.queryType,y,Object.assign({},g,u)):{errors:{message:"Missing input variables"},data:null})&&v.data?v.data:{},R=P;if(n&&n.transformer){var w=n.transformer(P,p),T=w.data,_=w.hasNextPage,O=w.paginationMeta;R=T,h=_,b=O}return{rawData:P,data:R,hasNextPage:h,paginationMeta:b}}catch(e){var S,A;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(S=e.request)&&S.response?new Error(JSON.parse(null==e||null==(A=e.request)?void 0:A.response).message):e],hasError:!0}}var C})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,l.wrapDatasourceModel)({name:"smile",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://api.apptile.io/smile-proxy",appId:"",queryRunner:"queryrunner"}),resolveCredentialConfigs:function(e){var t=e.apiBaseUrl;return{appId:e.appId,apiBaseUrl:t||"https://api.apptile.io/smile-proxy"}},initDatasource:function*(e,t,r){var n,a=(0,l.AjaxQueryRunner)(),i=r.get("apiBaseUrl");i.endsWith("/")&&(i=i.slice(0,-1));var o=null==(n=t.config)?void 0:n.get("appId");return a.initClient(i,(function(e){return e.headers=Object.assign({"x-shopify-app-id":o},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:a}]}},getQueries:function(){return d},getQueryInputParams:function(e){var t=d&&d[e]?d[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"smile"},runQuery:function*(e,t,r,n,a,i){var o=d[n];if(o)return yield(0,u.call)(c,e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"smile",type:"datasource",name:"Smile",description:"Reward Tracker for Smile.io",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:p})},5147:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.authActionsDatasourcePropertySettings=t.authActionsDatasourcePluginConfig=t.authActionDatasourceEditor=void 0;var a,i,o,s,u,l,d,p=n(r(7488)),c=n(r(2766)),f=n(r(2584)),g=n(r(3664)),m=r(892),y=n(r(3216)),v=r(1718),h=(t.authActionsDatasourcePluginConfig={signInUser:m.TriggerActionIdentifier,signOutUser:m.TriggerActionIdentifier,loggedInUserAccessToken:"",authLoader:!1},t.authActionDatasourceEditor={basic:[{type:"screenSelector",name:"signInRedirectScreenId",props:{label:"Post signIn Redirect Screen"}},{type:"screenSelector",name:"signOutRedirectScreenId",props:{label:"Post signOut Redirect Screen"}}]},t.authActionsDatasourcePropertySettings={signInUser:{type:m.TriggerActionIdentifier,getValue:function(e,t,r){return h.signInUser},actionMetadata:{editableInputParams:{email:"",password:"",successMessage:"",badParameterMessage:"",errorMessage:"",skipPostAuthRedirect:!1}}},signOutUser:{type:m.TriggerActionIdentifier,getValue:function(e,t,r){return h.signOutUser},actionMetadata:{editableInputParams:{skipPostSignOutRedirect:!1}}},loggedInUserAccessToken:{getValue:function(e,t,r){return t}}},new((0,g.default)((function e(){var t,r,n,a=this;(0,f.default)(this,e),this.preSignInUser=(t=(0,c.default)((function*(e,t,r,n,i){var o,s=i,u=s.email,l=s.password,d=null,p=yield a.queryExecutor(r,t,"login",{email:u,password:l}),c=p.data,f=p.errors;return c&&null!=c&&c.accessToken?(yield a.storeloggedInUserAccessToken(c),{customerData:d={loggedInUserAccessToken:c},error:null}):(console.log("Error signInResponse",c),{customerData:d,error:null==(o=y.default.first(f))?void 0:o.message})})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.signInUser=(r=(0,c.default)((function*(e,t,r,n,i,o,s){var u=[{selector:n.concat(["authLoader"]),newValue:!0}],l=i,d=l.successMessage,p=l.skipPostAuthRedirect,c=l.errorMessage,f=l.badParameterMessage;try{var g=r.get("signInRedirectScreenId");e((0,m.modelUpdateAction)(u,void 0,!0));var y=yield a.preSignInUser(e,t,r,n,i),v=y.customerData,h=y.error;if(h)return console.log("error",h),void a.setBadParamErrorMessage(e,t,r,n,p,h,f);g||console.log("Please configure signIn screen in shopify"),a.setSuccessMessage(e,t,r,n,p,v,d),p||e((0,m.navigateToScreen)(g,{}))}catch(h){console.log("Error signUpResponse",h),a.setErrorMessage(e,t,r,n,p,null==h?void 0:h.message,c)}})),function(e,t,n,a,i,o,s){return r.apply(this,arguments)}),this.signOutUser=(n=(0,c.default)((function*(e,t,r,n,i,o,s){var u=i.skipPostSignOutRedirect,l=r.get("signOutRedirectScreenId");try{var d=null;yield a.storeloggedInUserAccessToken(d),yield a.storeLoggedInUserDetails(d);var p=[];p.push({selector:n.concat(["loggedInUser"]),newValue:d}),p.push({selector:n.concat(["loggedInUserAccessToken"]),newValue:d}),e((0,m.modelUpdateAction)(p,void 0,!0)),l||console.log("Please configure signOut screen in shopify"),u||e((0,m.navigateToScreen)(l,{}))}catch(t){console.log("error while sign out"),u||e((0,m.navigateToScreen)(l,{}))}})),function(e,t,r,a,i,o,s){return n.apply(this,arguments)})}),[{key:"queryExecutor",value:(d=(0,c.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,m.GetRegisteredPlugin)(a),o=this.getQueries()[r];return yield(0,v.executeQuery)(i,t,e,o,Object.assign({},n),{})})),function(e,t,r,n){return d.apply(this,arguments)})},{key:"getQueries",value:function(){var e,t=(0,m.GetRegisteredPluginInfo)("snackShackPartner");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}},{key:"updateLocalStore",value:(l=(0,c.default)((function*(e,t){yield m.LocalStorage.setValue(e,t)})),function(e,t){return l.apply(this,arguments)})},{key:"storeLoggedInUserDetails",value:(u=(0,c.default)((function*(e){yield this.updateLocalStore("loggedInUser",e)})),function(e){return u.apply(this,arguments)})},{key:"storeloggedInUserAccessToken",value:(s=(0,c.default)((function*(e){yield this.updateLocalStore("loggedInUserAccessToken",e)})),function(e){return s.apply(this,arguments)})},{key:"setErrorMessage",value:(o=(0,c.default)((function*(e,t,r,n,a,i,o){var s=o||i,u=[];u.push({selector:n.concat(["authLoader"]),newValue:!1}),toast.show(s,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}}),setTimeout((function(){return e((0,m.modelUpdateAction)(u,void 0,!0))}),1)})),function(e,t,r,n,a,i,s){return o.apply(this,arguments)})},{key:"setBadParamErrorMessage",value:(i=(0,c.default)((function*(e,t,r,n,a,i,o){var s=o||i,u=[];u.push({selector:n.concat(["authLoader"]),newValue:!1}),toast.show(s,{type:"error",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,m.modelUpdateAction)(u,void 0,!0))})),function(e,t,r,n,a,o,s){return i.apply(this,arguments)})},{key:"setSuccessMessage",value:(a=(0,c.default)((function*(e,t,r,n,a,i,o){var s=[];s.push({selector:n.concat(["authLoader"]),newValue:!1}),y.default.entries(i||[]).map((function(e){var t=(0,p.default)(e,2),r=t[0],a=t[1];return s.push({selector:n.concat([r]),newValue:a})})),toast.show(o,{type:"success",placement:"bottom",duration:2e3,style:{marginBottom:80}}),e((0,m.modelUpdateAction)(s,void 0,!0))})),function(e,t,r,n,i,o,s){return a.apply(this,arguments)})}])));t.default=h},1718:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.SnackShackPartnerEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=n(r(5971)),l=r(892),d=r(804),p=n(r(827)),c=r(5147),f=r(588),g={fetchOrders:{queryType:"get",endpoint:"/api/orders",endpointResolver:function(e,t,r){var n,a=(null!=r?r:{}).after,i=a?`&offset=${a}`:"";return`${e}?limit=${null!=(n=null==t?void 0:t.perPage)?n:10}${i}`},editableInputParams:{perPage:""},transformer:f.TransformSnackShackOrders,paginationResolver:function(e,t){var r=t.after;return Object.assign({},e,{after:r})},isPaginated:!0},fetchFilteredOrders:{queryType:"get",endpoint:"/api/orders",endpointResolver:function(e,t,r){var n,a=t.status,i=(null!=r?r:{}).after,o=i?`&offset=${i}`:"",s=a?`&status=${a}`:"";return`${e}?limit=${null!=(n=null==t?void 0:t.perPage)?n:10}${o}${s}`},editableInputParams:{perPage:"",status:""},transformer:f.TransformSnackShackOrders,paginationResolver:function(e,t){var r=t.after;return Object.assign({},e,{after:r})},isPaginated:!0},updateOrder:{queryType:"post",endpoint:"/api",endpointResolver:function(e,t){return`${e}/orders/${t.orderId}/updateStatus`},inputResolver:function(e){return{status:e.status}},editableInputParams:{orderId:"",status:""},isPaginated:!1},login:{queryType:"post",endpoint:"/api/users/login",inputResolver:function(e){return{email:e.email,password:e.password}},editableInputParams:{email:"",password:""},isPaginated:!1},changePassword:{queryType:"post",endpoint:"/api/users/change-password",inputResolver:function(e){return{password:e.password,confirmPassword:e.confirmPassword}},editableInputParams:{password:"",confirmPassword:""}},resetPasswordGetOTP:{queryType:"post",endpoint:"/api/users/reset-password/get-otp",inputResolver:function(e){return{phone:e.phone}},editableInputParams:{phone:""}},resetPasswordVerifyOTP:{queryType:"post",endpoint:"/api/users/reset-password/verify-otp",inputResolver:function(e){return{sessionId:e.sessionId,code:e.code}},editableInputParams:{sessionId:"",code:""}},resetPasswordChangePassword:{queryType:"post",endpoint:"/api/users/reset-password/change-password",inputResolver:function(e){return{sessionId:e.sessionId,password:e.password,confirmPassword:e.confirmPassword}},editableInputParams:{sessionId:"",password:"",confirmPassword:""}}},m=Object.assign({},c.authActionsDatasourcePropertySettings),y=t.SnackShackPartnerEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Url",placeholder:""}}].concat((0,u.default)(c.authActionDatasourceEditor.basic))},v=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{var u;if(!n)throw new Error("Invalid Query");var l,d,p,c=null!=i?i:{},f=c.getNextPage,g=c.paginationMeta;if(n&&n.contextInputParams){var m=(U=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(U).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});l=m(t,r)}n&&n.editableInputParams&&(d=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams)),null!=n&&n.isPaginated&&n.paginationResolver&&f&&(d=n.paginationResolver(d,g)),p=n.inputResolver?n.inputResolver(d):d;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,d,g));var v,h,b=null!=(u=null==r?void 0:r.get("loggedInUserAccessToken"))?u:null,I=r.get("queryRunner"),P=yield I.runQuery(n.queryType,y,Object.assign({},p,l),{headers:{Authorization:null!=b&&b.accessToken?`Bearer ${null==b?void 0:b.accessToken}`:""}}),R=P&&P.data?P.data:{},w=R;if(n&&n.transformer){var T=n.transformer(R,g),_=T.data,O=T.hasNextPage,S=T.paginationMeta;w=_,v=O,h=S}return{rawData:R,data:w,hasNextPage:v,paginationMeta:h}}catch(e){var A,C;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(A=e.request)&&A.response?new Error(JSON.parse(null==e||null==(C=e.request)?void 0:C.response).message):e],hasError:!0}}var U})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,p.default)({name:"snackShackPartner",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"http://localhost:3000",queryRunner:"queryrunner"},c.authActionsDatasourcePluginConfig),initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl");n.initClient(a,(function(e){return e.headers=Object.assign({},e.headers,{"Content-Type":"application/json"}),e}));var i=yield(0,d.call)(l.LocalStorage.getValue,"loggedInUserAccessToken");return{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n},{selector:[t.get("id"),"loggedInUserAccessToken"],newValue:null!=i?i:null}]}},getQueries:function(){return g},getQueryInputParams:function(e){var t=g&&g[e]?g[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"snackShackPartner"},runQuery:function*(e,t,r,n,a,i){var o=g[n];if(o)return yield(0,d.call)(v,e,t,r,o,a,i)},options:{propertySettings:m,pluginListing:{labelPrefix:"snackShackPartner",type:"datasource",name:"SnackShack Partner",description:"To process orders on SnackShack Partner stands",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:y})},588:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformSnackShackOrders=void 0;var a=n(r(3216)),i=r(892);t.TransformSnackShackOrders=function(e){var t=a.default.get(e,"orders",{}),r=null!=e?e:{},n=r.hasMore,o=r.cursor;return(0,i.formatQueryReturn)(t,e,{after:o},n)}},9803:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=r(9588),d=new((0,s.default)((function e(){var t;(0,o.default)(this,e),this.getCustomerRewards=(t=(0,i.default)((function*(e,t,r,n,a){var i=a.customerId,o=a.customerEmail;try{var s=(yield(0,l.runQuery)(r,t,"GetCustomerRewards",a)).data;e((0,u.modelUpdateAction)([{selector:[t.get("id"),"customerRewards"],newValue:s}]))}catch(e){return console.log("Got Error while running action getCustomerRewards",e),{customerId:i,customerEmail:o}}})),function(e,r,n,a,i){return t.apply(this,arguments)})}),[{key:"applyChanges",value:(a=(0,i.default)((function*(e,t,r,n,a,i){var o=[];i.forEach((function(e,t){var r=n.concat([e]);o.push({selector:r,newValue:a[t]})})),e((0,u.modelUpdateAction)(o,void 0,!0))})),function(e,t,r,n,i,o){return a.apply(this,arguments)})}]));t.default=d},9588:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.StampedEditors=void 0,t.runQuery=T;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=n(r(7128)),l=r(804),d=r(892),p=r(1653),c=n(r(827)),f=r(3147),g=r(1137),m=n(r(3216)),y=n(r(9803)),v=["publicKey","storeUrl","after"],h=["publicKey","storeUrl","after"],b={isPaginated:!1,contextInputParams:{apiBaseUrl:"",publicKey:"",privateKey:"",storeHash:"",storeUrl:"",headers:{}},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},I={GetCustomerRewards:Object.assign({},b,{queryType:"post",endpoint:"/v2/rewards/init",endpointResolver:function(e,t){var r={apiKey:t.publicKey,sId:t.storeHash};return`${e}${(0,p.jsonToQueryString)(r)}`},inputResolver:function(e,t){var r=t.privateKey,n=e.customerId,a=e.customerEmail;return{customerId:n,customerEmail:a,authToken:(0,g.generateHmac)(n+a,r).toString()}},transformer:f.TransformGetRewards,editableInputParams:{customerId:"",customerEmail:""}}),GetCustomerReviews:Object.assign({},b,{queryType:"get",endpoint:"/widget/reviews",endpointResolver:function(e,t,r){var n=t.publicKey,a=t.storeUrl,i=t.after,o=(0,u.default)(t,v),s=Object.assign({storeUrl:a,apiKey:n},o);return r&&(s.page=i?i+1:1),`${e}${(0,p.jsonToQueryString)(s)}`},transformer:f.TransformGetReviews,isPaginated:!0,editableInputParams:{productId:"",sortReviews:"",minRating:0,take:2},checkInputVariabes:function(e){return!!e.productId}}),GetCustomerReviewsV1:Object.assign({},b,{queryType:"get",endpoint:"/widget/reviews",endpointResolver:function(e,t,r){var n=t.publicKey,a=t.storeUrl,i=t.after,o=(0,u.default)(t,h),s=Object.assign({storeUrl:a,apiKey:n},o);return r&&(s.page=i?i+1:1),`${e}${(0,p.jsonToQueryString)(s)}`},transformer:f.TransformGetReviewsV1,isPaginated:!0,editableInputParams:{productId:"",sortReviews:"",minRating:0,take:2},checkInputVariabes:function(e){return!!e.productId}}),CreateCustomerReviews:Object.assign({},b,{queryType:"post",endpoint:"/reviews3",endpointResolver:function(e,t){var r=t.publicKey,n={sId:t.storeHash,apiKey:r};return`${e}${(0,p.jsonToQueryString)(n)}`},headers:{"Content-Type":"application/x-www-form-urlencoded"},transformer:f.TransformCreateReviews,inputResolver:function(e,t){return{productId:e.productId,author:e.author,email:e.email,location:e.location,reviewRating:e.reviewRating,reviewTitle:e.reviewTitle,reviewMessage:e.reviewMessage,reviewRecommendProduct:e.reviewRecommendProduct,productName:e.productName,productSKU:e.productSKU,productImageUrl:e.productImageUrl,productUrl:e.productUrl,reviewSource:e.reviewSource}},editableInputParams:{productId:"",author:"",email:"",location:"",reviewRating:"",reviewTitle:"",reviewMessage:"",reviewRecommendProduct:"",productName:"",productSKU:"",productImageUrl:"",productUrl:"",reviewSource:""}}),CreateProductReviewBadge:Object.assign({},b,{queryType:"post",endpoint:"/widget/badges",endpointResolver:function(e,t){return`${e}${(0,p.jsonToQueryString)({isIncludeBreakdown:"true",isincludehtml:"true"})}`},transformer:f.TransformCreateProductReviewBadge,inputResolver:function(e,t){var r=e.productIds,n=t.publicKey,a=t.storeUrl;return{productIds:r.map((function(e){return{productId:e}})),apiKey:n,storeUrl:a}},editableInputParams:{productIds:""},checkInputVariabes:function(e){return!!e.productIds}}),RedeemPoints:{contextInputParams:Object.assign({headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}},b),isPaginated:!1,queryType:"post",endpoint:"/v2/rewards/redeem",endpointResolver:function(e,t){var r={apiKey:t.apiKey,sId:t.sId,campaignId:t.campaignId,points:t.points};return`${e}${(0,p.jsonToQueryString)(r)}`},editableInputParams:{customerId:"",customerEmail:"",points:"",campaignId:"",apiKey:"",sId:""}}},P={getCustomerRewards:{type:d.TriggerActionIdentifier,getValue:function(e,t,r){return y.default.getCustomerRewards},actionMetadata:{editableInputParams:{customerId:"",customerEmail:""}}}},R=t.StampedEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://api-v3.Stamped.io"}},{type:"codeInput",name:"publicKey",props:{label:"Stamped Public Key",placeholder:""}},{type:"codeInput",name:"privateKey",props:{label:"Stamped Private Key",placeholder:""}},{type:"codeInput",name:"storeHash",props:{label:"Stamped Store Hash",placeholder:""}},{type:"codeInput",name:"storeUrl",props:{label:"Stamped Store URL",placeholder:""}},{type:"codeInput",name:"shopifyDS",props:{label:"Shopify Datasource",placeholder:"{{shopify}}"}}]},w=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a){var i,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};try{var l,d,p=u.getNextPage,c=u.paginationMeta,f=null!=n?n:{},g=f.endpointResolver,m=f.endpoint,y=(i=f.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(i).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0];return a[1],r&&r.get(i)?Object.assign({},e,(0,o.default)({},i,r.get(i))):t&&t.get(i)?Object.assign({},e,(0,o.default)({},i,t.get(i))):e}),{})}),v=y(t,r),h=!0;n&&n.editableInputParams&&(l=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(h=n.checkInputVariabes(l))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(l=n.paginationResolver(l,c)),d=n.inputResolver?n.inputResolver(l,v):l,m=g&&g(m,Object.assign({},v,d),p);var b,I=r.get("queryRunner");if(h)try{b=yield I.runQuery(n.queryType,m,Object.assign({},d),Object.assign({},u,{headers:Object.assign({},n.headers)}))}catch(e){logger.error("error",e)}else b={errors:{message:"Missing input variables"},data:null};var P,R,w=b&&b.data?b.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,P=S,R=A}return{rawData:w,data:T,hasNextPage:P,paginationMeta:R,errors:[],hasError:!1}}catch(e){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}})),function(e,t,r,n,i){return a.apply(this,arguments)});function T(e,t,r,n){return _.apply(this,arguments)}function _(){return(_=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,d.GetRegisteredPlugin)(a),o=I[r];if(I[r])return yield w(i,t,e,o,Object.assign({},n),{})}))).apply(this,arguments)}t.default=(0,c.default)({name:"Stamped",config:{apiBaseUrl:"https://api-v3.Stamped.io",publicKey:"",privateKey:"",storeHash:"",storeUrl:"",getCustomerRewards:"action",queryRunner:"queryrunner",shopifyDS:""},initDatasource:function*(e,t,r){var n=(0,d.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){var t,n=null!=(t=null==r?void 0:r.get("authHeaders"))?t:{};return e.headers=Object.assign({},e.headers,n),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},_onPluginUpdate:function*(e,t,r,n,a,i,o){var s,u,p,c,f,g=yield(0,l.select)(d.selectPluginConfig,r,t),y=(0,d.GetRegisteredConfig)(g.get("subtype"))(g.config),v=g.set("config",y),h=e.stageModel.getModelValue([]),b=h.get(v.get("id")),I=null==(s=b)?void 0:s.get("shopifyDS"),P=null==(u=b)?void 0:u.get("queryRunner"),R=null==(p=b)?void 0:p.get("customerRewards"),w=!!m.default.isEmpty(R);if(i)return(P=(0,d.AjaxQueryRunner)()).initClient(v.config.get("apiBaseUrl"),(function(e){var t,r;return e.headers=Object.assign({},e.headers,{"x-shopify-app-id":null!=(t=null==(r=v.config)?void 0:r.get("appId"))?t:"","Content-Type":"application/json"}),e})),{modelUpdates:[{selector:[v.get("id"),"queryRunner"],newValue:P}]};if(!m.default.isEmpty(P)&&null!=I&&null!=(c=I.loggedInUserAccessToken)&&c.accessToken&&null!=I&&null!=(f=I.loggedInUser)&&f.id&&w){var _,O,S,A={customerId:null!=I&&null!=(_=I.loggedInUser)&&_.id?parseInt(null==I||null==(O=I.loggedInUser)?void 0:O.id.split("/").pop()):0,customerEmail:null==I||null==(S=I.loggedInUser)?void 0:S.email};console.log("STAMPED FETCH REWARDS",A),yield(0,l.spawn)((function*(){try{h=e.stageModel.getModelValue([]),b=h.get(v.get("id"));var t=(yield(0,l.call)(T,b,v,"GetCustomerRewards",A)).data;console.log("STAMPED Data",t),yield(0,l.put)((0,d.modelUpdateAction)([{selector:[v.get("id"),"customerRewards"],newValue:t}]))}catch(e){console.log("Error fetching STAMPED REWARDS",e)}})),console.log("STAMPED FETCH WISHLIST")}},get onPluginUpdate(){return this._onPluginUpdate},set onPluginUpdate(e){this._onPluginUpdate=e},getQueries:function(){return I},getQueryInputParams:function(e){var t=I&&I[e]?I[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.publicKey,n=e.privateKey,a=e.storeHash,i=e.storeUrl;return!!(t&&r&&n&&a&&i)&&{apiBaseUrl:t,publicKey:r,privateKey:n,storeHash:a,storeUrl:i}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","publicKey","privateKey","storeHash","storeUrl"]},getPlatformIdentifier:function(){return"stamped"},runQuery:function*(e,t,r,n,a,i){var o=I[n];if(o)return yield w(e,t,r,o,a,i)},options:{propertySettings:P,pluginListing:{labelPrefix:"stamped",type:"datasource",name:"Stamped Integration",description:"Stamped Integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:R})},3147:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformGetRewards=t.TransformGetReviewsV1=t.TransformGetReviews=t.TransformCreateReviews=t.TransformCreateProductReviewBadge=void 0;var a=n(r(7128)),i=n(r(3216)),o=["points_current_with_name"],s=["data"];t.TransformGetRewards=function(e){var t=e.customer,r=e.points,n=e.campaigns,s=n.earnings,u=n.vip_tiers,l=n.spendings,d=r.points_current_with_name,p=(0,a.default)(r,o);return{data:{customer:i.default.pick(t,["customerId","customerEmail","customerFirstName","customerLastName","vipTierTitle","vipTierId","totalOrders","totalSpent"]),points:Object.assign({},p,{pointsCurrentWithName:d}),vipTiers:u&&u.length>0?i.default.map(u,(function(e){return t=e,i.default.pick(t,["id","title","description","titlePublic","isCompleted","totalCount","campaignEventString","pointsFullName","urlImage","points","isSystem","isActive","isEnabledNotifications","dateCreated","pointsMultiplier","goalValue","listBenefits","listRewards"]);var t})):[],earnings:s&&s.length>0?i.default.map(s,(function(e){return function(e){return i.default.pick(e,["id","title","description","titlePublic","isCompleted","totalCount","campaignEventString","pointsFullName","urlImage","points","isSystem","isActive","isEnabledNotifications","dateCreated","pointsMultiplier"])}(e)})):[],spending:l&&l.length>0?i.default.map(l,(function(e){return function(e){return i.default.pick(e,["campaignEvent","isCompleted","totalCount","campaignEventString","pointsFullName","id","title","titlePublic","description","urlImage","points","isSystem","isActive","isEnabledNotifications","dateCreated","campaignRulesList"])}(e)})):[]},hasNextPage:!1,paginationMeta:{}}},t.TransformGetReviews=function(e){var t,r=e.data,n=(0,a.default)(e,s);return{data:Object.assign({reviews:r&&0!==r.length&&r.map((function(e){return i.default.pick(e,["id","author","reviewTitle","reviewMessage","reviewRating","reviewDate","reviewUserPhotos","reviewUserVideos","reviewVerifiedType","reviewReply","reviewReplyDate","productId","productName","productSKU","productUrl","productImageUrl","productImageLargeUrl","productImageThumbnailUrl","productDescription","avatar","location","reviewVotesUp","reviewVotesDown","userReference","dateCreated","dateReplied","reviewType","widgetType","reviewOptionsList"])}))},n),hasNextPage:0!==(null==(t=e.data)?void 0:t.length),paginationMeta:{after:e.page}}},t.TransformGetReviewsV1=function(e){return{data:e.data.map((function(e){return i.default.pick(e,["id","author","reviewTitle","reviewMessage","reviewRating","reviewDate","reviewUserPhotos","reviewUserVideos","reviewVerifiedType","reviewReply","reviewReplyDate","productId","productName","productSKU","productUrl","productImageUrl","productImageLargeUrl","productImageThumbnailUrl","productDescription","avatar","location","reviewVotesUp","reviewVotesDown","userReference","dateCreated","dateReplied","reviewType","widgetType","reviewOptionsList"])})),hasNextPage:0!==e.data.length,paginationMeta:{after:e.page}}},t.TransformCreateReviews=function(e){return{data:i.default.pick(e,["id"]),hasNextPage:!1,paginationMeta:{}}},t.TransformCreateProductReviewBadge=function(e){return{data:e&&0!==e.length&&e.map((function(e){return i.default.pick(e,["productId","rating","count","countQuestions","c","badge","badgeqna"])})),hasNextPage:!1,paginationMeta:{}}}},1137:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.generateHmac=void 0;var a=n(r(6708));t.generateHmac=function(e,t){return(0,a.default)(e,t)}},1689:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StampedEditors=void 0;var a=n(r(5990)),i=n(r(7488)),o=n(r(7128)),s=r(804),u=r(892),l=r(1653),d=n(r(827)),p=r(4374),c=["publicKey","storeUrl","after"],f=["publicKey","storeUrl","after"],g={isPaginated:!1,contextInputParams:{apiBaseUrl:"",publicKey:"",privateKey:"",storeHash:"",storeUrl:"",headers:{}},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},m={GetCustomerReviews:Object.assign({},g,{queryType:"get",endpoint:"/widget/reviews",endpointResolver:function(e,t,r){var n=t.publicKey,a=t.storeUrl,i=t.after,s=(0,o.default)(t,c),u=Object.assign({storeUrl:a,apiKey:n},s);return r&&(u.page=i?i+1:1),`${e}${(0,l.jsonToQueryString)(u)}`},transformer:p.TransformGetReviews,isPaginated:!0,editableInputParams:{productId:"",sortReviews:"",minRating:0,take:2},checkInputVariabes:function(e){return!!e.productId}}),GetCustomerReviewsV1:Object.assign({},g,{queryType:"get",endpoint:"/widget/reviews",endpointResolver:function(e,t,r){var n=t.publicKey,a=t.storeUrl,i=t.after,s=(0,o.default)(t,f),u=Object.assign({storeUrl:a,apiKey:n},s);return r&&(u.page=i?i+1:1),`${e}${(0,l.jsonToQueryString)(u)}`},transformer:p.TransformGetReviewsV1,isPaginated:!0,editableInputParams:{productId:"",sortReviews:"",minRating:0,take:2},checkInputVariabes:function(e){return!!e.productId}}),CreateCustomerReviews:Object.assign({},g,{queryType:"post",endpoint:"/reviews3",endpointResolver:function(e,t){var r=t.publicKey,n={sId:t.storeHash,apiKey:r};return`${e}${(0,l.jsonToQueryString)(n)}`},headers:{"Content-Type":"application/x-www-form-urlencoded"},transformer:p.TransformCreateReviews,inputResolver:function(e,t){return{productId:e.productId,author:e.author,email:e.email,location:e.location,reviewRating:e.reviewRating,reviewTitle:e.reviewTitle,reviewMessage:e.reviewMessage,reviewRecommendProduct:e.reviewRecommendProduct,productName:e.productName,productSKU:e.productSKU,productImageUrl:e.productImageUrl,productUrl:e.productUrl,reviewSource:e.reviewSource}},editableInputParams:{productId:"",author:"",email:"",location:"",reviewRating:"",reviewTitle:"",reviewMessage:"",reviewRecommendProduct:"",productName:"",productSKU:"",productImageUrl:"",productUrl:"",reviewSource:""}}),CreateProductReviewBadge:Object.assign({},g,{queryType:"post",endpoint:"/widget/badges",endpointResolver:function(e,t){return`${e}${(0,l.jsonToQueryString)({isIncludeBreakdown:"true",isincludehtml:"true"})}`},transformer:p.TransformCreateProductReviewBadge,inputResolver:function(e,t){var r=e.productIds,n=t.publicKey,a=t.storeUrl;return{productIds:r.map((function(e){return{productId:e}})),apiKey:n,storeUrl:a}},editableInputParams:{productIds:""},checkInputVariabes:function(e){return!!e.productIds}})},y=t.StampedEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://api-v3.Stamped.io"}},{type:"codeInput",name:"publicKey",props:{label:"Stamped Public Key",placeholder:""}},{type:"codeInput",name:"privateKey",props:{label:"Stamped Private Key",placeholder:""}},{type:"codeInput",name:"storeHash",props:{label:"Stamped Store Hash",placeholder:""}},{type:"codeInput",name:"storeUrl",props:{label:"Stamped Store URL",placeholder:""}}]};t.default=(0,d.default)({name:"stampedReviews",config:{apiBaseUrl:"https://api-v3.Stamped.io",publicKey:"",privateKey:"",storeHash:"",storeUrl:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,u.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){var t,n=null!=(t=null==r?void 0:r.get("authHeaders"))?t:{};return e.headers=Object.assign({},e.headers,n),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return m},getQueryInputParams:function(e){var t=m&&m[e]?m[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.publicKey,n=e.privateKey,a=e.storeHash,i=e.storeUrl;return!!(t&&r&&n&&a&&i)&&{apiBaseUrl:t,publicKey:r,privateKey:n,storeHash:a,storeUrl:i}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","publicKey","privateKey","storeHash","storeUrl"]},getPlatformIdentifier:function(){return"stampedReviews"},runQuery:function*(e,t,r,n,o,u){var l,d=m[n];if(d){var p,c,f=u.getNextPage,g=u.paginationMeta,y=null!=d?d:{},v=y.endpointResolver,h=y.endpoint,b=(l=y.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(l).reduce((function(e,n){var o=(0,i.default)(n,2),s=o[0];return o[1],r&&r.get(s)?Object.assign({},e,(0,a.default)({},s,r.get(s))):t&&t.get(s)?Object.assign({},e,(0,a.default)({},s,t.get(s))):e}),{})}),I=b(t,r),P=!0;d&&d.editableInputParams&&(p=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return t&&void 0!==t[o]?"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e:e}),{})}(o,d.editableInputParams),null!=d&&d.checkInputVariabes&&(P=d.checkInputVariabes(p))),null!=d&&d.isPaginated&&d.paginationResolver&&f&&(p=d.paginationResolver(p,g)),c=d.inputResolver?d.inputResolver(p,I):p,h=v&&v(h,Object.assign({},I,c),f);var R,w=r.get("queryRunner");if(P)try{R=yield(0,s.call)(w.runQuery,d.queryType,h,c,Object.assign({},u,{headers:Object.assign({},d.headers)}))}catch(e){logger.error("error",e)}else R={errors:{message:"Missing input variables"},data:null};var T,_,O=R&&R.data?R.data:{},S=O;if(d&&d.transformer){var A=d.transformer(O);S=A.data,T=A.hasNextPage,_=A.paginationMeta}return yield{rawData:O,data:S,hasNextPage:T,paginationMeta:_,errors:[],hasError:!1}}},options:{propertySettings:{},pluginListing:{labelPrefix:"stampedReviews",type:"datasource",name:"Stamped Reviews Integration",description:"Stamped Reviews Integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:y})},4374:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformGetReviewsV1=t.TransformGetReviews=t.TransformCreateReviews=t.TransformCreateProductReviewBadge=void 0;var a=n(r(7128)),i=n(r(3216)),o=["data"];t.TransformGetReviews=function(e){var t=e.data,r=(0,a.default)(e,o);return{data:Object.assign({reviews:t&&0!==t.length&&t.map((function(e){return i.default.pick(e,["id","author","reviewTitle","reviewMessage","reviewRating","reviewDate","reviewUserPhotos","reviewUserVideos","reviewVerifiedType","reviewReply","reviewReplyDate","productId","productName","productSKU","productUrl","productImageUrl","productImageLargeUrl","productImageThumbnailUrl","productDescription","avatar","location","reviewVotesUp","reviewVotesDown","userReference","dateCreated","dateReplied","reviewType","widgetType","reviewOptionsList"])}))},r),hasNextPage:0!==e.data.length,paginationMeta:{after:e.page}}},t.TransformGetReviewsV1=function(e){return{data:e.data.map((function(e){return i.default.pick(e,["id","author","reviewTitle","reviewMessage","reviewRating","reviewDate","reviewUserPhotos","reviewUserVideos","reviewVerifiedType","reviewReply","reviewReplyDate","productId","productName","productSKU","productUrl","productImageUrl","productImageLargeUrl","productImageThumbnailUrl","productDescription","avatar","location","reviewVotesUp","reviewVotesDown","userReference","dateCreated","dateReplied","reviewType","widgetType","reviewOptionsList"])})),hasNextPage:0!==e.data.length,paginationMeta:{after:e.page}}},t.TransformCreateReviews=function(e){return{data:i.default.pick(e,["id"]),hasNextPage:!1,paginationMeta:{}}},t.TransformCreateProductReviewBadge=function(e){return{data:e&&0!==e.length&&e.map((function(e){return i.default.pick(e,["productId","rating","count","countQuestions","c","badge","badgeqna"])})),hasNextPage:!1,paginationMeta:{}}}},1948:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.StampedEditors=void 0;var a=n(r(5990)),i=n(r(7488)),o=r(804),s=r(892),u=r(1653),l=n(r(827)),d=r(2179),p=r(9225),c={isPaginated:!1,contextInputParams:{apiBaseUrl:"",publicKey:"",privateKey:"",storeHash:"",storeUrl:"",headers:{}},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},f={GetCustomerRewards:Object.assign({},c,{queryType:"post",endpoint:"/v2/rewards/init",endpointResolver:function(e,t){var r={apiKey:t.publicKey,sId:t.storeHash};return`${e}${(0,u.jsonToQueryString)(r)}`},inputResolver:function(e,t){var r=t.privateKey,n=e.customerId,a=e.customerEmail;return{customerId:n,customerEmail:a,authToken:(0,p.generateHmac)(n+a,r).toString()}},transformer:d.TransformGetRewards,editableInputParams:{customerId:"",customerEmail:""}})},g=t.StampedEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://api-v3.Stamped.io"}},{type:"codeInput",name:"publicKey",props:{label:"Stamped Public Key",placeholder:""}},{type:"codeInput",name:"privateKey",props:{label:"Stamped Private Key",placeholder:""}},{type:"codeInput",name:"storeHash",props:{label:"Stamped Store Hash",placeholder:""}},{type:"codeInput",name:"storeUrl",props:{label:"Stamped Store URL",placeholder:""}}]};t.default=(0,l.default)({name:"stampedRewards",config:{apiBaseUrl:"https://api-v3.Stamped.io",publicKey:"",privateKey:"",storeHash:"",storeUrl:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,s.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){var t,n=null!=(t=null==r?void 0:r.get("authHeaders"))?t:{};return e.headers=Object.assign({},e.headers,n),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.publicKey,n=e.privateKey,a=e.storeHash,i=e.storeUrl;return!!(t&&r&&n&&a&&i)&&{apiBaseUrl:t,publicKey:r,privateKey:n,storeHash:a,storeUrl:i}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","publicKey","privateKey","storeHash","storeUrl"]},getPlatformIdentifier:function(){return"stampedRewards"},runQuery:function*(e,t,r,n,s,u){var l,d=f[n];if(d){var p,c,g=u.getNextPage,m=u.paginationMeta,y=null!=d?d:{},v=y.endpointResolver,h=y.endpoint,b=(l=y.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(l).reduce((function(e,n){var o=(0,i.default)(n,2),s=o[0];return o[1],r&&r.get(s)?Object.assign({},e,(0,a.default)({},s,r.get(s))):t&&t.get(s)?Object.assign({},e,(0,a.default)({},s,t.get(s))):e}),{})}),I=b(t,r),P=!0;d&&d.editableInputParams&&(p=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return t&&void 0!==t[o]?"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e:e}),{})}(s,d.editableInputParams),null!=d&&d.checkInputVariabes&&(P=d.checkInputVariabes(p))),null!=d&&d.isPaginated&&d.paginationResolver&&g&&(p=d.paginationResolver(p,m)),c=d.inputResolver?d.inputResolver(p,I):p,h=v&&v(h,Object.assign({},I,c),g);var R,w=r.get("queryRunner");if(P)try{R=yield(0,o.call)(w.runQuery,d.queryType,h,c,Object.assign({},u,{headers:Object.assign({},d.headers)}))}catch(e){logger.error("error",e)}else R={errors:{message:"Missing input variables"},data:null};var T,_,O=R&&R.data?R.data:{},S=O;if(d&&d.transformer){var A=d.transformer(O);S=A.data,T=A.hasNextPage,_=A.paginationMeta}return yield{rawData:O,data:S,hasNextPage:T,paginationMeta:_,errors:[],hasError:!1}}},options:{propertySettings:{},pluginListing:{labelPrefix:"stampedRewards",type:"datasource",name:"Stamped Rewards Integration",description:"Stamped Rewards Integration.",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g})},2179:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.TransformGetRewards=void 0;var a=n(r(7128)),i=n(r(3216)),o=["points_current_with_name"];t.TransformGetRewards=function(e){var t=e.customer,r=e.points,n=e.campaigns,s=n.earnings,u=n.vip_tiers,l=n.spendings,d=r.points_current_with_name,p=(0,a.default)(r,o);return{data:{customer:i.default.pick(t,["customerId","customerEmail","customerFirstName","customerLastName","vipTierTitle","vipTierId","totalOrders","totalSpent"]),points:Object.assign({},p,{pointsCurrentWithName:d}),vipTiers:u&&u.length>0?i.default.map(u,(function(e){return t=e,i.default.pick(t,["id","title","description","titlePublic","isCompleted","totalCount","campaignEventString","pointsFullName","urlImage","points","isSystem","isActive","isEnabledNotifications","dateCreated","pointsMultiplier","goalValue","listBenefits","listRewards"]);var t})):[],earnings:s&&s.length>0?i.default.map(s,(function(e){return function(e){return i.default.pick(e,["id","title","description","titlePublic","isCompleted","totalCount","campaignEventString","pointsFullName","urlImage","points","isSystem","isActive","isEnabledNotifications","dateCreated","pointsMultiplier"])}(e)})):[],spending:l&&l.length>0?i.default.map(l,(function(e){return function(e){return i.default.pick(e,["campaignEvent","isCompleted","totalCount","campaignEventString","pointsFullName","id","title","titlePublic","description","urlImage","points","isSystem","isActive","isEnabledNotifications","dateCreated","campaignRulesList"])}(e)})):[]},hasNextPage:!1,paginationMeta:{}}}},9225:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.generateHmac=void 0;var a=n(r(6708));t.generateHmac=function(e,t){return(0,a.default)(e,t)}},8860:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.storifyMeEditors=t.storifyMeApiRecords=t.executeQuery=t.default=void 0;var a,i=n(r(2766)),o=r(892),s=n(r(827)),u=t.storifyMeApiRecords={},l=t.storifyMeEditors={basic:[{type:"codeInput",name:"accountId",props:{label:"Account Id"}},{type:"codeInput",name:"apiKey",props:{label:"API Key"}},{type:"codeInput",name:"env",props:{label:"Env (EU/US)"}}]};t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:void 0,errors:[],hasError:!1}})),function(e,t,r,n,i,o){return a.apply(this,arguments)}),t.default=(0,s.default)({name:"storifyMe",config:Object.assign({},o.baseDatasourceConfig,{accountId:"",apiKey:"",env:""}),initDatasource:function*(e,t,r){},getQueries:function(){return u},getQueryInputParams:function(e){var t=u&&u[e]?u[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.accountId,r=e.apiKey,n=e.env;return!!(t&&r&&n)&&{accountId:t,apiKey:r,env:n}},resolveClearCredentialConfigs:function(){return["accountId","apiKey","env"]},getPlatformIdentifier:function(){return"storifyMe"},runQuery:function*(e,t,r,n,a,i){},options:{propertySettings:{},pluginListing:{labelPrefix:"storifyMe",type:"datasource",name:"StorifyMe Integration",description:"StorifyMe Widgets integration",section:"Integrations",icon:"datasource"}},editors:l})},1729:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n(r(2766)),i=n(r(3664)),o=n(r(2584)),s=r(892),u=r(1928),l=r(6616),d=new((0,i.default)((function e(){var t,r,n=this;(0,o.default)(this,e),this.fetchProductsImagesWithIds=(t=(0,a.default)((function*(e,t,r,a,i,o,u){var l=i.productIds,d=i.groupId,p=(null==r?void 0:r.get("productGroupCache"))||{},c=n.generateQuery(l);try{var f=yield n.queryExecutor(o,u,r,{gqlTag:c},{}),g={groupId:d,productIds:l,images:Object.values(f.transformedData).filter((function(e){return!!e})).map((function(e){var t,r,n;return{id:e.id,handle:e.handle,image:null==(t=e.variants)||null==(r=t.nodes)||null==(n=r[0])?void 0:n.image,featuredImage:e.featuredImage}}))};p[d]=g;var m=[{selector:a.concat(["productGroupCache"]),newValue:p}];e((0,s.modelUpdateAction)(m,void 0,!0))}catch(e){console.error("Error fetching product images:",e)}})),function(e,r,n,a,i,o,s){return t.apply(this,arguments)}),this.queryExecutor=(r=(0,a.default)((function*(e,t,r,n,a){var i=null==t?void 0:t.getModelValue(["shopify"]),o=null==i?void 0:i.get("queryRunner"),s=null==i?void 0:i.get("shop");if(!o)throw new Error("Query runner not available.");var l=yield o.runQuery("query",n.gqlTag,{},{});return(0,u.processShopifyGraphqlQueryResponse)(l,n,s,r)})),function(e,t,n,a,i){return r.apply(this,arguments)}),this.generateQuery=function(e){var t=e.map((function(e,t){return`product${t}: product(id: "gid://shopify/Product/${e}") {\n      id\n      handle\n      featuredImage {\n        altText\n        height\n        id\n        originalSrc\n        src\n        transformedSrc\n        url (transform: {maxWidth: 480, maxHeight: 480})\n        width\n      }\n      variants(first: 1) {\n        nodes {\n          image {\n            altText\n            height\n            id\n            originalSrc\n            src\n            transformedSrc\n            url (transform: {maxWidth: 480, maxHeight: 480})\n            width\n          }\n        }\n      }\n    }`})).join("\n");return l.gql`query Product {
      ${t}
    }`}})));t.default=d},5301:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.swatchKingEditors=t.default=void 0;var a=r(892),i=n(r(827)),o=n(r(1729)),s={fetchProductsImagesWithIds:{type:a.TriggerActionIdentifier,getValue:function(e,t,r){return o.default.fetchProductsImagesWithIds},actionMetadata:{editableInputParams:{productIds:"{{[]}}",groupId:""}}}},u=t.swatchKingEditors={basic:[]};t.default=(0,i.default)({name:"swatchKing",config:Object.assign({},a.baseDatasourceConfig,{fetchProductsImagesWithIds:"action",productGroupCache:""}),resolveCredentialConfigs:function(){return{}},getQueries:function(){return{}},getQueryInputParams:function(){return{}},getPlatformIdentifier:function(){return"swatchKing"},initDatasource:function*(e,t,r){},onPluginUpdate:function*(e,t,r,n,a,i,o){},options:{propertySettings:s,pluginListing:{labelPrefix:"swatchKing",type:"datasource",name:"Swatch King",description:"Swatch King Description",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:u})},805:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.TokiRewardsEditors=void 0;var a,i=n(r(5990)),o=n(r(7488)),s=n(r(2766)),u=r(804),l=r(892),d=n(r(827)),p=n(r(8352)),c={getUserAuthToken:{queryType:"get",endpoint:"/users",endpointResolver:function(e,t){return`${e}/${null==t?void 0:t.userId}/auth-token`},editableInputParams:{userId:""},isPaginated:!1},getUserByEmail:{queryType:"get",endpoint:"/users",endpointResolver:function(e,t){return`${e}?email=${t.email}`},editableInputParams:{email:""},isPaginated:!1}},f=t.TokiRewardsEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:""}},{type:"codeInput",name:"apiToken",props:{label:"apiToken",placeholder:""}}]},g={getReferralLink:{type:l.TriggerActionIdentifier,getValue:function(e,t,r){return n=(0,s.default)((function*(e,t,r,n,a){var i=a.shop_domain,o=a.mail,s=a.address;if(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o))try{e((0,l.modelUpdateAction)([{selector:n.concat(["loading"]),newValue:!0}],void 0,!0));var u=yield p.default.get(`https://api.buildwithtoki.com/integrations/shopify/referAFriend?shop_domain=${i}&mail=${o}&address=${s}`);e((0,l.modelUpdateAction)([{selector:n.concat(["referralLink"]),newValue:u.data.link}],void 0,!0))}catch(e){console.error(e),toast.show("Cannot generate referral link",{type:"error",placement:"bottom"})}finally{e((0,l.modelUpdateAction)([{selector:n.concat(["loading"]),newValue:!1}],void 0,!0))}else toast.show("Invalid email address",{type:"error",placement:"bottom"})})),function(e,t,r,a,i){return n.apply(this,arguments)};var n},actionMetadata:{editableInputParams:{shop_domain:"",mail:"",address:""}}}},m=t.executeQuery=(a=(0,s.default)((function*(e,t,r,n,a,s){try{if(!n)throw new Error("Invalid Query");var u,l=null!=s?s:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(U=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(U).reduce((function(e,n){var a=(0,o.default)(n,2),s=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,i.default)({},s,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,i.default)({},s,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,o.default)(r,2),a=n[0],s=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,i.default)({},a,isNaN(s)&&typeof s==typeof t[a]?s:parseInt(s))):s?Object.assign({},e,(0,i.default)({},a,s)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariables&&(m=n.checkInputVariables(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,f,p));var v,h=r.get("queryRunner"),b=r.get("apiToken");if(!b)throw new Error("Missing apiToken");var I,P,R=(v=m?yield h.runQuery(n.queryType,y,Object.assign({},g,u),{headers:{Authorization:`Bearer ${b}`}}):{errors:{message:"Missing input variables"},data:null})&&v.data?v.data:{},w=R;if(n&&n.transformer){var T=n.transformer(R,p),_=T.data,O=T.hasNextPage,S=T.paginationMeta;w=_,I=O,P=S}return{rawData:R,data:w,hasNextPage:I,paginationMeta:P}}catch(e){var A,C;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(A=e.request)&&A.response?new Error(JSON.parse(null==e||null==(C=e.request)?void 0:C.response).message):e],hasError:!0}}var U})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"tokiRewards",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://api.buildwithtoki.com/external",queryRunner:"queryrunner",loading:"false",referralLink:"",getReferralLink:"action"}),initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl");return n.initClient(a,(function(e){return e.headers=Object.assign({},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return c},getQueryInputParams:function(e){var t=c&&c[e]?c[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"tokiRewards"},runQuery:function*(e,t,r,n,a,i){var o=c[n];if(o)return yield(0,u.call)(m,e,t,r,o,a,i)},options:{propertySettings:g,pluginListing:{labelPrefix:"tokiRewards",type:"datasource",name:"Toki Rewards",description:"Toki Rewards",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:f})},3876:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.tryWithMirraEditors=t.tryWithMirraApiRecords=t.executeQuery=t.default=void 0;var a,i=n(r(2766)),o=r(892),s=n(r(827)),u=t.tryWithMirraApiRecords={},l={addToCart:{type:o.TriggerActionIdentifier,getValue:function(e,t,r){return n=(0,i.default)((function*(e,t,r,n,a,i,s){var u=null==r?void 0:r.get("shopifyDS"),l=i.getPlugin("shopify"),d=null==s?void 0:s.getModelValue(["shopify"]),p=u.increaseCartLineItemQuantity;try{e((0,o.modelUpdateAction)([{selector:n.concat(["syncing"]),newValue:!0}],void 0,!0)),yield p(e,l,d,["shopify"],Object.assign({},a))}catch(e){console.log("Cannot add item to cart",e)}finally{e((0,o.modelUpdateAction)([{selector:n.concat(["syncing"]),newValue:!1}],void 0,!0))}})),function(e,t,r,a,i,o,s){return n.apply(this,arguments)};var n},actionMetadata:{editableInputParams:{merchandiseId:"",quantity:"{{1}}",syncWithShopify:"{{false}}",sellingPlanId:"",attributes:"",itemPrice:"",successToastText:"Item added successfully!"}}}},d=t.tryWithMirraEditors={basic:[{type:"codeInput",name:"limit",props:{label:"Limit",placeholder:"0"}}]};t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:void 0,errors:[],hasError:!1}})),function(e,t,r,n,i,o){return a.apply(this,arguments)}),t.default=(0,s.default)({name:"tryWithMirra",config:Object.assign({},o.baseDatasourceConfig,{limit:"",shopifyDS:"{{shopify}}",syncing:"false",addToCart:"action"}),initDatasource:function*(e,t,r){},getQueries:function(){return u},getQueryInputParams:function(e){var t=u&&u[e]?u[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"tryWithMirra"},runQuery:function*(e,t,r,n,a,i){},options:{propertySettings:l,pluginListing:{labelPrefix:"tryWithMirra",type:"datasource",name:"TryWithMirra",description:"TryWithMirra Widgets integration",section:"Integrations",icon:"datasource"}},editors:d})},7028:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.wizzySearchDatasourcePropertySettings=t.wizzySearchDatasourcePluginConfig=t.default=void 0;var a,i=n(r(2766)),o=n(r(2584)),s=n(r(3664)),u=r(892),l=r(6621),d=(t.wizzySearchDatasourcePluginConfig={getSuggestions:u.TriggerActionIdentifier,clearSuggestions:u.TriggerActionIdentifier,predictions:{}},t.wizzySearchDatasourcePropertySettings={getSuggestions:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.getSuggestions},actionMetadata:{editableInputParams:{q:"",currency:"",suggestionsCount:"",includeOutOfStock:"",getAllVariants:"",minQueryLength:"",productsCount:"",sections:"",sort:""}}},clearSuggestions:{type:u.TriggerActionIdentifier,getValue:function(e,t,r){return d.clearSuggestions}}},new((0,s.default)((function e(){var t,r,n=this;(0,o.default)(this,e),this.getSuggestions=(t=(0,i.default)((function*(e,t,r,a,i){var o=[],s=(yield n.queryExecutor(r,t,"getSuggestion",Object.assign({},i))).data;return console.log("data",s),o.push({selector:a.concat(["predictions"]),newValue:s}),e((0,u.modelUpdateAction)(o,void 0,!0))})),function(e,r,n,a,i){return t.apply(this,arguments)}),this.clearSuggestions=(r=(0,i.default)((function*(e,t,r,n,a){var i=[];return i.push({selector:n.concat(["predictions"]),newValue:null}),e((0,u.modelUpdateAction)(i,void 0,!0))})),function(e,t,n,a,i){return r.apply(this,arguments)})}),[{key:"queryExecutor",value:(a=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,u.GetRegisteredPlugin)(a),o=this.getQueries()[r];return yield(0,l.executeQuery)(i,t,e,o,Object.assign({},n),{})})),function(e,t,r,n){return a.apply(this,arguments)})},{key:"getQueries",value:function(){var e,t=(0,u.GetRegisteredPluginInfo)("wizzySearch");return null==t||null==(e=t.plugin)?void 0:e.getQueries()}}])));t.default=d},6621:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.WizzySearchEditors=void 0;var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(7028),c=r(4402),f={getSuggestion:{queryType:"post",endpoint:"/autocomplete",endpointResolver:function(e,t){return e},editableInputParams:{q:"",currency:"",suggestionsCount:"",includeOutOfStock:"",getAllVariants:"",minQueryLength:"",productsCount:"",sections:"",sort:""},transformer:c.WizzySearchGetSuggestionsTransformer,isPaginated:!1,headerType:"application/x-www-form-urlencoded"},getFilters:{queryType:"post",endpoint:"/products/filter",endpointResolver:function(e,t){return e},transformer:c.WizzySearchGetFilterTransformer,editableInputParams:{filters:"",group:""},isPaginated:!0,paginationResolver:function(e,t){var r=JSON.parse(e.filters),n=Object.assign({},r,{page:t+1});return Object.assign({},e,{filters:JSON.stringify(n)})},headerType:"application/json"},searchProducts:{queryType:"post",endpoint:"/products/search",endpointResolver:function(e,t,r,n){return n?"/products/filter":e},transformer:c.WizzySearchGetProductsTransformer,paginationResolver:function(e,t){var r=t,n=Object.assign({},r,{page:t.page+1});return{group:"page",filters:JSON.stringify(n)}},isPaginated:!0,editableInputParams:{q:"",currency:"",includeOutOfStock:"",getAllVariants:"",productsCount:"",facets:"",swatch:"",minQueryLength:"",sort:""}}},g=Object.assign({},p.wizzySearchDatasourcePropertySettings),m=t.WizzySearchEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"apiBaseUrl",placeholder:""}},{type:"codeInput",name:"x-store-id",props:{label:"x-store-id",placeholder:""}},{type:"codeInput",name:"x-api-key",props:{label:"x-api-key",placeholder:""}}]},y=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a,i){try{if(!n)throw new Error("Invalid Query");var u,l=null!=i?i:{},d=l.getNextPage,p=l.paginationMeta;if(n&&n.contextInputParams){var c=(j=n.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(j).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0],u=a[1];return r&&r.get(u)?Object.assign({},e,(0,o.default)({},i,r.get(u))):t&&t.get(u)?Object.assign({},e,(0,o.default)({},i,t.get(u))):e}),{})});u=c(t,r)}var f,g,m=!0;n&&n.editableInputParams&&(f=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(m=n.checkInputVariabes(f))),null!=n&&n.isPaginated&&n.paginationResolver&&d&&(f=n.paginationResolver(f,p)),g=n.inputResolver?n.inputResolver(f):f;var y=n.endpoint;n.endpointResolver&&(y=n.endpointResolver(y,f,p,d));var v=r.get("x-store-id"),h=r.get("x-api-key");if(!v||!h)throw new Error("StoreId or API Key is missing");var b,I,P,R=r.get("queryRunner"),w=(b=m?yield R.runQuery(n.queryType,y,Object.assign({},g,u),{headers:{"x-store-id":v,"x-api-key":h,"Content-Type":(null==n?void 0:n.headerType)||"application/json"}}):{errors:{message:"Missing input variables"},data:null})&&b.data?b.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w,p),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,I=S,P=A}return{rawData:w,data:T,hasNextPage:I,paginationMeta:P}}catch(e){var C,U;return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[null!=e&&null!=(C=e.request)&&C.response?new Error(JSON.parse(null==e||null==(U=e.request)?void 0:U.response).message):e],hasError:!0}}var j})),function(e,t,r,n,i,o){return a.apply(this,arguments)});t.default=(0,d.default)({name:"wizzySearch",config:Object.assign({},l.baseDatasourceConfig,{apiBaseUrl:"https://api.wizzy.ai/v1",queryRunner:"queryrunner"},p.wizzySearchDatasourcePluginConfig),initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl");return n.initClient(a,(function(e){return e.headers=Object.assign({},e.headers),e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return t&&null!=t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"wizzySearch"},runQuery:function*(e,t,r,n,a,i){var o=f[n];if(o)return yield(0,u.call)(y,e,t,r,o,a,i)},options:{propertySettings:g,pluginListing:{labelPrefix:"wizzySearch",type:"datasource",name:"Wizzy Search",description:"Wizzy Search AutoComplete",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:m})},4402:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WizzySearchGetSuggestionsTransformer=t.WizzySearchGetProductsTransformer=t.WizzySearchGetFilterTransformer=void 0,t.WizzySearchGetSuggestionsTransformer=function(e){if(e){var t,r,n=e.payload,a={categories:null,searchSuggestions:null,products:null};return null!=n&&n.categories&&(a.categories=null==n?void 0:n.categories.map((function(e){var t;return{title:e.value,collectionHandle:(null==e||null==(t=e.filters)?void 0:t.categories.length)>0?e.filters.categories[0]:null}}))),null!=n&&n.others&&(a.searchSuggestions=null==n||null==(t=n.others)?void 0:t.map((function(e){return{title:null==e?void 0:e.value}}))),null!=n&&n.products&&(a.products=null==n||null==(r=n.products.result)?void 0:r.map((function(e){var t,r;return{title:e.name,image:e.mainImage,productHandle:null==e||null==(t=e.attributes)||null==(r=t.find((function(e){return"product_handle"===(null==e?void 0:e.id)})))?void 0:r.values[0].value[0]}}))),{data:a}}},t.WizzySearchGetFilterTransformer=function(e){var t,r,n,a,i;if(e){var o=(null==e?void 0:e.payload).result;if(o){var s=(null==e||null==(t=e.payload)?void 0:t.pages)-(null==e||null==(r=e.payload)||null==(n=r.filters)?void 0:n.page),u=null==e||null==(a=e.payload)||null==(i=a.filters)?void 0:i.page;return{data:null==o?void 0:o.map((function(e){var t,r,n=null==e||null==(t=e.attributes)||null==(r=t.find((function(e){return"product_handle"===(null==e?void 0:e.id)})))?void 0:r.values[0].value[0];return{name:e.name,image:e.mainImage,originalPrice:e.price,sellingPrice:e.sellingPrice,discountPercentage:e.discountPercentage,productHandle:n}})),hasNextPage:!!s,paginationMeta:u}}}},t.WizzySearchGetProductsTransformer=function(e){var t;if(e||null!=e&&null!=(t=e.payload)&&t.result)return{data:e.payload.result.map((function(e){var t,r,n=null==e||null==(t=e.attributes)?void 0:t.find((function(e){return"product_handle"===(null==e?void 0:e.id)}));try{r=null==n?void 0:n.values[0].value[0]}catch(e){logger.error("Error in getting handle from wizzy search")}return{discountPercentage:null==e?void 0:e.discountPercentage,finalPrice:null==e?void 0:e.finalPrice,discountPrice:null==e?void 0:e.discount,originalPrice:null==e?void 0:e.price,sellingPrice:null==e?void 0:e.sellingPrice,image:null==e?void 0:e.mainImage,name:null==e?void 0:e.name,url:null==e?void 0:e.url,inStock:null==e?void 0:e.inStock,productHandle:r}}))}}},7662:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.YagiCancellableEditor=void 0;var a=n(r(5990)),i=n(r(7488)),o=r(804),s=n(r(827)),u=r(892),l=r(6352),d={checkOrderCancellable:{queryType:"get",endpoint:"/api/shops",endpointResolver:function(e,t){return`${e}/${t.shopDomain}?order=${t.orderId}`},contextInputParams:{shopDomain:""},editableInputParams:{orderId:""},transformer:r(8708).transformGetOrderCancellableCheckQueryData},cancelOrder:{queryType:"post",endpoint:"/api/orders/cancel",contextInputParams:{shopDomain:""},editableInputParams:{order:"",cancel_reason:"",other_cancel_reason:""},inputResolver:function(e){return{shop:e.shopDomain,order:e.order,cancel_reason:e.cancel_reason,other_cancel_reason:e.other_cancel_reason,is_edit:!1}}}},p=t.YagiCancellableEditor={basic:[{type:"codeInput",name:"apiBaseUrl",defultValue:"https://app.cancellable.app",props:{label:"API Base url",placeholder:"https://app.cancellable.app"}},{type:"codeInput",name:"shopDomain",props:{label:"Shop domain",placeholder:""}}]};t.default=(0,s.default)({name:"yagiOrderCancellable",config:Object.assign({},u.baseDatasourceConfig,{apiBaseUrl:"https://app.cancellable.app",shopDomain:"",queryRunner:"queryrunner"}),initDatasource:function*(e,t,r){var n=(0,u.AjaxQueryRunner)(),a=t.config.get("apiBaseUrl");return n.initClient(a,(function(e){return e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},getQueries:function(){return d},getQueryInputParams:function(e){var t=d&&d[e]?d[e]:null;return t&&t.editableInputParams?t.editableInputParams:{}},getPlatformIdentifier:function(){return"yagiOrderCancellable"},runQuery:function*(e,t,r,n,s,u){var p=d[n],c=(t.config.get("shopDomain"),t.config.get("apiBaseUrl"));if(p){var f,g,m,y,v=null!=u?u:{},h=v.getNextPage,b=v.paginationMeta;if(p&&p.contextInputParams){var I=(g=p.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(g).reduce((function(e,n){var o=(0,i.default)(n,2),s=o[0];return o[1],r&&r.get(s)?Object.assign({},e,(0,a.default)({},s,r.get(s))):t&&t.get(s)?Object.assign({},e,(0,a.default)({},s,t.get(s))):e}),{})});f=I(t,r)}p&&p.editableInputParams&&(m=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,i.default)(r,2),o=n[0],s=n[1];return t&&void 0!==t[o]?"number"==typeof t[o]?Object.assign({},e,(0,a.default)({},o,isNaN(s)&&typeof s==typeof t[o]?s:parseInt(s))):s?Object.assign({},e,(0,a.default)({},o,s)):e:e}),{})}(s,p.editableInputParams)),null!=p&&p.isPaginated&&p.paginationResolver&&h&&(m=p.paginationResolver(m,b));var P=Object.assign({},m,f);y=p.inputResolver?yield(0,o.call)(p.inputResolver,P):P;var R=p.endpoint;p.endpointResolver&&(R=p.endpointResolver(R,P,b));var w,T,_=r.get("queryRunner"),O=yield(0,o.call)(_.runQuery,p.queryType,R,y,"web"===l.Platform.OS&&u?Object.assign({},u,{headers:{"x-base-url":c+R}}):u),S=O&&O.data?O.data:{},A=S;if(p&&p.transformer){var C=p.transformer(S,b);A=C.data,w=C.hasNextPage,T=C.paginationMeta}return yield{rawData:S,data:A,hasNextPage:w,paginationMeta:T}}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.shopDomain;return!(!t||!r)&&{apiBaseUrl:t,shopDomain:r}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","shopDomain"]},options:{propertySettings:{},pluginListing:{labelPrefix:"yagiOrderCancellable",type:"datasource",name:"Yagi Order Cancellable",description:"Give customers control to cancel their order!",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:p})},8708:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.transformGetOrderCancellableCheckQueryData=void 0;var n=r(3216),a=function(e){return(0,n.transform)(e,(function(e,t,r,i){e[(0,n.isArray)(i)?r:(0,n.camelCase)(r)]=(0,n.isObject)(t)?a(t):t}))};t.transformGetOrderCancellableCheckQueryData=function(e){var t=e.preference;return{data:t=a(t)}}},2948:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.YotpoEditors=void 0,t.runQuery=function(e,t,r,n){return y.apply(this,arguments)};var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(9962),c={isPaginated:!1,contextInputParams:{apiBaseUrl:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},f={getAggregatedData:Object.assign({},c,{queryType:"get",endpoint:"/widget/",endpointResolver:function(e,t){return`${e}${t.appKey}/products/${t.productId}/reviews.json?&page=1${t.per_page?`&per_page=${t.per_page}`:""}${t.star?`&star=${t.star}`:""}${t.direction?`&direction=${t.direction}`:""}${t.sort?`&sort=${t.sort}`:""}`},editableInputParams:{appKey:"",productId:"",per_page:10,star:"",sort:"date",direction:"asc"},transformer:p.TransformAggregatedData,inputResolver:function(e,t){return{per_page:e.per_page,star:e.star,sort:e.sort,direction:e.direction,appKey:e.appKey,productId:e.productId}}}),listProductReviews:Object.assign({},c,{queryType:"get",endpoint:"/widget/",endpointResolver:function(e,t,r){var n=(null!=r?r:{}).after,a=void 0===n?1:n;return`${e}${t.appKey}/products/${t.productId}/reviews.json?${a?`&page=${a}`:""}${t.per_page?`&per_page=${t.per_page}`:""}${t.star?`&star=${t.star}`:""}${t.direction?`&direction=${t.direction}`:""}${t.sort?`&sort=${t.sort}`:""}`},editableInputParams:{appKey:"",productId:"",per_page:10,star:"",sort:"date",direction:"asc"},transformer:p.TransformGetReviews,inputResolver:function(e,t){return{per_page:e.per_page,star:e.star,sort:e.sort,direction:e.direction,appKey:e.appKey,productId:e.productId}},isPaginated:!0}),postCustomerReview:Object.assign({},c,{queryType:"post",endpoint:"/widget/reviews",endpointResolver:function(e){return`${e}`},transformer:p.TransformPostReview,inputResolver:function(e,t){return{review_score:e.review_score,review_title:e.review_title,review_content:e.review_content,email:e.email,display_name:e.display_name,product_url:e.product_url,product_title:e.product_title,sku:e.sku,appkey:e.appkey}},editableInputParams:{review_score:"",review_title:"",review_content:"",email:"",display_name:"",product_url:"",product_title:"",sku:"",appkey:""}})},g=t.YotpoEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API Base url",placeholder:"https://api-cdn.yotpo.com/v1"}},{type:"codeInput",name:"appKey",props:{label:"Yotpo App Key",placeholder:""}}]},m=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a){var i,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};try{var l,d,p=u.getNextPage,c=u.paginationMeta,f=null!=n?n:{},g=f.endpointResolver,m=f.endpoint,y=(i=f.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(i).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0];return a[1],r&&r.get(i)?Object.assign({},e,(0,o.default)({},i,r.get(i))):t&&t.get(i)?Object.assign({},e,(0,o.default)({},i,t.get(i))):e}),{})}),v=y(t,r),h=!0;n&&n.editableInputParams&&(l=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(h=n.checkInputVariabes(l))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(l=n.paginationResolver(l,c)),d=n.inputResolver?n.inputResolver(l,v):l,m=g&&g(m,Object.assign({},v,d),c);var b,I=r.get("queryRunner");if(h)try{b=yield I.runQuery(n.queryType,m,Object.assign({},d),Object.assign({},u))}catch(e){logger.error("error",e)}else b={errors:{message:"Missing input variables"},data:null};var P,R,w=b&&b.data?b.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,P=S,R=A}return{rawData:w,data:T,hasNextPage:P,paginationMeta:R,errors:[],hasError:!1}}catch(e){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}})),function(e,t,r,n,i){return a.apply(this,arguments)});function y(){return(y=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,l.GetRegisteredPlugin)(a),o=f[r];if(f[r])return yield m(i,t,e,o,Object.assign({},n),{})}))).apply(this,arguments)}t.default=(0,d.default)({name:"yotpoReviews",config:{apiBaseUrl:"https://",appKey:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},_onPluginUpdate:function*(e,t,r,n,a,i,o){var s=yield(0,u.select)(l.selectPluginConfig,r,t),d=(0,l.GetRegisteredConfig)(s.get("subtype"))(s.config),p=s.set("config",d),c=e.stageModel.getModelValue([]).get(p.get("id")),f=null==c?void 0:c.get("queryRunner");return(f=(0,l.AjaxQueryRunner)()).initClient(p.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[p.get("id"),"queryRunner"],newValue:f}]}},get onPluginUpdate(){return this._onPluginUpdate},set onPluginUpdate(e){this._onPluginUpdate=e},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.appKey;return!(!t||!r)&&{apiBaseUrl:t,appKey:r}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","appKey"]},getPlatformIdentifier:function(){return"yotpoReviews"},runQuery:function*(e,t,r,n,a,i){var o=f[n];if(o)return yield m(e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"yotpoReviews",type:"datasource",name:"Yotpo Reviews",description:"",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g})},9962:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformPostReview=t.TransformGetReviews=t.TransformAggregatedData=void 0,t.TransformAggregatedData=function(e){return{data:e}},t.TransformGetReviews=function(e){var t=e.response.reviews,r=e.response.pagination.page;return{data:t,hasNextPage:!(0===t.length),paginationMeta:{after:r+1}}},t.TransformPostReview=function(e){return{data:e}}},1805:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.executeQuery=t.default=t.ZapietEditors=void 0,t.runQuery=function(e,t,r,n){return y.apply(this,arguments)};var a,i=n(r(2766)),o=n(r(5990)),s=n(r(7488)),u=r(804),l=r(892),d=n(r(827)),p=r(9033),c={isPaginated:!1,contextInputParams:{apiBaseUrl:"",apiKey:"",shop:""},paginationResolver:function(e,t){var r=(null!=t?t:{}).after;return r?Object.assign({},e,{after:r}):e}},f={getAvailableStorePickupDeliveryLocations:Object.assign({},c,{queryType:"post",endpoint:"/pickup/locations",endpointResolver:function(e,t){return`${e}?shop=${t.shop}`},editableInputParams:{shoppingCart:"",geoSearchQuery:""},transformer:p.TransformGetAvailableDeliveryLocations}),getStorePickupDates:Object.assign({},c,{queryType:"post",endpoint:"/pickup/locations",endpointResolver:function(e,t){return`${e}/${t.locationId}/calendar?shop=${t.shop}`},editableInputParams:{locationId:"",shoppingCart:""},transformer:p.TransformGetAvailableDates}),getStorePickupTimes:Object.assign({},c,{queryType:"post",endpoint:"/pickup/locations",endpointResolver:function(e,t){var r=t.locationId,n=t.shop;return`${e}/${r}/calendar/${t.date}?shop=${n}`},editableInputParams:{locationId:"",date:""},transformer:p.TransformGetAvailableDates}),getAvailableLocalDeliveryLocations:Object.assign({},c,{queryType:"post",endpoint:"/delivery/locations",endpointResolver:function(e,t){return`${e}?shop=${t.shop}`},editableInputParams:{shoppingCart:"",geoSearchQuery:""},transformer:p.TransformGetAvailableDeliveryLocations}),getLocalDeliveryDates:Object.assign({},c,{queryType:"post",endpoint:"/delivery/locations",endpointResolver:function(e,t){return`${e}/${t.locationId}/calendar?shop=${t.shop}`},editableInputParams:{locationId:"",shoppingCart:""},transformer:p.TransformGetAvailableDates}),getLocalDeliveryTimes:Object.assign({},c,{queryType:"post",endpoint:"/delivery/locations",endpointResolver:function(e,t){var r=t.locationId,n=t.shop;return`${e}/${r}/calendar/${t.date}?shop=${n}`},editableInputParams:{locationId:"",date:""},transformer:p.TransformGetAvailableDates}),getShippingDates:Object.assign({},c,{queryType:"post",endpoint:"/shipping/calendar",endpointResolver:function(e,t){return`${e}?shop=${t.shop}`},editableInputParams:{shoppingCart:""},transformer:p.TransformGetAvailableDates})},g=t.ZapietEditors={basic:[{type:"codeInput",name:"apiBaseUrl",props:{label:"API base url",placeholder:"https://api-us.zapiet.com/v1.0"}},{type:"codeInput",name:"apiKey",props:{label:"Zapiet api key",placeholder:""}},{type:"codeInput",name:"shop",props:{label:"Shopify shop",placeholder:""}}]},m=t.executeQuery=(a=(0,i.default)((function*(e,t,r,n,a){var i,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};try{var l,d,p=u.getNextPage,c=u.paginationMeta,f=null!=n?n:{},g=f.endpointResolver,m=f.endpoint,y=(i=f.contextInputParams,function(e,t){var r=e.get("config");if(r)return Object.entries(i).reduce((function(e,n){var a=(0,s.default)(n,2),i=a[0];return a[1],r&&r.get(i)?Object.assign({},e,(0,o.default)({},i,r.get(i))):t&&t.get(i)?Object.assign({},e,(0,o.default)({},i,t.get(i))):e}),{})}),v=y(t,r),h=!0;n&&n.editableInputParams&&(l=function(e,t){return Object.entries(e).reduce((function(e,r){var n=(0,s.default)(r,2),a=n[0],i=n[1];return t&&void 0!==t[a]?"number"==typeof t[a]?Object.assign({},e,(0,o.default)({},a,isNaN(i)&&typeof i==typeof t[a]?i:parseInt(i))):i?Object.assign({},e,(0,o.default)({},a,i)):e:e}),{})}(a,n.editableInputParams),null!=n&&n.checkInputVariabes&&(h=n.checkInputVariabes(l))),null!=n&&n.isPaginated&&n.paginationResolver&&p&&(l=n.paginationResolver(l,c)),d=n.inputResolver?n.inputResolver(l,v):l,m=g&&g(m,Object.assign({},v,d),c);var b,I,P,R=r.get("queryRunner"),w=(b=h?yield R.runQuery(n.queryType,m,Object.assign({},d),Object.assign({},u)):{errors:{message:"Missing input variables"},data:null})&&b.data?b.data:{},T=w;if(n&&n.transformer){var _=n.transformer(w),O=_.data,S=_.hasNextPage,A=_.paginationMeta;T=O,I=S,P=A}return{rawData:w,data:T,hasNextPage:I,paginationMeta:P,errors:[],hasError:!1}}catch(e){return{rawData:{},data:{},hasNextPage:!1,paginationMeta:{},errors:[e],hasError:!0}}})),function(e,t,r,n,i){return a.apply(this,arguments)});function y(){return(y=(0,i.default)((function*(e,t,r,n){var a=e.get("pluginType"),i=(0,l.GetRegisteredPlugin)(a),o=f[r];if(f[r])return yield m(i,t,e,o,Object.assign({},n),{})}))).apply(this,arguments)}t.default=(0,d.default)({name:"zapiet",config:{apiBaseUrl:"https://api-us.zapiet.com/v1.0",apiKey:"",shop:"",queryRunner:"queryrunner"},initDatasource:function*(e,t,r){var n=(0,l.AjaxQueryRunner)();return n.initClient(t.config.get("apiBaseUrl"),(function(e){return e})),{modelUpdates:[{selector:[t.get("id"),"queryRunner"],newValue:n}]}},_onPluginUpdate:function*(e,t,r,n,a,i,o){var s=yield(0,u.select)(l.selectPluginConfig,r,t),d=(0,l.GetRegisteredConfig)(s.get("subtype"))(s.config),p=s.set("config",d),c=e.stageModel.getModelValue([]).get(p.get("id")),f=null==c?void 0:c.get("queryRunner");return(f=(0,l.AjaxQueryRunner)()).initClient(p.config.get("apiBaseUrl"),(function(e){return e.headers={"Content-Type":"application/json"},e})),{modelUpdates:[{selector:[p.get("id"),"queryRunner"],newValue:f}]}},get onPluginUpdate(){return this._onPluginUpdate},set onPluginUpdate(e){this._onPluginUpdate=e},getQueries:function(){return f},getQueryInputParams:function(e){var t=f&&f[e]?f[e]:null;return null!=t&&t.editableInputParams?null==t?void 0:t.editableInputParams:{}},resolveCredentialConfigs:function(e){var t=e.apiBaseUrl,r=e.apiKey,n=e.shop;return!(!r||!n)&&{apiBaseUrl:t,apiKey:r,shop:n}},resolveClearCredentialConfigs:function(){return["apiBaseUrl","apiKey"]},getPlatformIdentifier:function(){return"zapiet"},runQuery:function*(e,t,r,n,a,i){var o=f[n];if(o)return yield m(e,t,r,o,a,i)},options:{pluginListing:{labelPrefix:"zapiet",type:"datasource",name:"Zapiet",description:"",defaultHeight:0,defaultWidth:0,section:"Integrations",icon:"datasource"}},editors:g})},9033:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TransformGetAvailableDeliveryLocations=t.TransformGetAvailableDates=void 0,t.TransformGetAvailableDeliveryLocations=function(e){return{data:e.locations?e.locations:e}},t.TransformGetAvailableDates=function(e){return{data:e}}},7232:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IntegrationCodesMappingWithDataSource=void 0,t.IntegrationCodesMappingWithDataSource={rechargePayments:"Payment Recharge",firebaseAnalytics:"firebaseAnalytics",flits:"flitsWishlist",gorgias:"gorgiasHelpdesk",productFilterSearch:"productFilterSearch",stamped:"Stamped",ApptileMFAuth:"ApptileMFAuth",apptileMFAuthentication:"apptileMFAuthentication",stampedReviews:"stampedReviews",stampedRewards:"stampedRewards",localWishlist:"LocalWishlist",apptileSkinCare:"apptileSkinCare",judgeMe:"judgeMe",joleneAuth:"joleneAuth",instagramMedia:"instagramMedia",meragi:"meragi",storifyMe:"storifyMe",yagiOrderCancellable:"yagiOrderCancellable",simplyOtp:"simplyOTPLogin",nectorRewards:"nectorRewards",wizzySearch:"wizzySearch",searchanize:"searchanize",orderLimiter:"orderLimiter",lively:"lively",livelyShoppable:"livelyShoppable",okendoReviews:"okendoReviews",yotpoReviews:"yotpoReviews",reviewsIoReviews:"reviewsIoReviews",cloudsearch:"Cloud Search",zapiet:"zapiet",nosto:"Nosto",easyAppointment:"easyAppointment",loyaltyLion:"loyaltyLion",joyLoyalty:"joyLoyalty",wishlistPlus:"wishlistPlus",appstleSubs:"Appstle Subscriptions",riseAI:"riseAI",swatchKing:"swatchKing",apptileCartUpsell:"ApptileCartUpsell",aitrillion:"Aitrillion",omegaEstimate:"OmegaEstimate",preOrderWod:"preOrderWod",apptileCartDiscounts:"apptileCartDiscounts",apptilePinCodeChecker:"apptilePinCodeChecker",discourse:"discourse",cartAssist:"cartAssist",smile:"smile",fera:"fera",rivo:"rivo",recurpay:"Recurpay"}},719:()=>{},5768:(e,t)=>{"use strict";t.byteLength=function(e){var t=s(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,i=s(e),o=i[0],u=i[1],l=new a(function(e,t,r){return 3*(t+r)/4-r}(0,o,u)),d=0,p=u>0?o-4:o;for(r=0;r<p;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;return 2===u&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[d++]=255&t),1===u&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,i=[],o=16383,s=0,l=n-a;s<l;s+=o)i.push(u(e,s,s+o>l?l:s+o));return 1===a?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),i.join("")};for(var r=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)r[o]=i[o],n[i.charCodeAt(o)]=o;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function u(e,t,n){for(var a,i,o=[],s=t;s<n;s+=3)a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(i=a)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},1545:(e,t,r)=>{"use strict";var n=r(5768),a=r(6773),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=function(e){return+e!=e&&(e=0),u.alloc(+e)},t.INSPECT_MAX_BYTES=50;var o=2147483647;function s(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return p(e)}return l(e,t,r)}function l(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|m(e,t),n=s(r),a=n.write(e,t);return a!==r&&(n=n.slice(0,a)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if($(e,Uint8Array)){var t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return c(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if($(e,ArrayBuffer)||e&&$(e.buffer,ArrayBuffer))return f(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&($(e,SharedArrayBuffer)||e&&$(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return u.from(n,t,r);var a=function(e){if(u.isBuffer(e)){var t=0|g(e.length),r=s(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||B(e.length)?s(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function p(e){return d(e),s(e<0?0:0|g(e))}function c(e){for(var t=e.length<0?0:0|g(e.length),r=s(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,u.prototype),n}function g(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function m(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||$(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(e).length;default:if(a)return n?-1:V(e).length;t=(""+t).toLowerCase(),a=!0}}function y(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return U(this,t,r);case"utf8":case"utf-8":return O(this,t,r);case"ascii":return A(this,t,r);case"latin1":case"binary":return C(this,t,r);case"base64":return _(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return j(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function h(e,t,r,n,a){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),B(r=+r)&&(r=a?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(a)return-1;r=e.length-1}else if(r<0){if(!a)return-1;r=0}if("string"==typeof t&&(t=u.from(t,n)),u.isBuffer(t))return 0===t.length?-1:b(e,t,r,n,a);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):b(e,[t],r,n,a);throw new TypeError("val must be string, number or Buffer")}function b(e,t,r,n,a){var i,o=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,r/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var d=-1;for(i=r;i<s;i++)if(l(e,i)===l(t,-1===d?0:i-d)){if(-1===d&&(d=i),i-d+1===u)return d*o}else-1!==d&&(i-=i-d),d=-1}else for(r+u>s&&(r=s-u),i=r;i>=0;i--){for(var p=!0,c=0;c<u;c++)if(l(e,i+c)!==l(t,c)){p=!1;break}if(p)return i}return-1}function I(e,t,r,n){r=Number(r)||0;var a=e.length-r;n?(n=Number(n))>a&&(n=a):n=a;var i=t.length;n>i/2&&(n=i/2);for(var o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(B(s))return o;e[r+o]=s}return o}function P(e,t,r,n){return Q(V(t,e.length-r),e,r,n)}function R(e,t,r,n){return Q(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return Q(N(t),e,r,n)}function T(e,t,r,n){return Q(function(e,t){for(var r,n,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)n=(r=e.charCodeAt(o))>>8,a=r%256,i.push(a),i.push(n);return i}(t,e.length-r),e,r,n)}function _(e,t,r){return 0===t&&r===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,r))}function O(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var i,o,s,u,l=e[a],d=null,p=l>239?4:l>223?3:l>191?2:1;if(a+p<=r)switch(p){case 1:l<128&&(d=l);break;case 2:128==(192&(i=e[a+1]))&&(u=(31&l)<<6|63&i)>127&&(d=u);break;case 3:i=e[a+1],o=e[a+2],128==(192&i)&&128==(192&o)&&(u=(15&l)<<12|(63&i)<<6|63&o)>2047&&(u<55296||u>57343)&&(d=u);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],128==(192&i)&&128==(192&o)&&128==(192&s)&&(u=(15&l)<<18|(63&i)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(d=u)}null===d?(d=65533,p=1):d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|1023&d),n.push(d),a+=p}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=S));return r}(n)}t.kMaxLength=o,u.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,r){return l(e,t,r)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,r){return function(e,t,r){return d(e),e<=0?s(e):void 0!==t?"string"==typeof r?s(e).fill(t,r):s(e).fill(t):s(e)}(e,t,r)},u.allocUnsafe=function(e){return p(e)},u.allocUnsafeSlow=function(e){return p(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if($(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),$(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,a=0,i=Math.min(r,n);a<i;++a)if(e[a]!==t[a]){r=e[a],n=t[a];break}return r<n?-1:n<r?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=u.allocUnsafe(t),a=0;for(r=0;r<e.length;++r){var i=e[r];if($(i,Uint8Array))a+i.length>n.length?u.from(i).copy(n,a):Uint8Array.prototype.set.call(n,i,a);else{if(!u.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,a)}a+=i.length}return n},u.byteLength=m,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},u.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?O(this,0,e):y.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},i&&(u.prototype[i]=u.prototype.inspect),u.prototype.compare=function(e,t,r,n,a){if($(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||r>e.length||n<0||a>this.length)throw new RangeError("out of range index");if(n>=a&&t>=r)return 0;if(n>=a)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(n>>>=0),o=(r>>>=0)-(t>>>=0),s=Math.min(i,o),l=this.slice(n,a),d=e.slice(t,r),p=0;p<s;++p)if(l[p]!==d[p]){i=l[p],o=d[p];break}return i<o?-1:o<i?1:0},u.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},u.prototype.indexOf=function(e,t,r){return h(this,e,t,r,!0)},u.prototype.lastIndexOf=function(e,t,r){return h(this,e,t,r,!1)},u.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-t;if((void 0===r||r>a)&&(r=a),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return I(this,e,t,r);case"utf8":case"utf-8":return P(this,e,t,r);case"ascii":case"latin1":case"binary":return R(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function A(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}function C(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}function U(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var a="",i=t;i<r;++i)a+=L[e[i]];return a}function j(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length-1;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}function x(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,r,n,a,i){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function E(e,t,r,n,a,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function k(e,t,r,n,i){return t=+t,r>>>=0,i||E(e,0,r,4),a.write(e,t,r,n,23,4),r+4}function q(e,t,r,n,i){return t=+t,r>>>=0,i||E(e,0,r,8),a.write(e,t,r,n,52,8),r+8}u.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,u.prototype),n},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=this[e+--t],a=1;t>0&&(a*=256);)n+=this[e+--t]*a;return n},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*t)),n},u.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||x(e,t,this.length);for(var n=t,a=1,i=this[e+--n];n>0&&(a*=256);)i+=this[e+--n]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},u.prototype.readInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),a.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),a.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),a.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),a.read(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||M(this,e,t,r,Math.pow(2,8*r)-1,0);var a=1,i=0;for(this[t]=255&e;++i<r&&(a*=256);)this[t+i]=e/a&255;return t+r},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||M(this,e,t,r,Math.pow(2,8*r)-1,0);var a=r-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+r},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var a=Math.pow(2,8*r-1);M(this,e,t,r,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},u.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var a=Math.pow(2,8*r-1);M(this,e,t,r,a-1,-a)}var i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o|0)-s&255;return t+r},u.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeFloatLE=function(e,t,r){return k(this,e,t,!0,r)},u.prototype.writeFloatBE=function(e,t,r){return k(this,e,t,!1,r)},u.prototype.writeDoubleLE=function(e,t,r){return q(this,e,t,!0,r)},u.prototype.writeDoubleBE=function(e,t,r){return q(this,e,t,!1,r)},u.prototype.copy=function(e,t,r,n){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var a=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),a},u.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!u.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var a=e.charCodeAt(0);("utf8"===n&&a<128||"latin1"===n)&&(e=a)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var o=u.isBuffer(e)?e:u.from(e,n),s=o.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=o[i%s]}return this};var D=/[^+/0-9A-Za-z-_]/g;function V(e,t){var r;t=t||1/0;for(var n=e.length,a=null,i=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!a){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}a=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function N(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(D,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Q(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length||a>=e.length);++a)t[a+r]=e[a];return a}function $(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function B(e){return e!=e}var L=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,a=0;a<16;++a)t[n+a]=e[r]+e[a];return t}()},8209:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.disableExperimentalFragmentVariables=m,t.disableFragmentWarnings=f,t.enableExperimentalFragmentVariables=g,t.gql=p,t.resetCaches=c;var n=r(6252),a=r(8476),i=new Map,o=new Map,s=!0,u=!1;function l(e){return e.replace(/[\s,]+/g," ").trim()}function d(e){var t,r,d,p=l(e);if(!i.has(p)){var c=(0,a.parse)(e,{experimentalFragmentVariables:u,allowLegacyFragmentVariables:u});if(!c||"Document"!==c.kind)throw new Error("Not a valid GraphQL document.");i.set(p,function(e){var t=new Set(e.definitions);t.forEach((function(e){e.loc&&delete e.loc,Object.keys(e).forEach((function(r){var n=e[r];n&&"object"==typeof n&&t.add(n)}))}));var r=e.loc;return r&&(delete r.startToken,delete r.endToken),e}((t=c,r=new Set,d=[],t.definitions.forEach((function(e){if("FragmentDefinition"===e.kind){var t=e.name.value,n=l((i=e.loc).source.body.substring(i.start,i.end)),a=o.get(t);a&&!a.has(n)?s&&console.warn("Warning: fragment with name "+t+" already exists.\ngraphql-tag enforces all fragment names across your application to be unique; read more about\nthis in the docs: http://dev.apollodata.com/core/fragments.html#unique-names"):a||o.set(t,a=new Set),a.add(n),r.has(n)||(r.add(n),d.push(e))}else d.push(e);var i})),(0,n.__assign)((0,n.__assign)({},t),{definitions:d}))))}return i.get(p)}function p(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];"string"==typeof e&&(e=[e]);var n=e[0];return t.forEach((function(t,r){t&&"Document"===t.kind?n+=t.loc.source.body:n+=t,n+=e[r+1]})),d(n)}function c(){i.clear(),o.clear()}function f(){s=!1}function g(){u=!0}function m(){u=!1}var y,v=p,h=c,b=f,I=g,P=m;(y=p||(t.gql=p={})).gql=v,y.resetCaches=h,y.disableFragmentWarnings=b,y.enableExperimentalFragmentVariables=I,y.disableExperimentalFragmentVariables=P,p.default=p,t.default=p},6773:(e,t)=>{t.read=function(e,t,r,n,a){var i,o,s=8*a-n-1,u=(1<<s)-1,l=u>>1,d=-7,p=r?a-1:0,c=r?-1:1,f=e[t+p];for(p+=c,i=f&(1<<-d)-1,f>>=-d,d+=s;d>0;i=256*i+e[t+p],p+=c,d-=8);for(o=i&(1<<-d)-1,i>>=-d,d+=n;d>0;o=256*o+e[t+p],p+=c,d-=8);if(0===i)i=1-l;else{if(i===u)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),i-=l}return(f?-1:1)*o*Math.pow(2,i-n)},t.write=function(e,t,r,n,a,i){var o,s,u,l=8*i-a-1,d=(1<<l)-1,p=d>>1,c=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,g=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+p>=1?c/u:c*Math.pow(2,1-p))*u>=2&&(o++,u/=2),o+p>=d?(s=0,o=d):o+p>=1?(s=(t*u-1)*Math.pow(2,a),o+=p):(s=t*Math.pow(2,p-1)*Math.pow(2,a),o=0));a>=8;e[r+f]=255&s,f+=g,s/=256,a-=8);for(o=o<<a|s,l+=a;l>0;e[r+f]=255&o,f+=g,o/=256,l-=8);e[r+f-g]|=128*m}},8296:(e,t,r)=>{var n=r(71),a=r(2572),i=a;i.v1=n,i.v4=a,e.exports=i},417:e=>{for(var t=[],r=0;r<256;++r)t[r]=(r+256).toString(16).substr(1);e.exports=function(e,r){var n=r||0,a=t;return[a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]]].join("")}},6584:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var r=new Uint8Array(16);e.exports=function(){return t(r),r}}else{var n=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)3&t||(e=4294967296*Math.random()),n[t]=e>>>((3&t)<<3)&255;return n}}},71:(e,t,r)=>{var n,a,i=r(6584),o=r(417),s=0,u=0;e.exports=function(e,t,r){var l=t&&r||0,d=t||[],p=(e=e||{}).node||n,c=void 0!==e.clockseq?e.clockseq:a;if(null==p||null==c){var f=i();null==p&&(p=n=[1|f[0],f[1],f[2],f[3],f[4],f[5]]),null==c&&(c=a=16383&(f[6]<<8|f[7]))}var g=void 0!==e.msecs?e.msecs:(new Date).getTime(),m=void 0!==e.nsecs?e.nsecs:u+1,y=g-s+(m-u)/1e4;if(y<0&&void 0===e.clockseq&&(c=c+1&16383),(y<0||g>s)&&void 0===e.nsecs&&(m=0),m>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=g,u=m,a=c;var v=(1e4*(268435455&(g+=122192928e5))+m)%4294967296;d[l++]=v>>>24&255,d[l++]=v>>>16&255,d[l++]=v>>>8&255,d[l++]=255&v;var h=g/4294967296*1e4&268435455;d[l++]=h>>>8&255,d[l++]=255&h,d[l++]=h>>>24&15|16,d[l++]=h>>>16&255,d[l++]=c>>>8|128,d[l++]=255&c;for(var b=0;b<6;++b)d[l+b]=p[b];return t||o(d)}},2572:(e,t,r)=>{var n=r(6584),a=r(417);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||n)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[i+s]=o[s];return t||a(o)}},1928:(e,t,r)=>{var n=r(5825);Object.defineProperty(t,"__esModule",{value:!0}),t.fetchInputFieldsForUIEditor=function(e){return e&&Object.entries(e).map((function(e){var t=(0,a.default)(e,2),r=t[0],n=t[1];return"object"==typeof n&&(0,i.isArray)(n)?{type:"dropDown",name:r,props:{label:r,options:n}}:"boolean"==typeof n?{type:"checkbox",name:r,props:{label:r,defaultValue:n}}:{type:"codeInput",name:r,props:{label:r,placeholder:(0,i.isObject)(n)?`${JSON.stringify(n)}`:`${n}`}}}))};var a=n(r(7488)),i=r(3216)},827:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.wrapDatasourceModel}});var n=r(892)},2766:e=>{"use strict";e.exports=require("@babel/runtime/helpers/asyncToGenerator")},2584:e=>{"use strict";e.exports=require("@babel/runtime/helpers/classCallCheck")},3664:e=>{"use strict";e.exports=require("@babel/runtime/helpers/createClass")},5990:e=>{"use strict";e.exports=require("@babel/runtime/helpers/defineProperty")},5825:e=>{"use strict";e.exports=require("@babel/runtime/helpers/interopRequireDefault")},1351:e=>{"use strict";e.exports=require("@babel/runtime/helpers/objectDestructuringEmpty")},7128:e=>{"use strict";e.exports=require("@babel/runtime/helpers/objectWithoutProperties")},7488:e=>{"use strict";e.exports=require("@babel/runtime/helpers/slicedToArray")},5971:e=>{"use strict";e.exports=require("@babel/runtime/helpers/toConsumableArray")},6616:e=>{"use strict";e.exports=require("@apollo/client")},892:e=>{"use strict";e.exports=require("apptile-core")},8352:e=>{"use strict";e.exports=require("axios")},6708:e=>{"use strict";e.exports=require("crypto-js/hmac-sha256")},8476:e=>{"use strict";e.exports=require("graphql")},2748:e=>{"use strict";e.exports=require("lively-live-stream-rn")},3216:e=>{"use strict";e.exports=require("lodash")},1432:e=>{"use strict";e.exports=require("lodash-es")},6196:e=>{"use strict";e.exports=require("moment")},6352:e=>{"use strict";e.exports=require("react-native")},804:e=>{"use strict";e.exports=require("redux-saga/effects")},6252:e=>{"use strict";e.exports=require("tslib")}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}var n={};(()=>{var e=n,t=r(5825);Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"ApptileMFAuthDsName",{enumerable:!0,get:function(){return l.ApptileMFAuthDsName}}),Object.defineProperty(e,"ApptileMFAuthenticationDsName",{enumerable:!0,get:function(){return p.ApptileMFAuthenticationDsName}}),Object.defineProperty(e,"IntegrationCodesMappingWithDataSource",{enumerable:!0,get:function(){return re.IntegrationCodesMappingWithDataSource}}),Object.defineProperty(e,"IntegrationPlatformType",{enumerable:!0,get:function(){return ne.IntegrationPlatformType}}),e.default=void 0,Object.defineProperty(e,"fetchInputFieldsForUIEditor",{enumerable:!0,get:function(){return te.fetchInputFieldsForUIEditor}}),e.loadDatasourcePlugins=se,Object.defineProperty(e,"processShopifyGraphqlQueryResponse",{enumerable:!0,get:function(){return te.processShopifyGraphqlQueryResponse}});var a=r(892),i=t(r(9701)),o=t(r(4084)),s=t(r(1672)),u=t(r(9588)),l=ie(r(3972)),d=t(r(2032)),p=ie(r(4786)),c=t(r(1689)),f=t(r(1948)),g=t(r(9417)),m=t(r(8860)),y=t(r(4309)),v=t(r(979)),h=t(r(7662)),b=t(r(1177)),I=t(r(740)),P=t(r(1718)),R=t(r(5050)),w=t(r(6645)),T=t(r(8218)),_=t(r(1171)),O=t(r(6621)),S=t(r(2920)),A=t(r(9872)),C=t(r(3729)),U=t(r(6167)),j=t(r(8863)),x=t(r(2948)),M=t(r(2888)),E=t(r(1805)),k=t(r(7087)),q=t(r(3397)),D=t(r(2422)),V=t(r(4946)),N=t(r(2018)),Q=t(r(9685)),$=t(r(6627)),B=t(r(5301)),L=t(r(7430)),G=t(r(5217)),F=t(r(1973)),K=t(r(4036)),W=t(r(7378)),H=t(r(2595)),z=t(r(7581)),J=t(r(8e3)),Y=t(r(2367)),X=t(r(3876)),Z=t(r(2607)),ee=t(r(805)),te=r(1928),re=r(7232),ne=r(719);function ae(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(ae=function(e){return e?r:t})(e)}function ie(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=ae(t);if(r&&r.has(e))return r.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&{}.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,r&&r.set(e,n),n}var oe=[i.default,s.default,u.default,o.default,l.default,d.default,p.default,c.default,f.default,g.default,m.default,y.default,v.default,h.default,H.default,b.default,I.default,P.default,R.default,w.default,T.default,_.default,O.default,S.default,D.default,V.default,C.default,Z.default,A.default,j.default,U.default,x.default,M.default,E.default,k.default,q.default,N.default,Q.default,$.default,B.default,L.default,G.default,F.default,K.default,W.default,z.default,J.default,Y.default,X.default,ee.default];function se(){return oe.forEach((function(e){(0,a.registerDatasource)(e.name,e)})),Promise.resolve(oe)}e.default=se})(),module.exports=n})();